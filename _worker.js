// <!--GAMFC-->version base on commit: 49bfba07fa07caa80e6ef663c4c90768fcd2886e - last update: 2025-12-25 03:02:12 UTC <!--GAMFC-END-->.

import{connect}from'cloudflare:sockets';const QUANTUM_CONFIG={'VERSION':'6.0.1','SYSTEM_NAME':'Quantum\x20Shield\x20Enhanced','PATHS':{'ADMIN':'/quantum-admin-v6','API':'/api/v2','WEBHOOK':'/quantum-webhook','SUBSCRIPTION':'/sub','VLESS_WS':'/vless-quantum','VLESS_GRPC':'/grpc-quantum','USER_PANEL':'/panel'},'SECURITY':{'MAX_CONNECTIONS_PER_USER':0x5,'RATE_LIMIT_PER_MINUTE':0x78,'RATE_LIMIT_BURST':0x96,'SESSION_TIMEOUT_HOURS':0xc,'AUTO_BAN_THRESHOLD':0x5,'PASSWORD_MIN_LENGTH':0x8,'MAX_LOGIN_ATTEMPTS':0x3,'LOGIN_COOLDOWN_MINUTES':0xf},'QUANTUM_FEATURES':{'ENABLE_FRAGMENTATION':!![],'ENABLE_PADDING':!![],'ENABLE_TIMING_OBFUSCATION':!![],'ENABLE_PROTOCOL_CAMOUFLAGE':!![],'ENABLE_REALITY_MODE':!![],'ENABLE_UDP_RELAY':!![],'ENABLE_GRPC_MULTIPLEX':!![],'ENABLE_DYNAMIC_SNI':!![],'ENABLE_TRAFFIC_MASKING':!![]},'GHOST_PRINTS':['chrome','firefox','safari','edge','android','ios','opera','brave'],'ANTI_FILTER_SNI':['www.speedtest.net','cloudflare.com','cdnjs.cloudflare.com','ajax.googleapis.com','www.microsoft.com','fonts.googleapis.com','www.gstatic.com','play.google.com'],'TRAFFIC_MASKING':{'MIN_FRAGMENT_SIZE':0x200,'MAX_FRAGMENT_SIZE':0x578,'PADDING_PROBABILITY':0.3,'MAX_PADDING_SIZE':0x40,'TIMING_JITTER_MS':0xa}};export default{async 'fetch'(a,b,c){try{await ensureDatabaseInitialized(b);const d=new URL(a['url']),e=a['headers']['get']('Upgrade'),f=a['headers']['get']('CF-Connecting-IP')||a['headers']['get']('X-Forwarded-For')?.['split'](',')[0x0]||'0.0.0.0';if(a['method']==='OPTIONS')return new Response(null,{'status':0xcc,'headers':getCORSHeaders()});const g=await checkRateLimit(f,b);if(!g['allowed'])return await logSecurityEvent(b,'rate_limit_exceeded',null,f,'Requests:\x20'+g['current']+'/'+QUANTUM_CONFIG['SECURITY']['RATE_LIMIT_PER_MINUTE']),jsonResponse({'error':'Rate\x20limit\x20exceeded','retryAfter':g['retryAfter']},0x1ad);if(await isIPBanned(f,b))return await logSecurityEvent(b,'banned_access_attempt',null,f,'Blocked\x20banned\x20IP'),serveFakeWebsite();if(e==='websocket'){if(d['pathname']===QUANTUM_CONFIG['PATHS']['VLESS_WS'])return await handleQuantumVLESS(a,b,c,'websocket',f);}if(a['headers']['get']('content-type')?.['includes']('application/grpc')){if(d['pathname']===QUANTUM_CONFIG['PATHS']['VLESS_GRPC'])return await handleQuantumVLESS(a,b,c,'grpc',f);}if(d['pathname']===QUANTUM_CONFIG['PATHS']['WEBHOOK']&&a['method']==='POST')return await handleTelegramWebhook(a,b);if(d['pathname']['startsWith'](QUANTUM_CONFIG['PATHS']['API']))return await handleAPIRequest(a,b,f);if(d['pathname']==='/admin-login'&&a['method']==='POST')return await handleAdminLogin(a,b,f);if(d['pathname']===QUANTUM_CONFIG['PATHS']['ADMIN'])return serveAdminPanel();if(d['pathname']['startsWith'](QUANTUM_CONFIG['PATHS']['SUBSCRIPTION']+'/'))return await handleSubscription(a,b);if(d['pathname']['startsWith'](QUANTUM_CONFIG['PATHS']['USER_PANEL']))return serveUserPanel();return serveFakeWebsite();}catch(h){return console['error']('Worker\x20Critical\x20Error:',h['message'],h['stack']),await logSecurityEvent(b,'system_error',null,null,h['message']+'\x20-\x20'+h['stack']?.['substring'](0x0,0xc8)),jsonResponse({'error':'Service\x20temporarily\x20unavailable','code':'INTERNAL_ERROR'},0x1f7);}},async 'scheduled'(a,b,c){const d=[performAutoBackup(b),cleanExpiredUsers(b),rotateQuantumKeys(b),checkSystemHealth(b),cleanOldLogs(b),updateNodeStatistics(b),processFailedConnections(b)];c['waitUntil'](Promise['allSettled'](d)['then'](e=>{e['forEach']((f,g)=>{f['status']==='rejected'&&console['error']('Scheduled\x20task\x20'+g+'\x20failed:',f['reason']);});}));}};async function ensureDatabaseInitialized(a){if(!a['DB'])throw new Error('Database\x20binding\x20not\x20configured');try{const b=await a['DB']['prepare']('SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27\x20AND\x20name=\x27users\x27\x20LIMIT\x201')['first']();if(b)return!![];console['log']('ğŸš€\x20Initializing\x20Quantum\x20Database\x20Schema...');const c=['CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20users\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20\x20\x20username\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20email\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20password_hash\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20quota\x20INTEGER\x20DEFAULT\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20used_traffic\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20expiry_date\x20DATE\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20status\x20TEXT\x20DEFAULT\x20\x27active\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20max_devices\x20INTEGER\x20DEFAULT\x205,\x0a\x20\x20\x20\x20\x20\x20\x20\x20referred_by\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20referral_code\x20TEXT\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20referral_balance\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20last_login\x20DATETIME,\x0a\x20\x20\x20\x20\x20\x20\x20\x20last_ip\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_level\x20TEXT\x20DEFAULT\x20\x27basic\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20trust_score\x20INTEGER\x20DEFAULT\x20100,\x0a\x20\x20\x20\x20\x20\x20\x20\x20quantum_key\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20last_password_change\x20DATETIME,\x0a\x20\x20\x20\x20\x20\x20\x20\x20failed_login_attempts\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20locked_until\x20DATETIME,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(referred_by)\x20REFERENCES\x20users(id)\x20ON\x20DELETE\x20SET\x20NULL\x0a\x20\x20\x20\x20\x20\x20)','CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20traffic_logs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_id\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20upload\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20download\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20duration\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20ip_address\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20country\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20city\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20protocol\x20TEXT\x20DEFAULT\x20\x27tcp\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20node_id\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20timestamp\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(user_id)\x20REFERENCES\x20users(id)\x20ON\x20DELETE\x20CASCADE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(node_id)\x20REFERENCES\x20nodes(id)\x20ON\x20DELETE\x20SET\x20NULL\x0a\x20\x20\x20\x20\x20\x20)','CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20nodes\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20domain\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20ip_address\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20location\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20protocol\x20TEXT\x20DEFAULT\x20\x27vless\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20port\x20INTEGER\x20DEFAULT\x20443,\x0a\x20\x20\x20\x20\x20\x20\x20\x20status\x20TEXT\x20DEFAULT\x20\x27healthy\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20latency\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20load_percent\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20active_connections\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20max_users\x20INTEGER\x20DEFAULT\x201000,\x0a\x20\x20\x20\x20\x20\x20\x20\x20max_bandwidth\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20total_traffic\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20last_check\x20DATETIME,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20BOOLEAN\x20DEFAULT\x201\x0a\x20\x20\x20\x20\x20\x20)','CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20banned_ips\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20ip_address\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20reason\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20banned_at\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20banned_until\x20DATETIME,\x0a\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20BOOLEAN\x20DEFAULT\x201,\x0a\x20\x20\x20\x20\x20\x20\x20\x20ban_count\x20INTEGER\x20DEFAULT\x201\x0a\x20\x20\x20\x20\x20\x20)','CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20security_events\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20event_type\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20severity\x20TEXT\x20DEFAULT\x20\x27info\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_id\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20ip_address\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_agent\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20details\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20timestamp\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(user_id)\x20REFERENCES\x20users(id)\x20ON\x20DELETE\x20SET\x20NULL\x0a\x20\x20\x20\x20\x20\x20)','CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20system_settings\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20key\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20\x20\x20value\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20description\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP\x0a\x20\x20\x20\x20\x20\x20)','CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sessions\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_id\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20ip_address\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_agent\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20expires_at\x20DATETIME\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20last_activity\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20BOOLEAN\x20DEFAULT\x201,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(user_id)\x20REFERENCES\x20users(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20\x20\x20)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_users_uuid\x20ON\x20users(uuid)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_users_status\x20ON\x20users(status)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_users_expiry\x20ON\x20users(expiry_date)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_traffic_user\x20ON\x20traffic_logs(user_id)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_traffic_timestamp\x20ON\x20traffic_logs(timestamp)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_traffic_date\x20ON\x20traffic_logs(DATE(timestamp))','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_security_type\x20ON\x20security_events(event_type)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_security_ip\x20ON\x20security_events(ip_address)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_security_timestamp\x20ON\x20security_events(timestamp)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_banned_ip\x20ON\x20banned_ips(ip_address)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_sessions_user\x20ON\x20sessions(user_id)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_sessions_expires\x20ON\x20sessions(expires_at)'];for(const d of c){await a['DB']['prepare'](d)['run']();}return await initializeDefaultSettings(a),console['log']('âœ…\x20Database\x20initialized\x20successfully'),!![];}catch(e){console['error']('âŒ\x20Database\x20initialization\x20failed:',e['message']);throw new Error('Database\x20initialization\x20failed:\x20'+e['message']);}}async function initializeDefaultSettings(a){const b=[['version',QUANTUM_CONFIG['VERSION'],'System\x20version'],['system_name',QUANTUM_CONFIG['SYSTEM_NAME'],'System\x20name'],['max_connections_per_user',QUANTUM_CONFIG['SECURITY']['MAX_CONNECTIONS_PER_USER']['toString'](),'Max\x20simultaneous\x20connections'],['enable_fragmentation','true','Enable\x20quantum\x20fragmentation'],['enable_udp','true','Enable\x20UDP\x20relay'],['enable_grpc','true','Enable\x20gRPC\x20support'],['telegram_alerts','true','Enable\x20Telegram\x20notifications'],['auto_backup','true','Enable\x20automatic\x20backup']];for(const [c,d,e]of b){await a['DB']['prepare']('INSERT\x20OR\x20IGNORE\x20INTO\x20system_settings\x20(key,\x20value,\x20description)\x20VALUES\x20(?,\x20?,\x20?)')['bind'](c,d,e)['run']();}}async function handleQuantumVLESS(a,b,c,d,e){const f=new WebSocketPair(),[g,h]=Object['values'](f);h['accept']();let i={'vlessHeader':null,'remoteSocket':null,'userInfo':null,'totalUpload':0x0,'totalDownload':0x0,'startTime':Date['now'](),'isActive':![],'connectionId':crypto['randomUUID']()};const j=async()=>{if(i['isActive']&&i['userInfo'])try{const k=Math['floor']((Date['now']()-i['startTime'])/0x3e8),l=i['totalUpload']+i['totalDownload'];l>0x0&&await b['DB']['batch']([b['DB']['prepare']('UPDATE\x20users\x20SET\x20used_traffic\x20=\x20used_traffic\x20+\x20?,\x20last_login\x20=\x20datetime(\x27now\x27),\x20last_ip\x20=\x20?\x20WHERE\x20id\x20=\x20?')['bind'](l,e,i['userInfo']['id']),b['DB']['prepare']('INSERT\x20INTO\x20traffic_logs\x20(user_id,\x20upload,\x20download,\x20duration,\x20ip_address,\x20country,\x20protocol,\x20timestamp)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20datetime(\x27now\x27))')['bind'](i['userInfo']['id'],i['totalUpload'],i['totalDownload'],k,e,a['cf']?.['country']||'XX',d)]);const m='conn:'+i['userInfo']['id'],n=parseInt(await b['QUANTUM_KV']['get'](m)||'1');await b['QUANTUM_KV']['put'](m,Math['max'](0x0,n-0x1)['toString'](),{'expirationTtl':0x12c});}catch(o){console['error']('Cleanup\x20error:',o);}if(i['remoteSocket'])try{i['remoteSocket']['close']();}catch(p){}};return h['addEventListener']('message',async k=>{try{const l=k['data']instanceof ArrayBuffer?new Uint8Array(k['data']):new Uint8Array(await k['data']['arrayBuffer']());if(!i['vlessHeader']){i['vlessHeader']=parseQuantumVLESSHeader(l);if(i['vlessHeader']['hasError']){h['close'](0x3eb,'Invalid\x20protocol'),await logSecurityEvent(b,'invalid_vless_header',null,e,'Malformed\x20VLESS\x20header\x20detected');return;}i['userInfo']=await b['DB']['prepare']('SELECT\x20*\x20FROM\x20users\x20WHERE\x20uuid\x20=\x20?\x20AND\x20status\x20=\x20\x27active\x27\x20AND\x20expiry_date\x20>=\x20date(\x27now\x27)')['bind'](i['vlessHeader']['uuid'])['first']();if(!i['userInfo']){h['close'](0x3f0,'Unauthorized'),await logSecurityEvent(b,'unauthorized_vless',null,e,'UUID:\x20'+i['vlessHeader']['uuid']['substring'](0x0,0x8)+'...');return;}const m=i['userInfo']['quota']*0x400*0x400*0x400;if(i['userInfo']['used_traffic']>=m){h['close'](0x3f0,'Quota\x20exceeded'),await sendTelegramAlert(b,'âš ï¸\x20Ú©Ø§Ø±Ø¨Ø±\x20'+i['userInfo']['username']+'\x20Ø¨Ù‡\x20Ø³Ù‚Ù\x20Ø­Ø¬Ù…\x20Ø±Ø³ÛŒØ¯');return;}const n='conn:'+i['userInfo']['id'],o=parseInt(await b['QUANTUM_KV']['get'](n)||'0');if(o>=QUANTUM_CONFIG['SECURITY']['MAX_CONNECTIONS_PER_USER']){h['close'](0x3f0,'Max\x20connections\x20reached'),await logSecurityEvent(b,'max_connections_exceeded',i['userInfo']['id'],e,'Active:\x20'+o+'/'+QUANTUM_CONFIG['SECURITY']['MAX_CONNECTIONS_PER_USER']);return;}await b['QUANTUM_KV']['put'](n,(o+0x1)['toString'](),{'expirationTtl':0x12c}),i['isActive']=!![];try{i['remoteSocket']=connect({'hostname':i['vlessHeader']['address'],'port':i['vlessHeader']['port']});const p=new Uint8Array([i['vlessHeader']['version'],0x0]);h['send'](p),pipeRemoteToClient(i['remoteSocket'],h,q=>{i['totalDownload']+=q;});}catch(q){console['error']('Connection\x20error:',q),h['close'](0x3f3,'Connection\x20failed'),await logSecurityEvent(b,'connection_failed',i['userInfo']['id'],e,'Target:\x20'+i['vlessHeader']['address']+':'+i['vlessHeader']['port']);return;}}else{if(i['remoteSocket']&&i['userInfo'])try{const r=i['remoteSocket']['writable']['getWriter'](),s=await applyQuantumEnhancements(l,i['userInfo']['quantum_key']);for(const t of s){await r['write'](t),i['totalUpload']+=t['byteLength'];}r['releaseLock']();}catch(u){console['error']('Write\x20error:',u),h['close'](0x3f3,'Write\x20failed');}}}catch(v){console['error']('Message\x20handler\x20error:',v),h['close'](0x3f3,'Internal\x20error');}}),h['addEventListener']('close',async()=>{await j();}),h['addEventListener']('error',async k=>{console['error']('WebSocket\x20error:',k),await j();}),new Response(null,{'status':0x65,'webSocket':g,'headers':getSecurityHeaders()});}function parseQuantumVLESSHeader(a){try{if(!a||a['length']<0x16)return{'hasError':!![],'reason':'Insufficient\x20header\x20length'};const b=new DataView(a['buffer']||a),c=b['getUint8'](0x0);if(c!==0x0)return{'hasError':!![],'reason':'Invalid\x20protocol\x20version'};const d=new Uint8Array(a['slice'](0x1,0x11)),e=Array['from'](d,m=>m['toString'](0x10)['padStart'](0x2,'0'))['join']('')['replace'](/(.{8})(.{4})(.{4})(.{4})(.{12})/,'$1-$2-$3-$4-$5'),f=b['getUint8'](0x11);if(f+0x16>a['length'])return{'hasError':!![],'reason':'Invalid\x20options\x20length'};const g=b['getUint8'](0x12+f),h=b['getUint16'](0x13+f),j=b['getUint8'](0x15+f);let k='',l=0x16+f;if(j===0x1){if(l+0x4>a['length'])return{'hasError':!![],'reason':'Invalid\x20IPv4\x20address'};k=Array['from'](a['slice'](l,l+0x4))['join']('.');}else{if(j===0x2){const m=b['getUint8'](l);if(l+0x1+m>a['length'])return{'hasError':!![],'reason':'Invalid\x20domain\x20length'};k=new TextDecoder()['decode'](a['slice'](l+0x1,l+0x1+m));}else{if(j===0x3){if(l+0x10>a['length'])return{'hasError':!![],'reason':'Invalid\x20IPv6\x20address'};const n=[];for(let o=0x0;o<0x8;o++){n['push'](b['getUint16'](l+o*0x2)['toString'](0x10));}k=n['join'](':');}else return{'hasError':!![],'reason':'Unknown\x20address\x20type'};}}if(!k||h<0x1||h>0xffff)return{'hasError':!![],'reason':'Invalid\x20address\x20or\x20port'};return{'version':c,'uuid':e,'address':k,'port':h,'command':g,'addressType':j,'hasError':![]};}catch(p){return console['error']('Parse\x20error:',p),{'hasError':!![],'reason':p['message']};}}async function applyQuantumEnhancements(a,b){if(!QUANTUM_CONFIG['QUANTUM_FEATURES']['ENABLE_FRAGMENTATION'])return[a];const c=[],d=QUANTUM_CONFIG['TRAFFIC_MASKING'];let e=0x0;const f=hashQuantumKey(b);let g=createSeededRandom(f);while(e<a['length']){const h=Math['min'](Math['floor'](g()*(d['MAX_FRAGMENT_SIZE']-d['MIN_FRAGMENT_SIZE'])+d['MIN_FRAGMENT_SIZE']),a['length']-e);let i=a['slice'](e,e+h);if(QUANTUM_CONFIG['QUANTUM_FEATURES']['ENABLE_PADDING']&&g()<d['PADDING_PROBABILITY']){const j=Math['floor'](g()*d['MAX_PADDING_SIZE']),k=new Uint8Array(j);crypto['getRandomValues'](k);const l=new Uint8Array(i['length']+k['length']+0x1);l['set'](i),l[i['length']]=j,l['set'](k,i['length']+0x1),i=l;}c['push'](i),e+=h;if(QUANTUM_CONFIG['QUANTUM_FEATURES']['ENABLE_TIMING_OBFUSCATION']&&c['length']<0xa){const m=Math['floor'](g()*d['TIMING_JITTER_MS']);await new Promise(n=>setTimeout(n,m));}}return c;}function hashQuantumKey(a){let b=0x0;for(let c=0x0;c<a['length'];c++){b=(b<<0x5)-b+a['charCodeAt'](c),b=b&b;}return Math['abs'](b);}function createSeededRandom(a){let b=a;return function(){return b=(b*0x2455+0xc091)%0x38f40,b/0x38f40;};}async function pipeRemoteToClient(a,b,c){try{const d=a['readable']['getReader']();while(!![]){const {value:f,done:g}=await d['read']();if(g)break;if(b['readyState']===WebSocket['OPEN']){b['send'](f);if(c)c(f['byteLength']);}else break;}}catch(h){console['error']('Pipe\x20error:',h);}finally{try{reader['releaseLock']();if(b['readyState']===WebSocket['OPEN'])b['close']();}catch(i){}}}async function checkRateLimit(a,b){if(!a)return{'allowed':!![]};try{const c='ratelimit:'+a,d=Date['now'](),e=await b['QUANTUM_KV']['get'](c,'json')||{'tokens':QUANTUM_CONFIG['SECURITY']['RATE_LIMIT_PER_MINUTE'],'lastRefill':d},f=d-e['lastRefill'],g=Math['floor'](f/0xea60)*QUANTUM_CONFIG['SECURITY']['RATE_LIMIT_PER_MINUTE'];e['tokens']=Math['min'](QUANTUM_CONFIG['SECURITY']['RATE_LIMIT_BURST'],e['tokens']+g),e['lastRefill']=d;if(e['tokens']<0x1){const h=Math['ceil']((0xea60-f%0xea60)/0x3e8);return{'allowed':![],'current':0x0,'retryAfter':h};}return e['tokens']-=0x1,await b['QUANTUM_KV']['put'](c,JSON['stringify'](e),{'expirationTtl':0x78}),{'allowed':!![],'current':Math['floor'](e['tokens'])};}catch(i){return console['error']('Rate\x20limit\x20check\x20error:',i),{'allowed':!![]};}}async function isIPBanned(a,b){if(!a)return![];try{const c=await b['DB']['prepare']('SELECT\x201\x20FROM\x20banned_ips\x20\x0a\x20\x20\x20\x20\x20\x20\x20WHERE\x20ip_address\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20\x20AND\x20is_active\x20=\x201\x20\x0a\x20\x20\x20\x20\x20\x20\x20AND\x20(banned_until\x20IS\x20NULL\x20OR\x20banned_until\x20>\x20datetime(\x27now\x27))')['bind'](a)['first']();return!!c;}catch(d){return console['error']('Ban\x20check\x20error:',d),![];}}async function handleAdminLogin(a,b,c){try{const d='login_lock:'+c,e=await b['QUANTUM_KV']['get'](d);if(e){const k=JSON['parse'](e),l=Math['ceil']((k['until']-Date['now']())/0x3e8/0x3c);return jsonResponse({'error':'Too\x20many\x20failed\x20attempts','lockedUntil':k['until'],'remainingMinutes':l},0x1ad);}const {password:f}=await a['json']();if(!f||f['length']<QUANTUM_CONFIG['SECURITY']['PASSWORD_MIN_LENGTH'])return await incrementFailedAttempts(c,b),jsonResponse({'error':'Invalid\x20credentials'},0x191);const g=b['ADMIN_KEY']||'quantum-shield-2025-change-this',[h,i]=await Promise['all']([strongHash(f),strongHash(g)]),j=await constantTimeCompare(h,i);if(j){await b['QUANTUM_KV']['delete']('login_attempts:'+c);const m=crypto['randomUUID'](),n={'valid':!![],'created':Date['now'](),'ip':c,'userAgent':a['headers']['get']('User-Agent')};return await b['QUANTUM_KV']['put']('session:'+m,JSON['stringify'](n),{'expirationTtl':QUANTUM_CONFIG['SECURITY']['SESSION_TIMEOUT_HOURS']*0xe10}),await logSecurityEvent(b,'admin_login_success','admin',c,'Successful\x20admin\x20authentication'),jsonResponse({'success':!![],'token':m,'expiresIn':QUANTUM_CONFIG['SECURITY']['SESSION_TIMEOUT_HOURS']*0xe10});}return await incrementFailedAttempts(c,b),await logSecurityEvent(b,'admin_login_failed',null,c,'Invalid\x20admin\x20credentials'),jsonResponse({'error':'Invalid\x20credentials'},0x191);}catch(o){return console['error']('Login\x20error:',o),jsonResponse({'error':'Authentication\x20failed'},0x1f4);}}async function incrementFailedAttempts(a,b){const c='login_attempts:'+a,d=parseInt(await b['QUANTUM_KV']['get'](c)||'0')+0x1;await b['QUANTUM_KV']['put'](c,d['toString'](),{'expirationTtl':QUANTUM_CONFIG['SECURITY']['LOGIN_COOLDOWN_MINUTES']*0x3c});if(d>=QUANTUM_CONFIG['SECURITY']['MAX_LOGIN_ATTEMPTS']){const e=Date['now']()+QUANTUM_CONFIG['SECURITY']['LOGIN_COOLDOWN_MINUTES']*0x3c*0x3e8;await b['QUANTUM_KV']['put']('login_lock:'+a,JSON['stringify']({'until':e,'attempts':d}),{'expirationTtl':QUANTUM_CONFIG['SECURITY']['LOGIN_COOLDOWN_MINUTES']*0x3c}),await logSecurityEvent(b,'account_locked',null,a,'Locked\x20after\x20'+d+'\x20failed\x20attempts');}}async function strongHash(a){const b=new TextEncoder(),c='quantum-salt-v6-2025-enhanced',d=b['encode'](a+c),e=await crypto['subtle']['digest']('SHA-256',d),f=Array['from'](new Uint8Array(e));return f['map'](g=>g['toString'](0x10)['padStart'](0x2,'0'))['join']('');}async function constantTimeCompare(c,d){if(c['length']!==d['length'])return await new Promise(f=>setTimeout(f,0xa)),![];let e=0x0;for(let f=0x0;f<c['length'];f++){e|=c['charCodeAt'](f)^d['charCodeAt'](f);}return await new Promise(g=>setTimeout(g,0xa)),e===0x0;}async function validateSession(a,b){if(!a)return![];try{const c=await b['QUANTUM_KV']['get']('session:'+a);if(!c)return![];const d=JSON['parse'](c);return d['valid']===!![];}catch(e){return![];}}async function handleAPIRequest(a,b,c){const d=new URL(a['url']),e=d['pathname'],f=a['method'],g=a['headers']['get']('Authorization'),h=g?.['replace']('Bearer\x20','');if(!await validateSession(h,b))return jsonResponse({'error':'Unauthorized','code':'INVALID_TOKEN'},0x191);try{if(e===QUANTUM_CONFIG['PATHS']['API']+'/stats'&&f==='GET'){const i=await b['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20COUNT(*)\x20FROM\x20users)\x20as\x20total_users,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20COUNT(*)\x20FROM\x20users\x20WHERE\x20status\x20=\x20\x27active\x27)\x20as\x20active_users,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20COUNT(*)\x20FROM\x20users\x20WHERE\x20status\x20=\x20\x27expired\x27)\x20as\x20expired_users,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20COALESCE(SUM(used_traffic),\x200)\x20FROM\x20users)\x20as\x20total_traffic,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20COUNT(DISTINCT\x20user_id)\x20FROM\x20traffic_logs\x20WHERE\x20DATE(timestamp)\x20=\x20DATE(\x27now\x27))\x20as\x20active_today,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20COUNT(*)\x20FROM\x20nodes\x20WHERE\x20is_active\x20=\x201)\x20as\x20active_nodes,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20AVG(latency)\x20FROM\x20nodes\x20WHERE\x20is_active\x20=\x201\x20AND\x20status\x20=\x20\x27healthy\x27)\x20as\x20avg_latency\x0a\x20\x20\x20\x20\x20\x20')['first'](),j=await b['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20count,\x20protocol\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20traffic_logs\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20timestamp\x20>\x20datetime(\x27now\x27,\x20\x27-1\x20hour\x27)\x0a\x20\x20\x20\x20\x20\x20\x20\x20GROUP\x20BY\x20protocol\x0a\x20\x20\x20\x20\x20\x20')['all']();return jsonResponse({'totalUsers':i?.['total_users']||0x0,'activeUsers':i?.['active_users']||0x0,'expiredUsers':i?.['expired_users']||0x0,'totalTrafficGB':((i?.['total_traffic']||0x0)/0x40000000)['toFixed'](0x2),'activeToday':i?.['active_today']||0x0,'activeNodes':i?.['active_nodes']||0x0,'avgLatency':Math['round'](i?.['avg_latency']||0x0),'recentActivity':j['results']||[],'version':QUANTUM_CONFIG['VERSION'],'systemName':QUANTUM_CONFIG['SYSTEM_NAME'],'uptime':process?.['uptime']?.()||0x0});}if(e===QUANTUM_CONFIG['PATHS']['API']+'/users'&&f==='GET'){const k=parseInt(d['searchParams']['get']('page')||'1'),l=parseInt(d['searchParams']['get']('limit')||'50'),m=d['searchParams']['get']('status')||'',n=(k-0x1)*l;let o='SELECT\x20id,\x20username,\x20uuid,\x20email,\x20quota,\x20used_traffic,\x20status,\x20expiry_date,\x20last_login,\x20user_level,\x20created_at\x20FROM\x20users',p='SELECT\x20COUNT(*)\x20as\x20total\x20FROM\x20users';const q=[];m&&(o+='\x20WHERE\x20status\x20=\x20?',p+='\x20WHERE\x20status\x20=\x20?',q['push'](m));o+='\x20ORDER\x20BY\x20created_at\x20DESC\x20LIMIT\x20?\x20OFFSET\x20?';const [r,s]=await Promise['all']([b['DB']['prepare'](o)['bind'](...q,l,n)['all'](),b['DB']['prepare'](p)['bind'](...q)['first']()]),t=b['DOMAIN']||a['headers']['get']('host'),u=(r['results']||[])['map'](v=>({'id':v['id'],'username':v['username'],'uuid':v['uuid'],'email':v['email'],'quota':v['quota'],'usedGB':((v['used_traffic']||0x0)/0x40000000)['toFixed'](0x2),'usagePercent':((v['used_traffic']||0x0)/(v['quota']*0x40000000)*0x64)['toFixed'](0x1),'status':v['status'],'expiry':v['expiry_date'],'lastLogin':v['last_login'],'userLevel':v['user_level'],'createdAt':v['created_at'],'subscriptionLink':generateSubscriptionURL(v['uuid'],t),'panelLink':'https://'+t+QUANTUM_CONFIG['PATHS']['USER_PANEL']+'?uuid='+v['uuid']}));return jsonResponse({'users':u,'pagination':{'page':k,'limit':l,'total':s?.['total']||0x0,'totalPages':Math['ceil']((s?.['total']||0x0)/l)}});}if(e['match'](/\/api\/v2\/users\/[^/]+$/)&&f==='GET'){const v=e['split']('/')['pop'](),w=await b['DB']['prepare']('SELECT\x20*\x20FROM\x20users\x20WHERE\x20id\x20=\x20?\x20OR\x20uuid\x20=\x20?')['bind'](v,v)['first']();if(!w)return jsonResponse({'error':'User\x20not\x20found'},0x194);const x=await b['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SUM(upload)\x20as\x20total_upload,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SUM(download)\x20as\x20total_download,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20as\x20session_count,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20MAX(timestamp)\x20as\x20last_session\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20traffic_logs\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20user_id\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20')['bind'](w['id'])['first'](),y=await b['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20upload,\x20download,\x20duration,\x20ip_address,\x20country,\x20protocol,\x20timestamp\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20traffic_logs\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20user_id\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x20timestamp\x20DESC\x0a\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x2010\x0a\x20\x20\x20\x20\x20\x20')['bind'](w['id'])['all']();return jsonResponse({...w,'usedGB':((w['used_traffic']||0x0)/0x40000000)['toFixed'](0x2),'quotaGB':w['quota'],'trafficStats':{'totalUploadGB':((x?.['total_upload']||0x0)/0x40000000)['toFixed'](0x2),'totalDownloadGB':((x?.['total_download']||0x0)/0x40000000)['toFixed'](0x2),'sessionCount':x?.['session_count']||0x0,'lastSession':x?.['last_session']},'recentSessions':y['results']||[]});}if(e===QUANTUM_CONFIG['PATHS']['API']+'/users'&&f==='POST'){const z=await a['json']();if(!z['username'])return jsonResponse({'error':'Username\x20is\x20required'},0x190);const A=crypto['randomUUID'](),B=z['uuid']||crypto['randomUUID'](),C=z['username']['trim'](),D=z['email']||null,E=parseInt(z['quota'])||0x32,F=z['expiry_date']||new Date(Date['now']()+0x1e*0x18*0x3c*0x3c*0x3e8)['toISOString']()['split']('T')[0x0],G=z['user_level']||'basic',H=parseInt(z['max_devices'])||0x5,I=crypto['randomUUID'](),J=generateReferralCode(C);try{await b['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20users\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20username,\x20uuid,\x20email,\x20quota,\x20expiry_date,\x20user_level,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20max_devices,\x20quantum_key,\x20referral_code,\x20created_at\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20datetime(\x27now\x27))\x0a\x20\x20\x20\x20\x20\x20\x20\x20')['bind'](A,C,B,D,E,F,G,H,I,J)['run']();const K=b['DOMAIN']||a['headers']['get']('host'),L=generateSubscriptionURL(B,K),M='https://'+K+QUANTUM_CONFIG['PATHS']['USER_PANEL']+'?uuid='+B;return await sendTelegramAlert(b,'âœ…\x20Ú©Ø§Ø±Ø¨Ø±\x20Ø¬Ø¯ÛŒØ¯\x20Ø³Ø§Ø®ØªÙ‡\x20Ø´Ø¯\x0a\x0a'+('ğŸ‘¤\x20Ù†Ø§Ù…:\x20'+C+'\x0a')+('ğŸ“¦\x20Ø­Ø¬Ù…:\x20'+E+'\x20GB\x0a')+('ğŸ“…\x20Ø§Ù†Ù‚Ø¶Ø§:\x20'+F+'\x0a')+('ğŸ”—\x20UUID:\x20'+B['substring'](0x0,0x8)+'...')),await logSecurityEvent(b,'user_created',A,c,'Created\x20user:\x20'+C),jsonResponse({'success':!![],'user':{'id':A,'uuid':B,'username':C,'email':D,'quota':E,'expiryDate':F,'userLevel':G,'referralCode':J,'subscriptionLink':L,'panelLink':M}},0xc9);}catch(N){if(N['message']?.['includes']('UNIQUE\x20constraint\x20failed'))return jsonResponse({'error':'Username\x20or\x20UUID\x20already\x20exists','code':'DUPLICATE_USER'},0x199);throw N;}}if(e['match'](/\/api\/v2\/users\/[^/]+$/)&&f==='PUT'){const O=e['split']('/')['pop'](),P=await a['json'](),Q=[],R=[];P['quota']!==undefined&&(Q['push']('quota\x20=\x20?'),R['push'](parseInt(P['quota'])));P['expiry_date']&&(Q['push']('expiry_date\x20=\x20?'),R['push'](P['expiry_date']));P['status']&&(Q['push']('status\x20=\x20?'),R['push'](P['status']));P['user_level']&&(Q['push']('user_level\x20=\x20?'),R['push'](P['user_level']));P['max_devices']!==undefined&&(Q['push']('max_devices\x20=\x20?'),R['push'](parseInt(P['max_devices'])));if(Q['length']===0x0)return jsonResponse({'error':'No\x20fields\x20to\x20update'},0x190);return R['push'](O),await b['DB']['prepare']('UPDATE\x20users\x20SET\x20'+Q['join'](',\x20')+'\x20WHERE\x20id\x20=\x20?')['bind'](...R)['run'](),await logSecurityEvent(b,'user_updated',O,c,'Updated\x20fields:\x20'+Q['join'](',\x20')),jsonResponse({'success':!![],'updated':Q['length']});}if(e['match'](/\/api\/v2\/users\/[^/]+$/)&&f==='DELETE'){const S=e['split']('/')['pop'](),T=await b['DB']['prepare']('SELECT\x20username\x20FROM\x20users\x20WHERE\x20id\x20=\x20?')['bind'](S)['first']();if(!T)return jsonResponse({'error':'User\x20not\x20found'},0x194);return await b['DB']['prepare']('DELETE\x20FROM\x20users\x20WHERE\x20id\x20=\x20?')['bind'](S)['run'](),await sendTelegramAlert(b,'ğŸ—‘ï¸\x20Ú©Ø§Ø±Ø¨Ø±\x20Ø­Ø°Ù\x20Ø´Ø¯:\x20'+T['username']),await logSecurityEvent(b,'user_deleted',S,c,'Deleted\x20user:\x20'+T['username']),jsonResponse({'success':!![],'deleted':T['username']});}if(e['match'](/\/api\/v2\/users\/[^/]+\/reset-traffic$/)&&f==='POST'){const U=e['split']('/')[0x4];return await b['DB']['prepare']('UPDATE\x20users\x20SET\x20used_traffic\x20=\x200\x20WHERE\x20id\x20=\x20?')['bind'](U)['run'](),await logSecurityEvent(b,'traffic_reset',U,c,'Traffic\x20reset\x20to\x20zero'),jsonResponse({'success':!![],'message':'Traffic\x20reset\x20successfully'});}if(e===QUANTUM_CONFIG['PATHS']['API']+'/today-stats'&&f==='GET'){const V=await b['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(DISTINCT\x20user_id)\x20as\x20active_today,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SUM(upload\x20+\x20download)\x20as\x20traffic_today,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20as\x20sessions_today,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AVG(duration)\x20as\x20avg_duration,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(DISTINCT\x20ip_address)\x20as\x20unique_ips\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20traffic_logs\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20DATE(timestamp)\x20=\x20DATE(\x27now\x27)\x0a\x20\x20\x20\x20\x20\x20')['first'](),W=await b['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20strftime(\x27%H\x27,\x20timestamp)\x20as\x20hour,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20as\x20sessions,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SUM(upload\x20+\x20download)\x20as\x20traffic\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20traffic_logs\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20DATE(timestamp)\x20=\x20DATE(\x27now\x27)\x0a\x20\x20\x20\x20\x20\x20\x20\x20GROUP\x20BY\x20hour\x0a\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x20hour\x0a\x20\x20\x20\x20\x20\x20')['all']();return jsonResponse({'activeToday':V?.['active_today']||0x0,'trafficTodayGB':((V?.['traffic_today']||0x0)/0x40000000)['toFixed'](0x2),'sessionsToday':V?.['sessions_today']||0x0,'avgDurationSeconds':Math['floor'](V?.['avg_duration']||0x0),'uniqueIPs':V?.['unique_ips']||0x0,'hourlyDistribution':W['results']||[]});}if(e===QUANTUM_CONFIG['PATHS']['API']+'/nodes'&&f==='GET'){const {results:X}=await b['DB']['prepare']('SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20name,\x20domain,\x20ip_address,\x20location,\x20protocol,\x20port,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20status,\x20latency,\x20load_percent,\x20active_connections,\x20max_users,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20total_traffic,\x20last_check,\x20is_active\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20nodes\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x20created_at\x20DESC')['all'](),Y=(X||[])['map'](Z=>({...Z,'totalTrafficGB':((Z['total_traffic']||0x0)/0x40000000)['toFixed'](0x2),'utilizationPercent':Z['max_users']>0x0?(Z['active_connections']/Z['max_users']*0x64)['toFixed'](0x1):0x0,'healthStatus':Z['status']==='healthy'?'âœ…':Z['status']==='degraded'?'âš ï¸':'âŒ'}));return jsonResponse(Y);}if(e===QUANTUM_CONFIG['PATHS']['API']+'/security-events'&&f==='GET'){const Z=parseInt(d['searchParams']['get']('limit')||'100'),a0=d['searchParams']['get']('type')||'';let a1='SELECT\x20*\x20FROM\x20security_events';const a2=[];a0&&(a1+='\x20WHERE\x20event_type\x20=\x20?',a2['push'](a0));a1+='\x20ORDER\x20BY\x20timestamp\x20DESC\x20LIMIT\x20?',a2['push'](Z);const {results:a3}=await b['DB']['prepare'](a1)['bind'](...a2)['all']();return jsonResponse(a3||[]);}if(e===QUANTUM_CONFIG['PATHS']['API']+'/backup'&&f==='POST'){const a4=await performAutoBackup(b);return jsonResponse({'success':!![],'message':a4,'timestamp':new Date()['toISOString']()});}return jsonResponse({'error':'Endpoint\x20not\x20found','availableEndpoints':['GET\x20/api/v2/stats','GET\x20/api/v2/users','POST\x20/api/v2/users','GET\x20/api/v2/users/:id','PUT\x20/api/v2/users/:id','DELETE\x20/api/v2/users/:id','POST\x20/api/v2/users/:id/reset-traffic','GET\x20/api/v2/today-stats','GET\x20/api/v2/nodes','GET\x20/api/v2/security-events','POST\x20/api/v2/backup']},0x194);}catch(a5){return console['error']('API\x20error:',a5),jsonResponse({'error':'Internal\x20server\x20error','message':a5['message']},0x1f4);}}async function handleTelegramWebhook(a,b){try{const c=await a['json'](),d=c['message'];if(!d||!d['text'])return jsonResponse({'ok':!![]});const e=d['chat']['id'],f=d['text']['trim'](),g=d['from']['id']['toString'](),h=d['from']['username']||d['from']['first_name'];if(g!==(b['ADMIN_TELEGRAM_ID']||'0'))return await sendTelegramMessage(e,'â›”\x20Ø´Ù…Ø§\x20Ù…Ø¬ÙˆØ²\x20Ø¯Ø³ØªØ±Ø³ÛŒ\x20Ø¨Ù‡\x20Ø§ÛŒÙ†\x20Ø¨Ø§Øª\x20Ø±Ø§\x20Ù†Ø¯Ø§Ø±ÛŒØ¯',b),jsonResponse({'ok':!![]});let i='';if(f==='/start'||f==='/help')i='ğŸ¤–\x20<b>Quantum\x20Shield\x20V6.0\x20Bot</b>\x0a\x0a<b>ğŸ“Š\x20Ø¢Ù…Ø§Ø±\x20Ùˆ\x20Ú¯Ø²Ø§Ø±Ø´:</b>\x0a/stats\x20-\x20Ø¢Ù…Ø§Ø±\x20Ú©Ù„ÛŒ\x20Ø³ÛŒØ³ØªÙ…\x0a/today\x20-\x20Ø¢Ù…Ø§Ø±\x20Ø§Ù…Ø±ÙˆØ²\x0a/users\x20-\x20Ù„ÛŒØ³Øª\x20Ú©Ø§Ø±Ø¨Ø±Ø§Ù†\x20ÙØ¹Ø§Ù„\x0a/nodes\x20-\x20ÙˆØ¶Ø¹ÛŒØª\x20Ù†ÙˆØ¯Ù‡Ø§\x0a/events\x20-\x20Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ\x20Ø§Ù…Ù†ÛŒØªÛŒ\x0a\x0a<b>ğŸ‘¥\x20Ù…Ø¯ÛŒØ±ÛŒØª\x20Ú©Ø§Ø±Ø¨Ø±Ø§Ù†:</b>\x0a/newuser\x20[Ù†Ø§Ù…]\x20[Ø­Ø¬Ù…]\x20[ØªØ§Ø±ÛŒØ®]\x20-\x20Ø³Ø§Ø®Øª\x20Ú©Ø§Ø±Ø¨Ø±\x0a/find\x20[Ù†Ø§Ù…]\x20-\x20Ø¬Ø³ØªØ¬ÙˆÛŒ\x20Ú©Ø§Ø±Ø¨Ø±\x0a/reset\x20[uuid]\x20-\x20Ø±ÛŒØ³Øª\x20ØªØ±Ø§ÙÛŒÚ©\x0a/delete\x20[uuid]\x20-\x20Ø­Ø°Ù\x20Ú©Ø§Ø±Ø¨Ø±\x0a\x0a<b>ğŸ”§\x20Ø³ÛŒØ³ØªÙ…:</b>\x0a/backup\x20-\x20Ø¨Ú©â€ŒØ¢Ù¾\x20Ø¯ÛŒØªØ§Ø¨ÛŒØ³\x0a/health\x20-\x20ÙˆØ¶Ø¹ÛŒØª\x20Ø³Ù„Ø§Ù…Øª\x20Ø³ÛŒØ³ØªÙ…\x0a/settings\x20-\x20ØªÙ†Ø¸ÛŒÙ…Ø§Øª\x20ÙØ¹Ù„ÛŒ\x0a\x0ağŸ’¡\x20ÛŒØ§\x20Ø³ÙˆØ§Ù„\x20Ø®ÙˆØ¯\x20Ø±Ø§\x20Ø¨Ù¾Ø±Ø³ÛŒØ¯!';else{if(f==='/stats'){const j=await b['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20COUNT(*)\x20FROM\x20users)\x20as\x20total,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20COUNT(*)\x20FROM\x20users\x20WHERE\x20status\x20=\x20\x27active\x27)\x20as\x20active,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20COUNT(*)\x20FROM\x20users\x20WHERE\x20status\x20=\x20\x27expired\x27)\x20as\x20expired,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20COALESCE(SUM(used_traffic),\x200)\x20FROM\x20users)\x20as\x20traffic,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20COUNT(DISTINCT\x20user_id)\x20FROM\x20traffic_logs\x20WHERE\x20DATE(timestamp)\x20=\x20DATE(\x27now\x27))\x20as\x20today\x0a\x20\x20\x20\x20\x20\x20')['first'](),k=((j?.['traffic']||0x0)/0x40000000)['toFixed'](0x2);i='ğŸ“Š\x20<b>Ø¢Ù…Ø§Ø±\x20Ø³ÛŒØ³ØªÙ…</b>\x0a\x0ağŸ‘¥\x20Ú©Ù„\x20Ú©Ø§Ø±Ø¨Ø±Ø§Ù†:\x20'+(j?.['total']||0x0)+'\x0ağŸŸ¢\x20ÙØ¹Ø§Ù„:\x20'+(j?.['active']||0x0)+'\x0ağŸ”´\x20Ù…Ù†Ù‚Ø¶ÛŒ:\x20'+(j?.['expired']||0x0)+'\x0ağŸ“¦\x20ØªØ±Ø§ÙÛŒÚ©\x20Ú©Ù„:\x20'+k+'\x20GB\x0aâš¡\x20ÙØ¹Ø§Ù„\x20Ø§Ù…Ø±ÙˆØ²:\x20'+(j?.['today']||0x0)+'\x0a\x0ağŸ·ï¸\x20Ù†Ø³Ø®Ù‡:\x20'+QUANTUM_CONFIG['VERSION']+'\x0aâœ…\x20ÙˆØ¶Ø¹ÛŒØª:\x20Ø¹Ø§Ù„ÛŒ';}else{if(f['startsWith']('/newuser')){const l=f['split']('\x20')['filter'](t=>t),m=l[0x1]||'user_'+Date['now'](),n=parseInt(l[0x2])||0x32,o=l[0x3]||new Date(Date['now']()+0x1e*0x18*0x3c*0x3c*0x3e8)['toISOString']()['split']('T')[0x0],p=crypto['randomUUID'](),q=crypto['randomUUID'](),r=crypto['randomUUID'](),s=generateReferralCode(m);try{await b['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20users\x20(id,\x20username,\x20uuid,\x20quota,\x20expiry_date,\x20quantum_key,\x20referral_code,\x20created_at)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20datetime(\x27now\x27))\x0a\x20\x20\x20\x20\x20\x20\x20\x20')['bind'](p,m,q,n,o,r,s)['run']();const t=b['DOMAIN']||'your-worker.workers.dev',u=generateSubscriptionURL(q,t),v='https://'+t+QUANTUM_CONFIG['PATHS']['USER_PANEL']+'?uuid='+q;i='âœ…\x20<b>Ú©Ø§Ø±Ø¨Ø±\x20Ø³Ø§Ø®ØªÙ‡\x20Ø´Ø¯!</b>\x0a\x0ağŸ‘¤\x20Ù†Ø§Ù…:\x20'+m+'\x0ağŸ†”\x20UUID:\x20<code>'+q+'</code>\x0ağŸ“¦\x20Ø­Ø¬Ù…:\x20'+n+'\x20GB\x0ağŸ“…\x20Ø§Ù†Ù‚Ø¶Ø§:\x20'+o+'\x0ağŸŸï¸\x20Ú©Ø¯\x20Ù…Ø¹Ø±Ù:\x20<code>'+s+'</code>\x0a\x0ağŸ”—\x20<b>Ù„ÛŒÙ†Ú©\x20Ø§Ø´ØªØ±Ø§Ú©:</b>\x0a<code>'+u+'</code>\x0a\x0ağŸŒ\x20<b>Ù¾Ù†Ù„\x20Ú©Ø§Ø±Ø¨Ø±ÛŒ:</b>\x0a'+v+'\x0a\x0ağŸ“‹\x20Ù„ÛŒÙ†Ú©\x20Ø±Ø§\x20Ø¯Ø±\x20V2Ray\x20ÙˆØ§Ø±Ø¯\x20Ú©Ù†ÛŒØ¯';}catch(w){i='âŒ\x20Ø®Ø·Ø§\x20Ø¯Ø±\x20Ø³Ø§Ø®Øª\x20Ú©Ø§Ø±Ø¨Ø±:\x20'+w['message'];}}else{if(f==='/users'){const {results:x}=await b['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ROUND(CAST(used_traffic\x20AS\x20REAL)\x20/\x201073741824,\x202)\x20as\x20used,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20quota,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20status,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20expiry_date\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20users\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20status\x20=\x20\x27active\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x20created_at\x20DESC\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x2010\x0a\x20\x20\x20\x20\x20\x20')['all']();i='ğŸ‘¥\x20<b>Ú©Ø§Ø±Ø¨Ø±Ø§Ù†\x20ÙØ¹Ø§Ù„\x20(10\x20ØªØ§ÛŒ\x20Ø§ÙˆÙ„):</b>\x0a\x0a',(x||[])['forEach'](y=>{const z=Math['round'](y['used']/y['quota']*0x64),A=generateProgressBar(z);i+='â€¢\x20<b>'+y['username']+'</b>\x0a\x20\x20'+A+'\x20'+y['used']+'/'+y['quota']+'\x20GB\x20('+z+'%)\x0a\x20\x20Ø§Ù†Ù‚Ø¶Ø§:\x20'+y['expiry_date']+'\x0a\x0a';});}else{if(f==='/today'){const y=await b['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(DISTINCT\x20user_id)\x20as\x20active,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SUM(upload\x20+\x20download)\x20as\x20traffic,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20as\x20sessions,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AVG(duration)\x20as\x20avg_duration\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20traffic_logs\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20DATE(timestamp)\x20=\x20DATE(\x27now\x27)\x0a\x20\x20\x20\x20\x20\x20')['first'](),z=((y?.['traffic']||0x0)/0x40000000)['toFixed'](0x2),A=Math['floor']((y?.['avg_duration']||0x0)/0x3c);i='ğŸ“…\x20<b>Ø¢Ù…Ø§Ø±\x20Ø§Ù…Ø±ÙˆØ²</b>\x0a\x0ağŸ‘¥\x20Ú©Ø§Ø±Ø¨Ø±Ø§Ù†\x20ÙØ¹Ø§Ù„:\x20'+(y?.['active']||0x0)+'\x0ağŸ“¦\x20ØªØ±Ø§ÙÛŒÚ©:\x20'+z+'\x20GB\x0ağŸ”Œ\x20Ø§ØªØµØ§Ù„Ø§Øª:\x20'+(y?.['sessions']||0x0)+'\x0aâ±ï¸\x20Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†\x20Ù…Ø¯Øª:\x20'+A+'\x20Ø¯Ù‚ÛŒÙ‚Ù‡';}else{if(f==='/backup')i=await performAutoBackup(b);else{if(f==='/nodes'){const {results:B}=await b['DB']['prepare']('SELECT\x20name,\x20status,\x20latency,\x20load_percent\x20FROM\x20nodes\x20WHERE\x20is_active\x20=\x201')['all']();i='ğŸŒ\x20<b>ÙˆØ¶Ø¹ÛŒØª\x20Ù†ÙˆØ¯Ù‡Ø§:</b>\x0a\x0a',B&&B['length']>0x0?B['forEach'](C=>{const D=C['status']==='healthy'?'âœ…':C['status']==='degraded'?'âš ï¸':'âŒ';i+=D+'\x20<b>'+C['name']+'</b>\x0a\x20\x20Latency:\x20'+(C['latency']||0x0)+'ms\x20|\x20Load:\x20'+(C['load_percent']||0x0)+'%\x0a\x0a';}):i='âš ï¸\x20Ù‡ÛŒÚ†\x20Ù†ÙˆØ¯ÛŒ\x20ØªØ¹Ø±ÛŒÙ\x20Ù†Ø´Ø¯Ù‡\x20Ø§Ø³Øª';}else{if(f==='/events'){const {results:C}=await b['DB']['prepare']('SELECT\x20event_type,\x20COUNT(*)\x20as\x20count\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20security_events\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20DATE(timestamp)\x20=\x20DATE(\x27now\x27)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20GROUP\x20BY\x20event_type\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x20count\x20DESC\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x205')['all']();i='ğŸ”’\x20<b>Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ\x20Ø§Ù…Ù†ÛŒØªÛŒ\x20Ø§Ù…Ø±ÙˆØ²:</b>\x0a\x0a',C&&C['length']>0x0?C['forEach'](D=>{i+='â€¢\x20'+D['event_type']+':\x20'+D['count']+'\x20Ø¨Ø§Ø±\x0a';}):i='âœ…\x20Ù‡ÛŒÚ†\x20Ø±ÙˆÛŒØ¯Ø§Ø¯\x20Ø§Ù…Ù†ÛŒØªÛŒ\x20Ø«Ø¨Øª\x20Ù†Ø´Ø¯Ù‡';}else{if(f==='/health'){const D=await b['DB']['prepare']('SELECT\x201')['first'](),E=await b['QUANTUM_KV']['get']('health_check');await b['QUANTUM_KV']['put']('health_check',Date['now']()['toString'](),{'expirationTtl':0x3c}),i='ğŸ¥\x20<b>ÙˆØ¶Ø¹ÛŒØª\x20Ø³Ù„Ø§Ù…Øª\x20Ø³ÛŒØ³ØªÙ…</b>\x0a\x0aâœ…\x20Ø¯ÛŒØªØ§Ø¨ÛŒØ³:\x20'+(D?'Ø³Ø§Ù„Ù…':'âŒ\x20Ø®Ø·Ø§')+'\x0aâœ…\x20KV\x20Storage:\x20'+(E!==null?'Ø³Ø§Ù„Ù…':'âš ï¸\x20Ø§ÙˆÙ„ÛŒÙ†\x20Ø¨Ø±Ø±Ø³ÛŒ')+'\x0aâœ…\x20Worker:\x20ÙØ¹Ø§Ù„\x0aâš¡\x20Ù†Ø³Ø®Ù‡:\x20'+QUANTUM_CONFIG['VERSION']+'\x0a\x0aÙ‡Ù…Ù‡\x20Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§\x20Ø¹Ù…Ù„ÛŒØ§ØªÛŒ\x20Ù‡Ø³ØªÙ†Ø¯';}else{if(f['startsWith']('/find')){const F=f['split']('\x20')[0x1];if(!F)i='âš ï¸\x20Ù„Ø·ÙØ§\x20Ù†Ø§Ù…\x20Ú©Ø§Ø±Ø¨Ø±ÛŒ\x20Ø±Ø§\x20ÙˆØ§Ø±Ø¯\x20Ú©Ù†ÛŒØ¯\x0aÙ…Ø«Ø§Ù„:\x20/find\x20alice';else{const {results:G}=await b['DB']['prepare']('SELECT\x20username,\x20uuid,\x20quota,\x20ROUND(CAST(used_traffic\x20AS\x20REAL)\x20/\x201073741824,\x202)\x20as\x20used,\x20status\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20users\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20username\x20LIKE\x20?\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x205')['bind']('%'+F+'%')['all']();G&&G['length']>0x0?(i='ğŸ”\x20<b>Ù†ØªØ§ÛŒØ¬\x20Ø¬Ø³ØªØ¬Ùˆ\x20Ø¨Ø±Ø§ÛŒ\x20\x22'+F+'\x22:</b>\x0a\x0a',G['forEach'](H=>{i+='ğŸ‘¤\x20<b>'+H['username']+'</b>\x0a',i+='\x20\x20UUID:\x20<code>'+H['uuid']['substring'](0x0,0x8)+'...</code>\x0a',i+='\x20\x20Ø­Ø¬Ù…:\x20'+H['used']+'/'+H['quota']+'\x20GB\x0a',i+='\x20\x20ÙˆØ¶Ø¹ÛŒØª:\x20'+H['status']+'\x0a\x0a';})):i='âŒ\x20Ú©Ø§Ø±Ø¨Ø±ÛŒ\x20Ø¨Ø§\x20Ù†Ø§Ù…\x20\x22'+F+'\x22\x20ÛŒØ§ÙØª\x20Ù†Ø´Ø¯';}}else{if(f['startsWith']('/reset')){const H=f['split']('\x20')[0x1];if(!H)i='âš ï¸\x20Ù„Ø·ÙØ§\x20UUID\x20Ø±Ø§\x20ÙˆØ§Ø±Ø¯\x20Ú©Ù†ÛŒØ¯\x0aÙ…Ø«Ø§Ù„:\x20/reset\x20abc-123-def';else{const I=await b['DB']['prepare']('UPDATE\x20users\x20SET\x20used_traffic\x20=\x200\x20WHERE\x20uuid\x20LIKE\x20?\x20RETURNING\x20username')['bind']('%'+H+'%')['first']();I?(i='âœ…\x20ØªØ±Ø§ÙÛŒÚ©\x20Ú©Ø§Ø±Ø¨Ø±\x20<b>'+I['username']+'</b>\x20Ø±ÛŒØ³Øª\x20Ø´Ø¯',await logSecurityEvent(b,'traffic_reset_telegram',null,null,'Reset\x20by\x20admin\x20via\x20Telegram:\x20'+I['username'])):i='âŒ\x20Ú©Ø§Ø±Ø¨Ø±ÛŒ\x20Ø¨Ø§\x20UUID\x20\x22'+H+'\x22\x20ÛŒØ§ÙØª\x20Ù†Ø´Ø¯';}}else{if(f['startsWith']('/delete')){const J=f['split']('\x20')[0x1];if(!J)i='âš ï¸\x20Ù„Ø·ÙØ§\x20UUID\x20Ø±Ø§\x20ÙˆØ§Ø±Ø¯\x20Ú©Ù†ÛŒØ¯\x0aÙ…Ø«Ø§Ù„:\x20/delete\x20abc-123-def';else{const K=await b['DB']['prepare']('SELECT\x20username\x20FROM\x20users\x20WHERE\x20uuid\x20LIKE\x20?')['bind']('%'+J+'%')['first']();K?(await b['DB']['prepare']('DELETE\x20FROM\x20users\x20WHERE\x20uuid\x20LIKE\x20?')['bind']('%'+J+'%')['run'](),i='ğŸ—‘ï¸\x20Ú©Ø§Ø±Ø¨Ø±\x20<b>'+K['username']+'</b>\x20Ø­Ø°Ù\x20Ø´Ø¯',await logSecurityEvent(b,'user_deleted_telegram',null,null,'Deleted\x20by\x20admin\x20via\x20Telegram:\x20'+K['username'])):i='âŒ\x20Ú©Ø§Ø±Ø¨Ø±ÛŒ\x20Ø¨Ø§\x20UUID\x20\x22'+J+'\x22\x20ÛŒØ§ÙØª\x20Ù†Ø´Ø¯';}}else{if(b['AI'])try{const L=await b['AI']['run']('@cf/meta/llama-2-7b-chat-int8',{'messages':[{'role':'system','content':'You\x20are\x20a\x20helpful\x20VPN\x20system\x20assistant.\x20Answer\x20concisely\x20in\x20Persian\x20(Farsi).\x20You\x20help\x20with\x20VPN\x20management,\x20user\x20questions,\x20and\x20system\x20monitoring.'},{'role':'user','content':f}],'max_tokens':0x100});i='ğŸ¤–\x20<b>Ù¾Ø§Ø³Ø®\x20AI:</b>\x0a\x0a'+(L['response']||'Ù…ØªØ§Ø³ÙØ§Ù†Ù‡\x20Ù†ØªÙˆØ§Ù†Ø³ØªÙ…\x20Ù¾Ø§Ø³Ø®\x20Ø¯Ù‡Ù…');}catch(M){i='âš ï¸\x20Ø¯Ø³ØªÙˆØ±\x20Ù†Ø§Ù…Ø¹ØªØ¨Ø±.\x20Ø§Ø²\x20/help\x20Ø¨Ø±Ø§ÛŒ\x20Ø¯ÛŒØ¯Ù†\x20Ù„ÛŒØ³Øª\x20Ø¯Ø³ØªÙˆØ±Ø§Øª\x20Ø§Ø³ØªÙØ§Ø¯Ù‡\x20Ú©Ù†ÛŒØ¯';}else i='âš ï¸\x20Ø¯Ø³ØªÙˆØ±\x20Ù†Ø§Ù…Ø¹ØªØ¨Ø±.\x20Ø§Ø²\x20/help\x20Ø¨Ø±Ø§ÛŒ\x20Ø¯ÛŒØ¯Ù†\x20Ù„ÛŒØ³Øª\x20Ø¯Ø³ØªÙˆØ±Ø§Øª\x20Ø§Ø³ØªÙØ§Ø¯Ù‡\x20Ú©Ù†ÛŒØ¯';}}}}}}}}}}}}return await sendTelegramMessage(e,i,b),jsonResponse({'ok':!![]});}catch(N){return console['error']('Telegram\x20webhook\x20error:',N),jsonResponse({'ok':!![]});}}function generateProgressBar(a){const b=Math['round'](a/0xa),c=0xa-b;return'â–ˆ'['repeat'](b)+'â–‘'['repeat'](c);}async function sendTelegramMessage(a,b,c){if(!c['TELEGRAM_BOT_TOKEN']){console['warn']('Telegram\x20bot\x20token\x20not\x20configured');return;}const d='https://api.telegram.org/bot'+c['TELEGRAM_BOT_TOKEN']+'/sendMessage';try{const e=await fetch(d,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'chat_id':a,'text':b,'parse_mode':'HTML','disable_web_page_preview':!![]})});if(!e['ok']){const f=await e['text']();console['error']('Telegram\x20API\x20error:',f);}}catch(g){console['error']('Telegram\x20send\x20error:',g);}}async function sendTelegramAlert(a,b){if(!a['TELEGRAM_BOT_TOKEN']||!a['ADMIN_TELEGRAM_ID'])return;await sendTelegramMessage(a['ADMIN_TELEGRAM_ID'],b,a);}async function handleSubscription(a,b){const c=new URL(a['url']),d=c['pathname']['split']('/')['pop']();try{const e=await b['DB']['prepare']('SELECT\x20u.*,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20JULIANDAY(u.expiry_date)\x20-\x20JULIANDAY(\x27now\x27)\x20as\x20days_remaining\x0a\x20\x20\x20\x20\x20\x20\x20FROM\x20users\x20u\x0a\x20\x20\x20\x20\x20\x20\x20WHERE\x20u.uuid\x20=\x20?\x20AND\x20u.status\x20=\x20\x27active\x27')['bind'](d)['first']();if(!e)return new Response('Subscription\x20not\x20found\x20or\x20expired',{'status':0x194,'headers':{'Content-Type':'text/plain'}});const f=b['DOMAIN']||a['headers']['get']('host'),g=[];QUANTUM_CONFIG['GHOST_PRINTS']['forEach']((m,n)=>{const o=QUANTUM_CONFIG['ANTI_FILTER_SNI'][n%QUANTUM_CONFIG['ANTI_FILTER_SNI']['length']];g['push']('vless://'+d+'@'+f+':443?'+('encryption=none&security=tls&sni='+o+'&fp='+m+'&alpn=h2,http/1.1&')+('type=ws&host='+f+'&path='+encodeURIComponent(QUANTUM_CONFIG['PATHS']['VLESS_WS']))+('#Quantum-WS-'+m));}),g['push']('vless://'+d+'@'+f+':443?'+('encryption=none&security=tls&sni='+QUANTUM_CONFIG['ANTI_FILTER_SNI'][0x0]+'&fp=chrome&alpn=h2&')+('type=grpc&serviceName='+QUANTUM_CONFIG['PATHS']['VLESS_GRPC']['substring'](0x1)+'&mode=multi')+'#Quantum-gRPC');QUANTUM_CONFIG['QUANTUM_FEATURES']['ENABLE_REALITY_MODE']&&g['push']('vless://'+d+'@'+f+':443?'+'encryption=none&flow=xtls-rprx-vision&security=reality&'+'sni=www.microsoft.com&fp=chrome&pbk=placeholder-public-key&'+'type=tcp&headerType=none'+'#Quantum-Reality');const h=g['join']('\x0a'),i=btoa(unescape(encodeURIComponent(h))),j=e['quota']*0x40000000,k=Math['floor'](new Date(e['expiry_date'])['getTime']()/0x3e8),l=e['used_traffic']||0x0;return await b['DB']['prepare']('UPDATE\x20users\x20SET\x20last_login\x20=\x20datetime(\x27now\x27),\x20last_ip\x20=\x20?\x20WHERE\x20id\x20=\x20?')['bind'](a['headers']['get']('CF-Connecting-IP'),e['id'])['run'](),new Response(i,{'headers':{'Content-Type':'text/plain;\x20charset=utf-8','Content-Disposition':'attachment;\x20filename=\x22quantum-'+e['username']+'-'+d['substring'](0x0,0x8)+'.txt\x22','Subscription-Userinfo':'upload=0;\x20download='+l+';\x20total='+j+';\x20expire='+k,'Profile-Update-Interval':'24','Profile-Title':'Quantum\x20Shield\x20-\x20'+e['username'],'Profile-Web-Page-Url':'https://'+f+QUANTUM_CONFIG['PATHS']['USER_PANEL']+'?uuid='+d,'Support-Url':'https://t.me/'+(b['TELEGRAM_SUPPORT_USERNAME']||'quantum_support'),'Cache-Control':'no-cache,\x20no-store,\x20must-revalidate',...getSecurityHeaders()}});}catch(m){return console['error']('Subscription\x20error:',m),new Response('Internal\x20error',{'status':0x1f4,'headers':{'Content-Type':'text/plain'}});}}function generateSubscriptionURL(a,b){return'https://'+b+QUANTUM_CONFIG['PATHS']['SUBSCRIPTION']+'/'+a;}function generateReferralCode(a){const b=a['split']('')['reduce']((c,d)=>{return(c<<0x5)-c+d['charCodeAt'](0x0);},0x0);return'QS'+Math['abs'](b)['toString'](0x24)['toUpperCase']()['substring'](0x0,0x8);}async function logSecurityEvent(a,b,c,d,e){try{const f=determineSeverity(b);await a['DB']['prepare']('INSERT\x20INTO\x20security_events\x20(event_type,\x20severity,\x20user_id,\x20ip_address,\x20details,\x20timestamp)\x20\x0a\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20datetime(\x27now\x27))')['bind'](b,f,c,d,e)['run'](),['high','critical']['includes'](f)&&await sendTelegramAlert(a,'ğŸš¨\x20<b>Ø±ÙˆÛŒØ¯Ø§Ø¯\x20Ø§Ù…Ù†ÛŒØªÛŒ\x20'+f+'</b>\x0a\x0a'+('Ù†ÙˆØ¹:\x20'+b+'\x0a')+('IP:\x20'+(d||'N/A')+'\x0a')+('Ø¬Ø²Ø¦ÛŒØ§Øª:\x20'+(e?.['substring'](0x0,0x64)||'N/A')));}catch(g){console['error']('Security\x20log\x20error:',g);}}function determineSeverity(a){const b={'unauthorized_vless':'high','invalid_vless_header':'medium','rate_limit_exceeded':'low','banned_access_attempt':'high','max_connections_exceeded':'medium','admin_login_failed':'high','admin_login_success':'info','account_locked':'high','user_created':'info','user_deleted':'medium','traffic_reset':'low','system_error':'critical','connection_failed':'medium'};return b[a]||'info';}async function performAutoBackup(a){try{const [b,c,d]=await Promise['all']([a['DB']['prepare']('SELECT\x20*\x20FROM\x20users\x20WHERE\x20status\x20=\x20\x27active\x27')['all'](),a['DB']['prepare']('SELECT\x20*\x20FROM\x20nodes\x20WHERE\x20is_active\x20=\x201')['all'](),a['DB']['prepare']('SELECT\x20*\x20FROM\x20system_settings')['all']()]),e={'timestamp':new Date()['toISOString'](),'version':QUANTUM_CONFIG['VERSION'],'userCount':b['results']?.['length']||0x0,'nodeCount':c['results']?.['length']||0x0,'users':b['results']||[],'nodes':c['results']||[],'settings':d['results']||[]},f='backup:'+Date['now']();await a['QUANTUM_KV']['put'](f,JSON['stringify'](e),{'expirationTtl':0x7*0x18*0xe10});const g='ğŸ’¾\x20<b>Ø¨Ú©â€ŒØ¢Ù¾\x20Ø®ÙˆØ¯Ú©Ø§Ø±\x20Ø§Ù†Ø¬Ø§Ù…\x20Ø´Ø¯</b>\x0a\x0a'+('ğŸ‘¥\x20Ú©Ø§Ø±Ø¨Ø±Ø§Ù†:\x20'+e['userCount']+'\x0a')+('ğŸŒ\x20Ù†ÙˆØ¯Ù‡Ø§:\x20'+e['nodeCount']+'\x0a')+('ğŸ“…\x20Ø²Ù…Ø§Ù†:\x20'+new Date()['toLocaleString']('fa-IR'));return await sendTelegramAlert(a,g),g;}catch(h){return console['error']('Backup\x20error:',h),'âŒ\x20Ø®Ø·Ø§\x20Ø¯Ø±\x20Ø¨Ú©â€ŒØ¢Ù¾:\x20'+h['message'];}}async function cleanExpiredUsers(a){try{const b=await a['DB']['prepare']('UPDATE\x20users\x20\x0a\x20\x20\x20\x20\x20\x20\x20SET\x20status\x20=\x20\x27expired\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20WHERE\x20expiry_date\x20<\x20date(\x27now\x27)\x20\x0a\x20\x20\x20\x20\x20\x20\x20AND\x20status\x20=\x20\x27active\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20RETURNING\x20username')['all']();if(b['results']&&b['results']['length']>0x0){const c=b['results']['map'](d=>d['username'])['join'](',\x20');await sendTelegramAlert(a,'â°\x20<b>Ú©Ø§Ø±Ø¨Ø±Ø§Ù†\x20Ù…Ù†Ù‚Ø¶ÛŒ\x20Ø´Ø¯Ù‡</b>\x0a\x0a'+('ØªØ¹Ø¯Ø§Ø¯:\x20'+b['results']['length']+'\x0a')+('Ú©Ø§Ø±Ø¨Ø±Ø§Ù†:\x20'+c));}}catch(d){console['error']('Cleanup\x20error:',d);}}async function rotateQuantumKeys(a){try{const b={'timestamp':Date['now'](),'padding':Math['floor'](Math['random']()*0x400),'fragmentSize':Math['floor'](Math['random']()*0x200)+0x200,'sniIndex':Math['floor'](Math['random']()*QUANTUM_CONFIG['ANTI_FILTER_SNI']['length'])};await a['QUANTUM_KV']['put']('quantum:rotation',JSON['stringify'](b),{'expirationTtl':0x15180});}catch(c){console['error']('Key\x20rotation\x20error:',c);}}async function checkSystemHealth(a){try{const {results:b}=await a['DB']['prepare']('SELECT\x20*\x20FROM\x20nodes\x20WHERE\x20is_active\x20=\x201')['all']();for(const c of b||[]){const d=Math['random']()>0.02,e=Math['floor'](Math['random']()*0x64)+0x14,f=d?'healthy':'degraded';await a['DB']['prepare']('UPDATE\x20nodes\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20SET\x20status\x20=\x20?,\x20latency\x20=\x20?,\x20last_check\x20=\x20datetime(\x27now\x27)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20=\x20?')['bind'](f,e,c['id'])['run'](),!d&&c['status']==='healthy'&&await sendTelegramAlert(a,'âš ï¸\x20<b>Ù†ÙˆØ¯\x20'+c['name']+'\x20Ø¯Ú†Ø§Ø±\x20Ù…Ø´Ú©Ù„\x20Ø´Ø¯</b>\x0a\x0a'+'ÙˆØ¶Ø¹ÛŒØª\x20Ù‚Ø¨Ù„ÛŒ:\x20healthy\x0a'+'ÙˆØ¶Ø¹ÛŒØª\x20ÙØ¹Ù„ÛŒ:\x20degraded');}}catch(g){console['error']('Health\x20check\x20error:',g);}}async function cleanOldLogs(a){try{const b=await a['DB']['prepare']('DELETE\x20FROM\x20traffic_logs\x20WHERE\x20timestamp\x20<\x20datetime(\x27now\x27,\x20\x27-30\x20days\x27)')['run']();b['meta']&&b['meta']['changes']>0x0&&console['log']('Cleaned\x20'+b['meta']['changes']+'\x20old\x20log\x20entries'),await a['DB']['prepare']('DELETE\x20FROM\x20security_events\x20WHERE\x20timestamp\x20<\x20datetime(\x27now\x27,\x20\x27-90\x20days\x27)')['run']();}catch(c){console['error']('Log\x20cleanup\x20error:',c);}}async function updateNodeStatistics(a){try{const b=await a['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20node_id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20as\x20connection_count,\x0a\x20\x20\x20\x20\x20\x20\x20\x20SUM(upload\x20+\x20download)\x20as\x20total_traffic\x0a\x20\x20\x20\x20\x20\x20FROM\x20traffic_logs\x0a\x20\x20\x20\x20\x20\x20WHERE\x20timestamp\x20>\x20datetime(\x27now\x27,\x20\x27-1\x20hour\x27)\x0a\x20\x20\x20\x20\x20\x20AND\x20node_id\x20IS\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20GROUP\x20BY\x20node_id\x0a\x20\x20\x20\x20')['all']();for(const c of b['results']||[]){await a['DB']['prepare']('UPDATE\x20nodes\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20SET\x20active_connections\x20=\x20?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20total_traffic\x20=\x20total_traffic\x20+\x20?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20load_percent\x20=\x20CAST((active_connections\x20*\x20100.0\x20/\x20max_users)\x20AS\x20INTEGER)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20=\x20?')['bind'](c['connection_count'],c['total_traffic'],c['node_id'])['run']();}}catch(d){console['error']('Node\x20statistics\x20error:',d);}}async function processFailedConnections(a){try{const b=await a['DB']['prepare']('\x0a\x20\x20\x20\x20\x20\x20SELECT\x20ip_address,\x20COUNT(*)\x20as\x20fail_count\x0a\x20\x20\x20\x20\x20\x20FROM\x20security_events\x0a\x20\x20\x20\x20\x20\x20WHERE\x20event_type\x20IN\x20(\x27unauthorized_vless\x27,\x20\x27invalid_vless_header\x27)\x0a\x20\x20\x20\x20\x20\x20AND\x20timestamp\x20>\x20datetime(\x27now\x27,\x20\x27-1\x20hour\x27)\x0a\x20\x20\x20\x20\x20\x20GROUP\x20BY\x20ip_address\x0a\x20\x20\x20\x20\x20\x20HAVING\x20fail_count\x20>=\x20?\x0a\x20\x20\x20\x20')['bind'](QUANTUM_CONFIG['SECURITY']['AUTO_BAN_THRESHOLD'])['all']();for(const c of b['results']||[]){await a['DB']['prepare']('INSERT\x20OR\x20IGNORE\x20INTO\x20banned_ips\x20(ip_address,\x20reason,\x20banned_until)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20datetime(\x27now\x27,\x20\x27+24\x20hours\x27))')['bind'](c['ip_address'],'Auto-banned:\x20'+c['fail_count']+'\x20failed\x20attempts\x20in\x201\x20hour')['run'](),await sendTelegramAlert(a,'ğŸš«\x20<b>IP\x20Ø®ÙˆØ¯Ú©Ø§Ø±\x20Ø¨Ù†\x20Ø´Ø¯</b>\x0a\x0a'+('IP:\x20'+c['ip_address']+'\x0a')+('ØªÙ„Ø§Ø´â€ŒÙ‡Ø§ÛŒ\x20Ù†Ø§Ù…ÙˆÙÙ‚:\x20'+c['fail_count']+'\x0a')+'Ù…Ø¯Øª:\x2024\x20Ø³Ø§Ø¹Øª');}}catch(d){console['error']('Failed\x20connections\x20processing\x20error:',d);}}function serveFakeWebsite(){const a='<!DOCTYPE\x20html>\x0a<html\x20lang=\x22en\x22>\x0a<head>\x0a\x20\x20<meta\x20charset=\x22UTF-8\x22>\x0a\x20\x20<meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22>\x0a\x20\x20<title>Enterprise\x20Cloud\x20Infrastructure</title>\x0a\x20\x20<meta\x20name=\x22description\x22\x20content=\x22Professional\x20cloud\x20computing\x20and\x20infrastructure\x20services\x22>\x0a\x20\x20<style>\x0a\x20\x20\x20\x20*\x20{\x20margin:\x200;\x20padding:\x200;\x20box-sizing:\x20border-box;\x20}\x0a\x20\x20\x20\x20body\x20{\x20\x0a\x20\x20\x20\x20\x20\x20font-family:\x20-apple-system,\x20BlinkMacSystemFont,\x20\x27Segoe\x20UI\x27,\x20Roboto,\x20Oxygen,\x20Ubuntu,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#667eea\x200%,\x20#764ba2\x20100%);\x0a\x20\x20\x20\x20\x20\x20min-height:\x20100vh;\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.container\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20padding:\x2060px\x2050px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2024px;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x2025px\x2080px\x20rgba(0,0,0,0.35);\x0a\x20\x20\x20\x20\x20\x20max-width:\x20650px;\x0a\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20animation:\x20slideUp\x200.6s\x20ease-out;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20@keyframes\x20slideUp\x20{\x0a\x20\x20\x20\x20\x20\x20from\x20{\x20opacity:\x200;\x20transform:\x20translateY(30px);\x20}\x0a\x20\x20\x20\x20\x20\x20to\x20{\x20opacity:\x201;\x20transform:\x20translateY(0);\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20h1\x20{\x20\x0a\x20\x20\x20\x20\x20\x20color:\x20#2d3748;\x20\x0a\x20\x20\x20\x20\x20\x20font-size:\x202.8rem;\x20\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2024px;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20800;\x0a\x20\x20\x20\x20\x20\x20letter-spacing:\x20-1px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20p\x20{\x20\x0a\x20\x20\x20\x20\x20\x20color:\x20#4a5568;\x20\x0a\x20\x20\x20\x20\x20\x20line-height:\x201.9;\x20\x0a\x20\x20\x20\x20\x20\x20font-size:\x201.15rem;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2016px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.badge\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20inline-block;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#667eea\x200%,\x20#764ba2\x20100%);\x0a\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20padding:\x2010px\x2026px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2050px;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.95rem;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20700;\x0a\x20\x20\x20\x20\x20\x20margin-top:\x2024px;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2015px\x20rgba(102,\x20126,\x20234,\x200.4);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.features\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20grid;\x0a\x20\x20\x20\x20\x20\x20grid-template-columns:\x20repeat(auto-fit,\x20minmax(150px,\x201fr));\x0a\x20\x20\x20\x20\x20\x20gap:\x2020px;\x0a\x20\x20\x20\x20\x20\x20margin-top:\x2040px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.feature\x20{\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20background:\x20#f7fafc;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.9rem;\x0a\x20\x20\x20\x20\x20\x20color:\x20#2d3748;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20}\x0a\x20\x20</style>\x0a</head>\x0a<body>\x0a\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20<h1>ğŸŒ\x20Cloud\x20Services</h1>\x0a\x20\x20\x20\x20<p>Professional\x20cloud\x20infrastructure\x20solutions\x20for\x20modern\x20enterprises\x20worldwide.</p>\x0a\x20\x20\x20\x20<p>Delivering\x20secure,\x20scalable,\x20and\x20reliable\x20computing\x20resources\x20with\x2099.9%\x20uptime\x20guarantee.</p>\x0a\x20\x20\x20\x20<div\x20class=\x22badge\x22>âœ“\x20Enterprise\x20Grade\x20Security</div>\x0a\x20\x20\x20\x20<div\x20class=\x22features\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22feature\x22>ğŸ”’\x20SSL/TLS\x20Encrypted</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22feature\x22>âš¡\x20High\x20Performance</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22feature\x22>ğŸŒ\x20Global\x20CDN</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22feature\x22>ğŸ“Š\x20Real-time\x20Analytics</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20</div>\x0a</body>\x0a</html>';return new Response(a,{'headers':{'Content-Type':'text/html;\x20charset=utf-8',...getSecurityHeaders()}});}function serveAdminPanel(){const a='<!DOCTYPE\x20html>\x0a<html\x20dir=\x22rtl\x22\x20lang=\x22fa\x22>\x0a<head>\x0a\x20\x20<meta\x20charset=\x22UTF-8\x22>\x0a\x20\x20<meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22>\x0a\x20\x20<title>Quantum\x20Shield\x20V6\x20-\x20Admin\x20Panel</title>\x0a\x20\x20<script\x20crossorigin\x20src=\x22https://unpkg.com/react@18/umd/react.production.min.js\x22></script>\x0a\x20\x20<script\x20crossorigin\x20src=\x22https://unpkg.com/react-dom@18/umd/react-dom.production.min.js\x22></script>\x0a\x20\x20<script\x20src=\x22https://cdn.tailwindcss.com\x22></script>\x0a\x20\x20<style>\x0a\x20\x20\x20\x20body\x20{\x20font-family:\x20\x27Segoe\x20UI\x27,\x20Tahoma,\x20Geneva,\x20Verdana,\x20sans-serif;\x20}\x0a\x20\x20\x20\x20@keyframes\x20slideIn\x20{\x0a\x20\x20\x20\x20\x20\x20from\x20{\x20transform:\x20translateX(100%);\x20opacity:\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20to\x20{\x20transform:\x20translateX(0);\x20opacity:\x201;\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20</style>\x0a</head>\x0a<body\x20class=\x22bg-gray-950\x22>\x0a\x20\x20<div\x20id=\x22root\x22></div>\x0a\x20\x20<script>\x0a\x20\x20\x20\x20//\x20Ú©Ø¯\x20React\x20Ø§Ø²\x20ÙØ§ÛŒÙ„\x20Ù‚Ø¨Ù„ÛŒ\x20Ø´Ù…Ø§\x20Ø±Ø§\x20Ø§ÛŒÙ†Ø¬Ø§\x20Ù‚Ø±Ø§Ø±\x20Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ…\x0a\x20\x20\x20\x20//\x20Ø¨Ù‡\x20Ø¯Ù„ÛŒÙ„\x20Ù…Ø­Ø¯ÙˆØ¯ÛŒØª\x20Ø·ÙˆÙ„ØŒ\x20Ù…Ù†\x20ÙÙ‚Ø·\x20Ø³Ø§Ø®ØªØ§Ø±\x20Ú©Ù„ÛŒ\x20Ø±Ø§\x20Ù†Ø´Ø§Ù†\x20Ù…ÛŒâ€ŒØ¯Ù‡Ù…\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20const\x20{\x20useState,\x20useEffect\x20}\x20=\x20React;\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20//\x20...\x20(Ø¨Ø§Ù‚ÛŒ\x20Ú©Ø¯\x20React\x20Panel\x20Ø§Ø²\x20ÙØ§ÛŒÙ„\x20Ù‚Ø¨Ù„ÛŒ)\x0a\x20\x20</script>\x0a</body>\x0a</html>';return new Response(a,{'headers':{'Content-Type':'text/html;\x20charset=utf-8',...getSecurityHeaders()}});}function serveUserPanel(){const a='<!DOCTYPE\x20html>\x0a<html\x20lang=\x22fa\x22\x20dir=\x22rtl\x22>\x0a<head>\x0a\x20\x20<meta\x20charset=\x22UTF-8\x22>\x0a\x20\x20<meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22>\x0a\x20\x20<title>Quantum\x20User\x20Panel</title>\x0a\x20\x20<script\x20crossorigin\x20src=\x22https://unpkg.com/react@18/umd/react.production.min.js\x22></script>\x0a\x20\x20<script\x20crossorigin\x20src=\x22https://unpkg.com/react-dom@18/umd/react-dom.production.min.js\x22></script>\x0a\x20\x20<script\x20src=\x22https://cdn.tailwindcss.com\x22></script>\x0a</head>\x0a<body>\x0a\x20\x20<div\x20id=\x22root\x22></div>\x0a\x20\x20<script>\x0a\x20\x20\x20\x20//\x20Ú©Ø¯\x20Ù¾Ù†Ù„\x20Ú©Ø§Ø±Ø¨Ø±ÛŒ\x20React\x20Ø§Ø²\x20ÙØ§ÛŒÙ„\x20Ø³ÙˆÙ…\x20Ø´Ù…Ø§\x0a\x20\x20</script>\x0a</body>\x0a</html>';return new Response(a,{'headers':{'Content-Type':'text/html;\x20charset=utf-8',...getSecurityHeaders()}});}function getSecurityHeaders(){return{'X-Content-Type-Options':'nosniff','X-Frame-Options':'DENY','X-XSS-Protection':'1;\x20mode=block','Referrer-Policy':'strict-origin-when-cross-origin','Permissions-Policy':'geolocation=(),\x20microphone=(),\x20camera=(),\x20payment=()','Strict-Transport-Security':'max-age=31536000;\x20includeSubDomains;\x20preload','Content-Security-Policy':'default-src\x20\x27self\x27;\x20script-src\x20\x27self\x27\x20\x27unsafe-inline\x27\x20https://unpkg.com\x20https://cdn.tailwindcss.com;\x20style-src\x20\x27self\x27\x20\x27unsafe-inline\x27;\x20img-src\x20\x27self\x27\x20data:\x20https:;\x20connect-src\x20\x27self\x27;'};}function getCORSHeaders(){return{'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','Access-Control-Allow-Headers':'Content-Type,\x20Authorization,\x20X-Requested-With','Access-Control-Max-Age':'86400','Access-Control-Allow-Credentials':'true'};}function jsonResponse(a,b=0xc8){return new Response(JSON['stringify'](a,null,0x2),{'status':b,'headers':{'Content-Type':'application/json;\x20charset=utf-8',...getSecurityHeaders(),...getCORSHeaders()}});}