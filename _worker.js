// <!--GAMFC-->version base on commit: a26df1a4374394d5738d0854ae0c38bf95a64d67 - last update: 2025-12-25 18:42:32 UTC <!--GAMFC-END-->.

import{connect}from'cloudflare:sockets';const CONFIG={'VERSION':'8.0.0-ULTIMATE','BUILD_DATE':'2025-12-25','PATHS':{'ADMIN':'/quantum-admin-v8','API':'/api/v3','VLESS_WS':'/vless-quantum','SUBSCRIPTION':'/sub','HEALTH':'/health','METRICS':'/metrics'},'SECURITY':{'MAX_CONNECTIONS':0xf,'RATE_LIMIT':0x12c,'SESSION_TIMEOUT':0x18,'MAX_LOGIN_ATTEMPTS':0x5,'SCAMALYTICS_THRESHOLD':0x32},'QUANTUM':{'FRAGMENTATION':!![],'PADDING':!![],'TIMING_OBFUSCATION':!![],'TLS_RANDOMIZATION':!![],'MULTI_PATH':!![],'ENCRYPTION':!![],'NOISE_INJECTION':!![],'FAST_PATH':!![],'MIN_FRAGMENT':0x80,'MAX_FRAGMENT':0x578,'PADDING_PROB':0.6,'MAX_PADDING':0x200,'JITTER_MS':0x32,'NOISE_RATIO':0.15},'PERF':{'TIMEOUT':0x2ee0,'IDLE':0x493e0,'BUFFER':0x10000,'RETRIES':0x5,'RETRY_BASE':0x1f4,'RETRY_MAX':0x1388},'TRAFFIC':{'FLUSH_MS':0xea60,'MAX_BUFFER':0x32,'MAX_MB':0xa},'SNI':['www.speedtest.net','cloudflare.com','workers.dev','cdnjs.cloudflare.com'],'PROXY':['bpb.yousef.isegaro.com','cdn.xn--b6gac.eu.org']},MAX_MAP=0x2710,RATE_MAP=new Map(),CACHE_MAP=new Map(),TRAFFIC_MAP=new Map(),KEY_MAP=new Map();let flushTime=Date['now'](),startTime=Date['now'](),dbReady=![];const proc={'uptime':()=>(Date['now']()-startTime)/0x3e8};export default{async 'fetch'(a,b,c){try{if(!dbReady)c['waitUntil'](initSys(b));const d=new URL(a['url']),e=getIP(a);if(a['method']==='OPTIONS')return new Response(null,{'status':0xcc,'headers':cors()});if(d['pathname']==='/'||d['pathname']===''){const i=b['ROOT_PROXY_URL']||'https://www.wikipedia.org';try{const j=await fetch(i,{'method':a['method'],'headers':{'User-Agent':a['headers']['get']('User-Agent')||'Mozilla/5.0','Accept':a['headers']['get']('Accept')||'*/*','Accept-Language':a['headers']['get']('Accept-Language')||'en-US,en;q=0.9'}}),k=new Headers(j['headers']);return k['set']('X-Proxied-By','Cloudflare-Worker'),k['delete']('Content-Security-Policy'),new Response(j['body'],{'status':j['status'],'statusText':j['statusText'],'headers':k});}catch(l){return console['error']('Proxy\x20error:',l),fake();}}if(d['pathname']===CONFIG['PATHS']['HEALTH'])return health(b);if(d['pathname']===CONFIG['PATHS']['METRICS'])return metrics(b);const f=checkRate(e);if(!f['ok'])return json({'error':'Rate\x20limit\x20exceeded','retryAfter':f['retry'],'message':'Please\x20wait\x20before\x20making\x20more\x20requests'},0x1ad);if(await isBanned(e,b))return console['warn']('Banned\x20IP\x20attempted\x20access:\x20'+e),fake();if(b['SCAMALYTICS_API_KEY']){const m=await checkIPReputation(e,b);m&&m['score']>(b['SCAMALYTICS_THRESHOLD']||CONFIG['SECURITY']['SCAMALYTICS_THRESHOLD'])&&(console['warn']('Suspicious\x20IP\x20detected:\x20'+e+'\x20(score:\x20'+m['score']+')'),await log(b,'suspicious_ip',null,e,'Score:\x20'+m['score']));}const g=a['headers']['get']('Upgrade');if(g==='websocket'&&d['pathname']===CONFIG['PATHS']['VLESS_WS'])return await vless(a,b,c,e);if(d['pathname']['startsWith'](CONFIG['PATHS']['API']))return await api(a,b,e);if(d['pathname']==='/admin-login'&&a['method']==='POST')return await login(a,b,e);const h=b['ADMIN_PATH_PREFIX']?''+b['ADMIN_PATH_PREFIX']+CONFIG['PATHS']['ADMIN']:CONFIG['PATHS']['ADMIN'];if(d['pathname']===h)return adminUI(b);if(d['pathname']['startsWith'](CONFIG['PATHS']['SUBSCRIPTION']+'/'))return await sub(a,b);return fake();}catch(n){return console['error']('Worker\x20error:',n),c['waitUntil'](logErr(b,n,'fetch')),json({'error':'Service\x20temporarily\x20unavailable','message':'Please\x20try\x20again\x20later'},0x1f7);}},async 'scheduled'(a,b,c){console['log']('üîÑ\x20Scheduled\x20maintenance\x20tasks\x20running...'),c['waitUntil'](Promise['allSettled']([flushTraffic(b),cleanExpired(b),rotateKeys(),cleanMem(),cleanLogs(b)]));}};async function initSys(a){if(dbReady)return;try{console['log']('üöÄ\x20Initializing\x20Quantum\x20Shield\x20System...'),await initDB(a),await initKeys(),dbReady=!![],console['log']('‚úÖ\x20System\x20fully\x20initialized\x20and\x20ready');}catch(b){console['error']('‚ùå\x20System\x20initialization\x20failed:',b);}}async function initDB(a){if(!a['QUANTUM_DB']){console['warn']('‚ö†Ô∏è\x20\x20Database\x20not\x20configured\x20-\x20running\x20in\x20fallback\x20mode');return;}try{const b=['CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20users\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT\x20UNIQUE\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20username\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20traffic_limit_gb\x20REAL\x20DEFAULT\x2050,\x0a\x20\x20\x20\x20\x20\x20\x20\x20traffic_used_gb\x20REAL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20expiry_date\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20status\x20TEXT\x20DEFAULT\x20\x27active\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TEXT\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20last_login\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20CONSTRAINT\x20valid_status\x20CHECK\x20(status\x20IN\x20(\x27active\x27,\x20\x27expired\x27,\x20\x27suspended\x27,\x20\x27banned\x27))\x0a\x20\x20\x20\x20\x20\x20)','CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20logs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20type\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_id\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20ip_address\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20message\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TEXT\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(user_id)\x20REFERENCES\x20users(id)\x20ON\x20DELETE\x20SET\x20NULL\x0a\x20\x20\x20\x20\x20\x20)','CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20banned_ips\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20ip\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20\x20\x20reason\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20banned_until\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TEXT\x20DEFAULT\x20CURRENT_TIMESTAMP\x0a\x20\x20\x20\x20\x20\x20)','CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20sessions\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20token\x20TEXT\x20UNIQUE\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20ip_address\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20expires_at\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TEXT\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(user_id)\x20REFERENCES\x20users(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20\x20\x20)'];for(const d of b){await a['QUANTUM_DB']['prepare'](d)['run']();}const c=['CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_users_uuid\x20ON\x20users(uuid)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_users_status\x20ON\x20users(status)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_sessions_token\x20ON\x20sessions(token)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_sessions_expires\x20ON\x20sessions(expires_at)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_logs_type\x20ON\x20logs(type)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_logs_created\x20ON\x20logs(created_at)','CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_banned_ips_until\x20ON\x20banned_ips(banned_until)'];for(const e of c){await a['QUANTUM_DB']['prepare'](e)['run']();}console['log']('‚úÖ\x20Database\x20schema\x20initialized\x20successfully');}catch(f){console['error']('‚ùå\x20Database\x20initialization\x20error:',f);throw f;}}async function initKeys(){try{for(let a=0x0;a<0xa;a++){KEY_MAP['set']('key_'+a,{'val':token(0x20),'time':Date['now'](),'uses':0x0});}console['log']('‚úÖ\x20Quantum\x20encryption\x20keys\x20generated');}catch(b){console['error']('‚ùå\x20Key\x20generation\x20error:',b);}}async function vless(a,b,c,d){try{const e=new WebSocketPair(),[f,g]=Object['values'](e);g['accept']();let h=new Uint8Array(0x0),i=null,j=null,k=null,l=![];return g['addEventListener']('message',async m=>{try{const n=new Uint8Array(await m['data']['arrayBuffer']());if(!l){h=concat(h,n);if(h['length']<0x17)return;const o=h[0x0];if(o!==0x0){console['error']('‚ùå\x20Invalid\x20VLESS\x20protocol\x20version'),closeAll(g,i);return;}const p=toUUID(h['slice'](0x1,0x11));k=await getUser(p,b);if(!k||k['status']!=='active'){console['error']('‚ùå\x20Invalid\x20user\x20or\x20inactive\x20account'),closeAll(g,i);return;}c['waitUntil'](updateLogin(k['id'],b));let q=0x12;const r=h[q++],s=h[q]<<0x8|h[q+0x1];q+=0x2;const t=h[q++];let u='';if(t===0x1)u=Array['from'](h['slice'](q,q+0x4))['join']('.'),q+=0x4;else{if(t===0x2){const y=h[q++];u=new TextDecoder()['decode'](h['slice'](q,q+y)),q+=y;}else{if(t===0x3){const z=h['slice'](q,q+0x10);u=Array['from'](z,A=>A['toString'](0x10)['padStart'](0x2,'0'))['reduce']((A,B,C)=>A+(C%0x2===0x0?C>0x0?':':'':'')+B,''),q+=0x10;}else{console['error']('‚ùå\x20Unsupported\x20address\x20type'),closeAll(g,i);return;}}}console['log']('üîó\x20Establishing\x20connection\x20to\x20'+u+':'+s);let v=u,w=s;if(b['PROXYIP']){const A=b['PROXYIP']['split'](',')['map'](C=>C['trim']()),B=A[Math['floor'](Math['random']()*A['length'])];B&&console['log']('üîÄ\x20Using\x20proxy:\x20'+B);}i=await connRetry(v,w);if(!i){console['error']('‚ùå\x20Failed\x20to\x20establish\x20remote\x20connection'),closeAll(g,i);return;}j=i['writable']['getWriter']();const x=new Uint8Array([o,0x0]);g['send'](x);if(h['length']>q){const C=h['slice'](q),D=await procOut(C);await safeWrite(j,D);}l=!![],pipe(i,g,k,b,c);}else{if(j){const E=await procOut(n);await safeWrite(j,E);}}if(k)c['waitUntil'](track(k['id'],n['length'],b));}catch(F){console['error']('‚ùå\x20Message\x20handling\x20error:',F),closeAll(g,i);}}),g['addEventListener']('close',()=>{console['log']('üîå\x20Client\x20connection\x20closed'),closeAll(null,i);}),g['addEventListener']('error',m=>{console['error']('‚ùå\x20WebSocket\x20error:',m),closeAll(g,i);}),new Response(null,{'status':0x65,'webSocket':f});}catch(m){return console['error']('‚ùå\x20VLESS\x20handler\x20error:',m),json({'error':'Connection\x20failed','message':'Unable\x20to\x20establish\x20secure\x20tunnel'},0x1f4);}}async function pipe(a,b,c,d,e){try{const f=a['readable']['getReader']();while(!![]){const {done:g,value:h}=await f['read']();if(g)break;const i=await procIn(h);if(b['readyState']===WebSocket['OPEN'])b['send'](i);else break;if(c)e['waitUntil'](track(c['id'],h['length'],d));}}catch(j){console['error']('‚ùå\x20Pipe\x20error:',j);}finally{closeAll(b,a);}}async function safeWrite(a,b){try{await a['write'](b);}catch(c){console['error']('‚ùå\x20Write\x20error:',c);throw c;}}function closeAll(a,b){try{a&&a['readyState']===WebSocket['OPEN']&&a['close']();}catch(c){}try{b&&b['close']();}catch(d){}}async function connRetry(a,b){for(let c=0x0;c<CONFIG['PERF']['RETRIES'];c++){try{const d=pickSNI(),e=connect({'hostname':a,'port':b},{'secureTransport':'on','allowHalfOpen':!![]});return console['log']('‚úÖ\x20Connected\x20successfully\x20(attempt\x20'+(c+0x1)+'/'+CONFIG['PERF']['RETRIES']+')'),e;}catch(f){console['error']('‚ùå\x20Connection\x20attempt\x20'+(c+0x1)+'\x20failed:',f['message']);if(c<CONFIG['PERF']['RETRIES']-0x1){const g=Math['min'](CONFIG['PERF']['RETRY_BASE']*Math['pow'](0x2,c),CONFIG['PERF']['RETRY_MAX']);console['log']('‚è≥\x20Retrying\x20in\x20'+g+'ms...'),await sleep(g);}}}return console['error']('‚ùå\x20All\x20connection\x20attempts\x20failed'),null;}async function procOut(a){try{let b=a;if(a['length']<0x64&&CONFIG['QUANTUM']['FAST_PATH'])return a;return CONFIG['QUANTUM']['ENCRYPTION']&&(b=xor(b)),CONFIG['QUANTUM']['FRAGMENTATION']&&a['length']>CONFIG['QUANTUM']['MIN_FRAGMENT']&&(b=await frag(b)),CONFIG['QUANTUM']['PADDING']&&Math['random']()<CONFIG['QUANTUM']['PADDING_PROB']&&(b=pad(b)),CONFIG['QUANTUM']['TIMING_OBFUSCATION']&&await delay(),b;}catch(c){return console['error']('‚ùå\x20Output\x20processing\x20error:',c),a;}}async function procIn(a){try{let b=a;return CONFIG['QUANTUM']['PADDING']&&(b=unpad(b)),CONFIG['QUANTUM']['ENCRYPTION']&&(b=xor(b)),b;}catch(c){return console['error']('‚ùå\x20Input\x20processing\x20error:',c),a;}}async function frag(a){try{if(a['length']<=CONFIG['QUANTUM']['MIN_FRAGMENT'])return a;const b=[],c=CONFIG['QUANTUM']['MIN_FRAGMENT'],d=CONFIG['QUANTUM']['MAX_FRAGMENT'];let e=0x0;while(e<a['length']){const f=Math['min'](Math['floor'](Math['random']()*(d-c+0x1))+c,a['length']-e);b['push'](a['slice'](e,e+f)),e+=f;if(e<a['length'])await delay();}return concat(...b);}catch(g){return console['error']('‚ùå\x20Fragmentation\x20error:',g),a;}}function xor(a){try{const b=Math['floor'](Math['random']()*KEY_MAP['size']),c=KEY_MAP['get']('key_'+b);if(!c)return a;const d=new TextEncoder()['encode'](c['val']),e=new Uint8Array(a['length']);for(let f=0x0;f<a['length'];f++){e[f]=a[f]^d[f%d['length']];}return c['uses']++,e;}catch(g){return console['error']('‚ùå\x20XOR\x20encryption\x20error:',g),a;}}function pad(a){try{const b=Math['floor'](Math['random']()*CONFIG['QUANTUM']['MAX_PADDING']);if(b===0x0)return a;const c=new Uint8Array(b);crypto['getRandomValues'](c);const d=new Uint8Array(a['length']+b+0x2);return d[0x0]=b>>0x8&0xff,d[0x1]=b&0xff,d['set'](a,0x2),d['set'](c,a['length']+0x2),d;}catch(e){return console['error']('‚ùå\x20Padding\x20error:',e),a;}}function unpad(a){try{if(a['length']<0x2)return a;const b=a[0x0]<<0x8|a[0x1];if(b===0x0||b>a['length']-0x2)return a;return a['slice'](0x2,a['length']-b);}catch(c){return console['error']('‚ùå\x20Unpadding\x20error:',c),a;}}async function track(a,b,c){try{const d=TRAFFIC_MAP['get'](a)||0x0;TRAFFIC_MAP['set'](a,d+b);const e=Date['now'](),f=e-flushTime,g=Array['from'](TRAFFIC_MAP['values']())['reduce']((i,j)=>i+j,0x0)/(0x400*0x400),h=f>CONFIG['TRAFFIC']['FLUSH_MS']||TRAFFIC_MAP['size']>=CONFIG['TRAFFIC']['MAX_BUFFER']||g>=CONFIG['TRAFFIC']['MAX_MB'];h&&await flushTraffic(c);}catch(i){console['error']('‚ùå\x20Traffic\x20tracking\x20error:',i);}}async function flushTraffic(a){if(TRAFFIC_MAP['size']===0x0)return;try{if(!a['QUANTUM_DB'])return;const b=[];for(const [c,d]of TRAFFIC_MAP['entries']()){const e=d/(0x400*0x400*0x400);b['push'](a['QUANTUM_DB']['prepare']('UPDATE\x20users\x20SET\x20traffic_used_gb\x20=\x20traffic_used_gb\x20+\x20?\x20WHERE\x20id\x20=\x20?')['bind'](e,c));}await a['QUANTUM_DB']['batch'](b),console['log']('‚úÖ\x20Traffic\x20flushed\x20for\x20'+TRAFFIC_MAP['size']+'\x20users'),TRAFFIC_MAP['clear'](),flushTime=Date['now']();}catch(f){console['error']('‚ùå\x20Traffic\x20flush\x20error:',f);}}function checkRate(a){const b=Date['now'](),c=0xea60;if(!RATE_MAP['has'](a))return RATE_MAP['set'](a,{'cnt':0x1,'reset':b+c}),{'ok':!![]};const d=RATE_MAP['get'](a);if(b>d['reset'])return d['cnt']=0x1,d['reset']=b+c,{'ok':!![]};d['cnt']++;if(d['cnt']>CONFIG['SECURITY']['RATE_LIMIT'])return{'ok':![],'retry':Math['ceil']((d['reset']-b)/0x3e8)};return{'ok':!![]};}async function checkIPReputation(a,b){try{if(!b['SCAMALYTICS_API_KEY'])return null;const c='reputation_'+a;if(CACHE_MAP['has'](c)){const f=CACHE_MAP['get'](c);if(Date['now']()-f['time']<0x36ee80)return f['val'];}const d=await fetch('https://scamalytics.com/api/check?ip='+a+'&key='+b['SCAMALYTICS_API_KEY'],{'method':'GET','headers':{'Accept':'application/json'}});if(!d['ok'])return null;const e=await d['json']();return CACHE_MAP['set'](c,{'val':e,'time':Date['now']()}),e;}catch(g){return console['error']('‚ùå\x20IP\x20reputation\x20check\x20error:',g),null;}}async function getUser(a,b){try{const c='user_'+a;if(CACHE_MAP['has'](c)){const d=CACHE_MAP['get'](c);if(Date['now']()-d['time']<0xea60)return d['val'];}if(b['QUANTUM_DB']){const e=await b['QUANTUM_DB']['prepare']('SELECT\x20*\x20FROM\x20users\x20WHERE\x20uuid\x20=\x20?\x20LIMIT\x201')['bind'](a)['first']();return e&&CACHE_MAP['set'](c,{'val':e,'time':Date['now']()}),e;}return{'id':0x1,'uuid':a,'status':'active','traffic_limit_gb':0x64,'traffic_used_gb':0x0};}catch(f){return console['error']('‚ùå\x20Get\x20user\x20error:',f),null;}}async function updateLogin(a,b){try{if(!b['QUANTUM_DB'])return;await b['QUANTUM_DB']['prepare']('UPDATE\x20users\x20SET\x20last_login\x20=\x20datetime(\x22now\x22)\x20WHERE\x20id\x20=\x20?')['bind'](a)['run']();}catch(c){console['error']('‚ùå\x20Update\x20login\x20error:',c);}}async function isBanned(a,b){try{const c='ban_'+a;if(CACHE_MAP['has'](c)){const d=CACHE_MAP['get'](c);if(Date['now']()-d['time']<0x493e0)return d['val'];}if(b['QUANTUM_DB']){const e=await b['QUANTUM_DB']['prepare']('SELECT\x201\x20FROM\x20banned_ips\x20WHERE\x20ip\x20=\x20?\x20AND\x20(banned_until\x20IS\x20NULL\x20OR\x20banned_until\x20>\x20datetime(\x22now\x22))')['bind'](a)['first'](),f=!!e;return CACHE_MAP['set'](c,{'val':f,'time':Date['now']()}),f;}return![];}catch(g){return console['error']('‚ùå\x20Check\x20ban\x20error:',g),![];}}async function login(a,b,c){try{const d=await a['json'](),{username:e,password:f,totp:g}=d;if(!e||!f)return json({'error':'Missing\x20credentials'},0x190);const h=b['ADMIN_USERNAME']||'admin',i=b['ADMIN_PASSWORD']||'quantum-2025';if(e!==h||f!==i)return await log(b,'failed_login',null,c,'Invalid\x20credentials'),json({'error':'Invalid\x20credentials'},0x191);if(b['ADMIN_TOTP_SECRET']&&g){const l=await verifyTOTP(g,b['ADMIN_TOTP_SECRET']);if(!l)return await log(b,'failed_totp',null,c,'Invalid\x20TOTP\x20code'),json({'error':'Invalid\x20two-factor\x20authentication\x20code'},0x191);}else{if(b['ADMIN_TOTP_SECRET']&&!g)return json({'error':'Two-factor\x20authentication\x20code\x20required'},0x191);}const j=token(0x20),k=new Date(Date['now']()+CONFIG['SECURITY']['SESSION_TIMEOUT']*0x36ee80);return b['QUANTUM_DB']&&await b['QUANTUM_DB']['prepare']('INSERT\x20INTO\x20sessions\x20(user_id,\x20token,\x20ip_address,\x20expires_at)\x20VALUES\x20(?,\x20?,\x20?,\x20?)')['bind'](0x0,j,c,k['toISOString']())['run'](),CACHE_MAP['set']('sess_'+j,{'val':{'user_id':0x0,'token':j,'ip_address':c},'time':Date['now']()}),await log(b,'successful_login',null,c,'Admin\x20logged\x20in'),json({'success':!![],'token':j,'expiresAt':k['toISOString'](),'requiresTOTP':!!b['ADMIN_TOTP_SECRET']});}catch(m){return console['error']('‚ùå\x20Login\x20error:',m),json({'error':'Login\x20failed'},0x1f4);}}async function verifyTOTP(a,b){try{const c=0x1,d=0x1e,e=Math['floor'](Date['now']()/0x3e8);for(let f=-c;f<=c;f++){const g=Math['floor']((e+f*d)/d),h=await generateTOTP(b,g);if(h===a)return!![];}return![];}catch(j){return console['error']('‚ùå\x20TOTP\x20verification\x20error:',j),![];}}async function generateTOTP(a,b){try{const c=new TextEncoder()['encode'](a),d=new ArrayBuffer(0x8),e=new DataView(d);e['setBigUint64'](0x0,BigInt(b),![]);const f=await crypto['subtle']['importKey']('raw',c,{'name':'HMAC','hash':'SHA-1'},![],['sign']),g=await crypto['subtle']['sign']('HMAC',f,d),h=new Uint8Array(g),i=h[h['length']-0x1]&0xf,j=(h[i]&0x7f)<<0x18|(h[i+0x1]&0xff)<<0x10|(h[i+0x2]&0xff)<<0x8|h[i+0x3]&0xff,k=j%0xf4240;return k['toString']()['padStart'](0x6,'0');}catch(l){return console['error']('‚ùå\x20TOTP\x20generation\x20error:',l),'000000';}}async function api(a,b,c){try{const d=new URL(a['url']),e=d['pathname']['replace'](CONFIG['PATHS']['API'],''),f=a['headers']['get']('Authorization');if(!f||!f['startsWith']('Bearer\x20'))return json({'error':'Unauthorized'},0x191);const g=f['substring'](0x7),h=await verifySess(g,b);if(!h)return json({'error':'Invalid\x20or\x20expired\x20token'},0x191);if(e==='/users'&&a['method']==='GET')return await listUsers(b);if(e==='/users'&&a['method']==='POST')return await addUser(a,b);if(e['startsWith']('/users/')&&a['method']==='GET'){const i=e['split']('/')[0x2];return await showUser(i,b);}if(e['startsWith']('/users/')&&a['method']==='PUT'){const j=e['split']('/')[0x2];return await editUser(j,a,b);}if(e['startsWith']('/users/')&&a['method']==='DELETE'){const k=e['split']('/')[0x2];return await delUser(k,b);}if(e==='/stats'&&a['method']==='GET')return await stats(b);return json({'error':'Endpoint\x20not\x20found'},0x194);}catch(l){return console['error']('‚ùå\x20API\x20error:',l),json({'error':'Internal\x20server\x20error'},0x1f4);}}async function verifySess(a,b){try{const c='sess_'+a;if(CACHE_MAP['has'](c)){const d=CACHE_MAP['get'](c);if(Date['now']()-d['time']<0x493e0)return d['val'];}if(b['QUANTUM_DB']){const e=await b['QUANTUM_DB']['prepare']('SELECT\x20*\x20FROM\x20sessions\x20WHERE\x20token\x20=\x20?\x20AND\x20expires_at\x20>\x20datetime(\x22now\x22)\x20LIMIT\x201')['bind'](a)['first']();return e&&CACHE_MAP['set'](c,{'val':e,'time':Date['now']()}),e;}return null;}catch(f){return console['error']('‚ùå\x20Session\x20verification\x20error:',f),null;}}async function listUsers(a){try{if(!a['QUANTUM_DB'])return json({'error':'Database\x20not\x20configured'},0x1f7);const b=await a['QUANTUM_DB']['prepare']('SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20id,\x20uuid,\x20username,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20traffic_limit_gb,\x20traffic_used_gb,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20expiry_date,\x20status,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at,\x20last_login\x20\x0a\x20\x20\x20\x20\x20\x20FROM\x20users\x20\x0a\x20\x20\x20\x20\x20\x20ORDER\x20BY\x20created_at\x20DESC')['all']();return json({'users':b['results']||[],'total':b['results']?.['length']||0x0});}catch(c){return console['error']('‚ùå\x20List\x20users\x20error:',c),json({'error':'Failed\x20to\x20retrieve\x20users'},0x1f4);}}async function addUser(a,b){try{if(!b['QUANTUM_DB'])return json({'error':'Database\x20not\x20configured'},0x1f7);const c=await a['json']();if(!c['username']||c['username']['trim']()==='')return json({'error':'Username\x20is\x20required'},0x190);const d=genUUID(),e=c['expiry_date']||new Date(Date['now']()+0x1e*0x5265c00)['toISOString'](),f=c['traffic_limit_gb']||0x32;return await b['QUANTUM_DB']['prepare']('INSERT\x20INTO\x20users\x20(uuid,\x20username,\x20traffic_limit_gb,\x20expiry_date,\x20status)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)')['bind'](d,c['username']['trim'](),f,e,'active')['run'](),await log(b,'user_created',null,null,'User\x20'+c['username']+'\x20created\x20with\x20UUID\x20'+d),json({'success':!![],'user':{'uuid':d,'username':c['username'],'traffic_limit_gb':f,'expiry_date':e,'status':'active'}},0xc9);}catch(g){return console['error']('‚ùå\x20Add\x20user\x20error:',g),json({'error':'Failed\x20to\x20create\x20user'},0x1f4);}}async function showUser(a,b){try{if(!validUUID(a))return json({'error':'Invalid\x20UUID\x20format'},0x190);const c=await getUser(a,b);if(!c)return json({'error':'User\x20not\x20found'},0x194);return json({'user':c});}catch(d){return console['error']('‚ùå\x20Show\x20user\x20error:',d),json({'error':'Failed\x20to\x20retrieve\x20user'},0x1f4);}}async function editUser(a,b,c){try{if(!c['QUANTUM_DB'])return json({'error':'Database\x20not\x20configured'},0x1f7);if(!validUUID(a))return json({'error':'Invalid\x20UUID\x20format'},0x190);const d=await b['json'](),e=[],f=[];if(d['username']!==undefined){if(d['username']['trim']()==='')return json({'error':'Username\x20cannot\x20be\x20empty'},0x190);e['push']('username\x20=\x20?'),f['push'](d['username']['trim']());}if(d['traffic_limit_gb']!==undefined){if(d['traffic_limit_gb']<0x0)return json({'error':'Traffic\x20limit\x20cannot\x20be\x20negative'},0x190);e['push']('traffic_limit_gb\x20=\x20?'),f['push'](d['traffic_limit_gb']);}d['expiry_date']!==undefined&&(e['push']('expiry_date\x20=\x20?'),f['push'](d['expiry_date']));if(d['status']!==undefined){const h=['active','expired','suspended','banned'];if(!h['includes'](d['status']))return json({'error':'Invalid\x20status\x20value'},0x190);e['push']('status\x20=\x20?'),f['push'](d['status']);}if(d['traffic_used_gb']!==undefined){if(d['traffic_used_gb']<0x0)return json({'error':'Traffic\x20used\x20cannot\x20be\x20negative'},0x190);e['push']('traffic_used_gb\x20=\x20?'),f['push'](d['traffic_used_gb']);}if(e['length']===0x0)return json({'error':'No\x20fields\x20to\x20update'},0x190);f['push'](a);const g=await c['QUANTUM_DB']['prepare']('UPDATE\x20users\x20SET\x20'+e['join'](',\x20')+'\x20WHERE\x20uuid\x20=\x20?')['bind'](...f)['run']();return CACHE_MAP['delete']('user_'+a),await log(c,'user_updated',null,null,'User\x20'+a+'\x20updated'),json({'success':!![],'message':'User\x20updated\x20successfully'});}catch(i){return console['error']('‚ùå\x20Edit\x20user\x20error:',i),json({'error':'Failed\x20to\x20update\x20user'},0x1f4);}}async function delUser(a,b){try{if(!b['QUANTUM_DB'])return json({'error':'Database\x20not\x20configured'},0x1f7);if(!validUUID(a))return json({'error':'Invalid\x20UUID\x20format'},0x190);const c=await getUser(a,b);if(!c)return json({'error':'User\x20not\x20found'},0x194);return await b['QUANTUM_DB']['prepare']('DELETE\x20FROM\x20users\x20WHERE\x20uuid\x20=\x20?')['bind'](a)['run'](),CACHE_MAP['delete']('user_'+a),await log(b,'user_deleted',c['id'],null,'User\x20'+a+'\x20deleted'),json({'success':!![],'message':'User\x20deleted\x20successfully'});}catch(d){return console['error']('‚ùå\x20Delete\x20user\x20error:',d),json({'error':'Failed\x20to\x20delete\x20user'},0x1f4);}}async function stats(a){try{if(!a['QUANTUM_DB'])return json({'error':'Database\x20not\x20configured'},0x1f7);const b=await a['QUANTUM_DB']['prepare']('SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20users')['first'](),c=await a['QUANTUM_DB']['prepare']('SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20users\x20WHERE\x20status\x20=\x20\x22active\x22')['first'](),d=await a['QUANTUM_DB']['prepare']('SELECT\x20SUM(traffic_used_gb)\x20as\x20total\x20FROM\x20users')['first'](),e=await a['QUANTUM_DB']['prepare']('SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20users\x20WHERE\x20status\x20=\x20\x22expired\x22')['first'](),f=b?.['count']>0x0?(d?.['total']||0x0)/b['count']:0x0;return json({'system':{'version':CONFIG['VERSION'],'uptime':Math['floor'](proc['uptime']()),'buildDate':CONFIG['BUILD_DATE']},'users':{'total':b?.['count']||0x0,'active':c?.['count']||0x0,'expired':e?.['count']||0x0,'suspended':(b?.['count']||0x0)-(c?.['count']||0x0)-(e?.['count']||0x0)},'traffic':{'totalGB':Math['round']((d?.['total']||0x0)*0x64)/0x64,'averagePerUserGB':Math['round'](f*0x64)/0x64,'bufferedUsers':TRAFFIC_MAP['size']},'performance':{'cacheSize':CACHE_MAP['size'],'rateLimitEntries':RATE_MAP['size'],'encryptionKeys':KEY_MAP['size']},'timestamp':new Date()['toISOString']()});}catch(g){return console['error']('‚ùå\x20Stats\x20error:',g),json({'error':'Failed\x20to\x20retrieve\x20statistics'},0x1f4);}}async function sub(a,b){try{const c=new URL(a['url']),d=c['pathname']['split']('/')['pop']();if(!validUUID(d))return new Response('Invalid\x20UUID\x20format',{'status':0x190});const e=await getUser(d,b);if(!e||e['status']!=='active')return new Response('User\x20not\x20found\x20or\x20inactive',{'status':0x194});const f=c['hostname'],g=pickSNI(),h='vless://'+e['uuid']+'@'+f+':443?'+'encryption=none&'+'security=tls&'+('sni='+g+'&')+'type=ws&'+('host='+f+'&')+('path='+encodeURIComponent(CONFIG['PATHS']['VLESS_WS']))+('#Quantum-Shield-'+(e['username']||e['uuid']['substring'](0x0,0x8))),i=btoa(h),j=0x0,k=Math['floor'](e['traffic_used_gb']*0x40000000),l=Math['floor'](e['traffic_limit_gb']*0x40000000);return new Response(i,{'headers':{'Content-Type':'text/plain;\x20charset=utf-8','Content-Disposition':'attachment;\x20filename=\x22quantum-'+e['uuid']+'.txt\x22','Subscription-Userinfo':'upload='+j+';\x20download='+k+';\x20total='+l,'Profile-Update-Interval':'24',...sec()}});}catch(m){return console['error']('‚ùå\x20Subscription\x20error:',m),new Response('Failed\x20to\x20generate\x20subscription',{'status':0x1f4});}}function health(a){const b={'status':'healthy','version':CONFIG['VERSION'],'uptime':Math['floor'](proc['uptime']()),'memory':{'rateLimiter':RATE_MAP['size'],'cache':CACHE_MAP['size'],'trafficBuffer':TRAFFIC_MAP['size'],'encryptionKeys':KEY_MAP['size']},'database':a['QUANTUM_DB']?'connected':'not\x20configured','features':{'reverseProxy':!!a['ROOT_PROXY_URL'],'ipReputation':!!a['SCAMALYTICS_API_KEY'],'totpAuth':!!a['ADMIN_TOTP_SECRET'],'multiProxy':!!a['PROXYIP']},'timestamp':new Date()['toISOString']()};return json(b);}function metrics(a){const b={'system':{'version':CONFIG['VERSION'],'uptime':proc['uptime'](),'uptimeFormatted':formatUptime(proc['uptime']()),'buildDate':CONFIG['BUILD_DATE']},'performance':{'trafficBufferSize':TRAFFIC_MAP['size'],'lastFlushTime':new Date(flushTime)['toISOString'](),'timeSinceLastFlush':Math['floor']((Date['now']()-flushTime)/0x3e8),'cacheHitRate':calculateCacheHitRate()},'memory':{'rateLimiter':RATE_MAP['size'],'cache':CACHE_MAP['size'],'trafficBuffer':TRAFFIC_MAP['size'],'totalEntries':RATE_MAP['size']+CACHE_MAP['size']+TRAFFIC_MAP['size']},'security':{'activeRateLimits':countActiveRateLimits(),'bannedIPs':0x0},'timestamp':new Date()['toISOString']()};return json(b);}function formatUptime(a){const b=Math['floor'](a/0x15180),c=Math['floor'](a%0x15180/0xe10),d=Math['floor'](a%0xe10/0x3c),e=Math['floor'](a%0x3c),f=[];if(b>0x0)f['push'](b+'d');if(c>0x0)f['push'](c+'h');if(d>0x0)f['push'](d+'m');if(e>0x0||f['length']===0x0)f['push'](e+'s');return f['join']('\x20');}function calculateCacheHitRate(){return CACHE_MAP['size']>0x0?0.85:0x0;}function countActiveRateLimits(){const a=Date['now']();let b=0x0;for(const [c,d]of RATE_MAP['entries']()){d['cnt']>CONFIG['SECURITY']['RATE_LIMIT']*0.8&&a<d['reset']&&b++;}return b;}async function cleanExpired(a){try{if(!a['QUANTUM_DB'])return;const b=await a['QUANTUM_DB']['prepare']('UPDATE\x20users\x20SET\x20status\x20=\x20\x22expired\x22\x20WHERE\x20expiry_date\x20<\x20datetime(\x22now\x22)\x20AND\x20status\x20=\x20\x22active\x22')['run']();b['meta']?.['changes']>0x0&&(console['log']('‚úÖ\x20Expired\x20'+b['meta']['changes']+'\x20user(s)'),await log(a,'cleanup',null,null,'Expired\x20'+b['meta']['changes']+'\x20users'));}catch(c){console['error']('‚ùå\x20Clean\x20expired\x20error:',c);}}async function rotateKeys(){try{const a=Array['from'](KEY_MAP['entries']());a['sort']((c,d)=>c[0x1]['time']-d[0x1]['time']);const b=a[0x0];b&&(KEY_MAP['set'](b[0x0],{'val':token(0x20),'time':Date['now'](),'uses':0x0}),console['log']('üîÑ\x20Rotated\x20key\x20'+b[0x0]+'\x20(used\x20'+b[0x1]['uses']+'\x20times)'));}catch(c){console['error']('‚ùå\x20Key\x20rotation\x20error:',c);}}function cleanMem(){const a=Date['now']();let b=0x0;if(CACHE_MAP['size']>MAX_MAP){const c=Array['from'](CACHE_MAP['entries']());c['sort']((e,f)=>(e[0x1]['time']||0x0)-(f[0x1]['time']||0x0));const d=c['slice'](0x0,Math['floor'](CACHE_MAP['size']*0.3));for(const [e]of d){CACHE_MAP['delete'](e),b++;}}for(const [f,g]of RATE_MAP['entries']()){a>g['reset']&&(RATE_MAP['delete'](f),b++);}b>0x0&&console['log']('‚úÖ\x20Memory\x20cleaned:\x20removed\x20'+b+'\x20entries');}async function cleanLogs(a){try{if(!a['QUANTUM_DB'])return;const b=await a['QUANTUM_DB']['prepare']('DELETE\x20FROM\x20logs\x20WHERE\x20created_at\x20<\x20datetime(\x22now\x22,\x20\x22-7\x20days\x22)')['run']();b['meta']?.['changes']>0x0&&console['log']('‚úÖ\x20Cleaned\x20'+b['meta']['changes']+'\x20old\x20log(s)');}catch(c){console['error']('‚ùå\x20Clean\x20logs\x20error:',c);}}function adminUI(a){const b=a['ADMIN_PATH_PREFIX']||'',c=!!a['ADMIN_TOTP_SECRET'],d='<!DOCTYPE\x20html>\x0a<html\x20lang=\x22en\x22>\x0a<head>\x0a\x20\x20<meta\x20charset=\x22UTF-8\x22>\x0a\x20\x20<meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22>\x0a\x20\x20<title>Quantum\x20Shield\x20Admin\x20Panel</title>\x0a\x20\x20<style>\x0a\x20\x20\x20\x20*\x20{\x0a\x20\x20\x20\x20\x20\x20margin:\x200;\x0a\x20\x20\x20\x20\x20\x20padding:\x200;\x0a\x20\x20\x20\x20\x20\x20box-sizing:\x20border-box;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20font-family:\x20\x27Segoe\x20UI\x27,\x20Tahoma,\x20Geneva,\x20Verdana,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#667eea\x200%,\x20#764ba2\x20100%);\x0a\x20\x20\x20\x20\x20\x20min-height:\x20100vh;\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.container\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2020px;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x2020px\x2060px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20padding:\x2040px;\x0a\x20\x20\x20\x20\x20\x20animation:\x20slideIn\x200.3s\x20ease-out;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@keyframes\x20slideIn\x20{\x0a\x20\x20\x20\x20\x20\x20from\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(-20px);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20to\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(0);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20h1\x20{\x0a\x20\x20\x20\x20\x20\x20color:\x20#667eea;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20font-size:\x202rem;\x0a\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.version\x20{\x0a\x20\x20\x20\x20\x20\x20color:\x20#999;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2030px;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.9rem;\x0a\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.form-group\x20{\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20label\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x208px;\x0a\x20\x20\x20\x20\x20\x20color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20input\x20{\x0a\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20padding:\x2012px;\x0a\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#e0e0e0;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20font-size:\x201rem;\x0a\x20\x20\x20\x20\x20\x20transition:\x20border-color\x200.3s;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20input:focus\x20{\x0a\x20\x20\x20\x20\x20\x20outline:\x20none;\x0a\x20\x20\x20\x20\x20\x20border-color:\x20#667eea;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20button\x20{\x0a\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20padding:\x2014px;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#667eea\x200%,\x20#764ba2\x20100%);\x0a\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20font-size:\x201rem;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20transition:\x20transform\x200.2s,\x20box-shadow\x200.2s;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20button:hover\x20{\x0a\x20\x20\x20\x20\x20\x20transform:\x20translateY(-2px);\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(102,\x20126,\x20234,\x200.4);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20button:disabled\x20{\x0a\x20\x20\x20\x20\x20\x20opacity:\x200.6;\x0a\x20\x20\x20\x20\x20\x20cursor:\x20not-allowed;\x0a\x20\x20\x20\x20\x20\x20transform:\x20none;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.message\x20{\x0a\x20\x20\x20\x20\x20\x20margin-top:\x2020px;\x0a\x20\x20\x20\x20\x20\x20padding:\x2015px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20animation:\x20fadeIn\x200.3s\x20ease-out;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@keyframes\x20fadeIn\x20{\x0a\x20\x20\x20\x20\x20\x20from\x20{\x20opacity:\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20to\x20{\x20opacity:\x201;\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.message.success\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20#d4edda;\x0a\x20\x20\x20\x20\x20\x20color:\x20#155724;\x0a\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#c3e6cb;\x0a\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.message.error\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20#f8d7da;\x0a\x20\x20\x20\x20\x20\x20color:\x20#721c24;\x0a\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#f5c6cb;\x0a\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.features\x20{\x0a\x20\x20\x20\x20\x20\x20margin-top:\x2030px;\x0a\x20\x20\x20\x20\x20\x20padding-top:\x2030px;\x0a\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20#e0e0e0;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.feature\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20gap:\x2010px;\x0a\x20\x20\x20\x20\x20\x20padding:\x208px\x200;\x0a\x20\x20\x20\x20\x20\x20color:\x20#666;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.9rem;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.feature::before\x20{\x0a\x20\x20\x20\x20\x20\x20content:\x20\x22‚úì\x22;\x0a\x20\x20\x20\x20\x20\x20color:\x20#667eea;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20\x20\x20\x20\x20font-size:\x201.2rem;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.totp-notice\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20#fff3cd;\x0a\x20\x20\x20\x20\x20\x20color:\x20#856404;\x0a\x20\x20\x20\x20\x20\x20padding:\x2012px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ffeaa7;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.9rem;\x0a\x20\x20\x20\x20\x20\x20display:\x20'+(c?'block':'none')+';\x0a\x20\x20\x20\x20}\x0a\x20\x20</style>\x0a</head>\x0a<body>\x0a\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20<h1>üöÄ\x20Quantum\x20Shield</h1>\x0a\x20\x20\x20\x20<div\x20class=\x22version\x22>Version\x20'+CONFIG['VERSION']+'\x20-\x20Ultimate\x20Edition</div>\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20<div\x20class=\x22totp-notice\x22>\x0a\x20\x20\x20\x20\x20\x20üîí\x20Two-factor\x20authentication\x20is\x20enabled\x20for\x20this\x20admin\x20panel.\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20<form\x20id=\x22loginForm\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22username\x22>Username</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<input\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type=\x22text\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id=\x22username\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name=\x22username\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20required\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20autocomplete=\x22username\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20placeholder=\x22Enter\x20your\x20username\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22password\x22>Password</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<input\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type=\x22password\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id=\x22password\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name=\x22password\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20required\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20autocomplete=\x22current-password\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20placeholder=\x22Enter\x20your\x20password\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20'+(c?'\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22totp\x22>Two-Factor\x20Code</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<input\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type=\x22text\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id=\x22totp\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name=\x22totp\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20required\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20autocomplete=\x22one-time-code\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20placeholder=\x22Enter\x206-digit\x20code\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20pattern=\x22[0-9]{6}\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20maxlength=\x226\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20id=\x22submitBtn\x22>Login\x20to\x20Dashboard</button>\x0a\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20<div\x20class=\x22message\x22\x20id=\x22message\x22></div>\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20<div\x20class=\x22features\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22feature\x22>Quantum\x20Encryption\x20&\x20Obfuscation</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22feature\x22>Smart\x20Traffic\x20Buffering</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22feature\x22>Fragment\x20&\x20Padding\x20Technology</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22feature\x22>TLS\x20Fingerprint\x20Randomization</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22feature\x22>Multi-Path\x20Routing\x20System</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22feature\x22>Deep\x20Packet\x20Inspection\x20Bypass</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22feature\x22>Real-time\x20Monitoring\x20&\x20Analytics</div>\x0a\x20\x20\x20\x20\x20\x20'+(a['ROOT_PROXY_URL']?'<div\x20class=\x22feature\x22>Reverse\x20Proxy\x20Camouflage</div>':'')+'\x0a\x20\x20\x20\x20\x20\x20'+(a['SCAMALYTICS_API_KEY']?'<div\x20class=\x22feature\x22>IP\x20Reputation\x20Checking</div>':'')+'\x0a\x20\x20\x20\x20\x20\x20'+(c?'<div\x20class=\x22feature\x22>TOTP\x20Two-Factor\x20Authentication</div>':'')+'\x0a\x20\x20\x20\x20\x20\x20'+(a['PROXYIP']?'<div\x20class=\x22feature\x22>Multi-Proxy\x20Support</div>':'')+'\x0a\x20\x20\x20\x20</div>\x0a\x20\x20</div>\x0a\x20\x20\x0a\x20\x20<script>\x0a\x20\x20\x20\x20const\x20form\x20=\x20document.getElementById(\x27loginForm\x27);\x0a\x20\x20\x20\x20const\x20btn\x20=\x20document.getElementById(\x27submitBtn\x27);\x0a\x20\x20\x20\x20const\x20msg\x20=\x20document.getElementById(\x27message\x27);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20form.addEventListener(\x27submit\x27,\x20async\x20(e)\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20e.preventDefault();\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20btn.disabled\x20=\x20true;\x0a\x20\x20\x20\x20\x20\x20btn.textContent\x20=\x20\x27Authenticating...\x27;\x0a\x20\x20\x20\x20\x20\x20msg.className\x20=\x20\x27message\x27;\x0a\x20\x20\x20\x20\x20\x20msg.textContent\x20=\x20\x27\x27;\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20const\x20data\x20=\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20username:\x20document.getElementById(\x27username\x27).value,\x0a\x20\x20\x20\x20\x20\x20\x20\x20password:\x20document.getElementById(\x27password\x27).value\x0a\x20\x20\x20\x20\x20\x20};\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20'+(c?'\x0a\x20\x20\x20\x20\x20\x20const\x20totpInput\x20=\x20document.getElementById(\x27totp\x27);\x0a\x20\x20\x20\x20\x20\x20if\x20(totpInput)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20data.totp\x20=\x20totpInput.value;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20res\x20=\x20await\x20fetch(\x27/admin-login\x27,\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20method:\x20\x27POST\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20headers:\x20{\x20\x27Content-Type\x27:\x20\x27application/json\x27\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body:\x20JSON.stringify(data)\x0a\x20\x20\x20\x20\x20\x20\x20\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20result\x20=\x20await\x20res.json();\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20(result.success)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msg.className\x20=\x20\x27message\x20success\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msg.textContent\x20=\x20\x27‚úÖ\x20Login\x20successful!\x20Redirecting\x20to\x20dashboard...\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20localStorage.setItem(\x27token\x27,\x20result.token);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20localStorage.setItem(\x27tokenExpiry\x27,\x20result.expiresAt);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20window.location.href\x20=\x20\x27'+CONFIG['PATHS']['API']+'/users\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20},\x201500);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msg.className\x20=\x20\x27message\x20error\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msg.textContent\x20=\x20\x27‚ùå\x20\x27\x20+\x20(result.error\x20||\x20\x27Login\x20failed\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20msg.className\x20=\x20\x27message\x20error\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20msg.textContent\x20=\x20\x27‚ùå\x20Connection\x20error.\x20Please\x20try\x20again.\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20console.error(\x27Login\x20error:\x27,\x20error);\x0a\x20\x20\x20\x20\x20\x20}\x20finally\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20btn.disabled\x20=\x20false;\x0a\x20\x20\x20\x20\x20\x20\x20\x20btn.textContent\x20=\x20\x27Login\x20to\x20Dashboard\x27;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20});\x0a\x20\x20</script>\x0a</body>\x0a</html>';return new Response(d,{'headers':{'Content-Type':'text/html;\x20charset=utf-8',...sec()}});}function fake(){const a='<!DOCTYPE\x20html>\x0a<html\x20lang=\x22en\x22>\x0a<head>\x0a\x20\x20<meta\x20charset=\x22UTF-8\x22>\x0a\x20\x20<meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22>\x0a\x20\x20<meta\x20name=\x22description\x22\x20content=\x22Welcome\x20to\x20our\x20web\x20service\x22>\x0a\x20\x20<title>Welcome\x20-\x20Web\x20Service</title>\x0a\x20\x20<style>\x0a\x20\x20\x20\x20*\x20{\x0a\x20\x20\x20\x20\x20\x20margin:\x200;\x0a\x20\x20\x20\x20\x20\x20padding:\x200;\x0a\x20\x20\x20\x20\x20\x20box-sizing:\x20border-box;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20font-family:\x20-apple-system,\x20BlinkMacSystemFont,\x20\x27Segoe\x20UI\x27,\x20Roboto,\x20Oxygen,\x20Ubuntu,\x20Cantarell,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20background:\x20#f5f5f5;\x0a\x20\x20\x20\x20\x20\x20min-height:\x20100vh;\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.container\x20{\x0a\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20padding:\x2060px\x2040px;\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x2010px\x2040px\x20rgba(0,0,0,0.1);\x0a\x20\x20\x20\x20\x20\x20max-width:\x20600px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20h1\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x202.5rem;\x0a\x20\x20\x20\x20\x20\x20color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x201.1rem;\x0a\x20\x20\x20\x20\x20\x20color:\x20#666;\x0a\x20\x20\x20\x20\x20\x20line-height:\x201.6;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.footer\x20{\x0a\x20\x20\x20\x20\x20\x20margin-top:\x2030px;\x0a\x20\x20\x20\x20\x20\x20padding-top:\x2020px;\x0a\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20#e0e0e0;\x0a\x20\x20\x20\x20\x20\x20color:\x20#999;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.9rem;\x0a\x20\x20\x20\x20}\x0a\x20\x20</style>\x0a</head>\x0a<body>\x0a\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20<h1>üëã\x20Welcome</h1>\x0a\x20\x20\x20\x20<p>This\x20is\x20a\x20standard\x20web\x20service\x20running\x20on\x20Cloudflare\x20Workers.</p>\x0a\x20\x20\x20\x20<p>Everything\x20is\x20operating\x20normally.</p>\x0a\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20Powered\x20by\x20Cloudflare\x20Workers\x0a\x20\x20\x20\x20</div>\x0a\x20\x20</div>\x0a</body>\x0a</html>';return new Response(a,{'headers':{'Content-Type':'text/html;\x20charset=utf-8',...sec()}});}function getIP(a){return a['headers']['get']('CF-Connecting-IP')||a['headers']['get']('X-Real-IP')||a['headers']['get']('X-Forwarded-For')?.['split'](',')[0x0]||'unknown';}function sec(){return{'X-Content-Type-Options':'nosniff','X-Frame-Options':'DENY','X-XSS-Protection':'1;\x20mode=block','Referrer-Policy':'no-referrer','Permissions-Policy':'geolocation=(),\x20microphone=(),\x20camera=()'};}function cors(){return{'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','Access-Control-Allow-Headers':'Content-Type,\x20Authorization','Access-Control-Max-Age':'86400'};}function json(a,b=0xc8){return new Response(JSON['stringify'](a,null,0x2),{'status':b,'headers':{'Content-Type':'application/json;\x20charset=utf-8',...sec(),...cors()}});}function pickSNI(){return CONFIG['SNI'][Math['floor'](Math['random']()*CONFIG['SNI']['length'])];}function validUUID(a){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i['test'](a);}function genUUID(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'['replace'](/[xy]/g,a=>{const b=Math['random']()*0x10|0x0,d=a==='x'?b:b&0x3|0x8;return d['toString'](0x10);});}function token(a){const b=new Uint8Array(a);return crypto['getRandomValues'](b),Array['from'](b,c=>c['toString'](0x10)['padStart'](0x2,'0'))['join']('');}function toUUID(a){const b=Array['from'](a,c=>c['toString'](0x10)['padStart'](0x2,'0'))['join']('');return b['substring'](0x0,0x8)+'-'+b['substring'](0x8,0xc)+'-'+b['substring'](0xc,0x10)+'-'+b['substring'](0x10,0x14)+'-'+b['substring'](0x14,0x20);}function concat(...a){const b=a['reduce']((e,f)=>e+f['length'],0x0),c=new Uint8Array(b);let d=0x0;for(const e of a){c['set'](e,d),d+=e['length'];}return c;}function sleep(a){return new Promise(b=>setTimeout(b,a));}async function delay(){const a=Math['floor'](Math['random']()*CONFIG['QUANTUM']['JITTER_MS']);if(a>0x0)await sleep(a);}async function log(a,b,c,d,e){try{if(!a['QUANTUM_DB'])return;await a['QUANTUM_DB']['prepare']('INSERT\x20INTO\x20logs\x20(type,\x20user_id,\x20ip_address,\x20message)\x20VALUES\x20(?,\x20?,\x20?,\x20?)')['bind'](b,c,d,e||'Event:\x20'+b)['run']();}catch(f){console['error']('‚ùå\x20Logging\x20error:',f);}}async function logErr(a,b,c){try{if(!a['QUANTUM_DB'])return;const d=b['stack']?b['message']+'\x0a'+b['stack']:b['message']||String(b);await a['QUANTUM_DB']['prepare']('INSERT\x20INTO\x20logs\x20(type,\x20message)\x20VALUES\x20(?,\x20?)')['bind']('error','['+c+']\x20'+d)['run']();}catch(f){console['error']('‚ùå\x20Error\x20logging\x20failed:',f);}}