// <!--GAMFC-->version base on commit: 33a1d300d2c2ae849b8ada996de0ae3e82e28b0d - last update: 2026-01-02 13:10:58 UTC <!--GAMFC-END-->.

const CONFIG={'VERSION':'14.0.0-ultimate-complete','BUILD_DATE':'2025-01-01','BUILD_NUMBER':0x36b0,'SCHEMA_VERSION':0x5,'WORKER':{'NAME':'Quantum-VLESS-Ultimate-v14','ENVIRONMENT':'production','MAX_CONNECTIONS':0x2710,'CONNECTION_TIMEOUT':0x493e0,'KEEPALIVE_INTERVAL':0x61a8,'AUTO_RECOVERY':!![],'RECOVERY_CHECK_INTERVAL':0xafc8,'AUTO_OPTIMIZATION':!![],'OPTIMIZATION_INTERVAL':0x1d4c0,'GRACEFUL_SHUTDOWN':!![],'SHUTDOWN_TIMEOUT':0x7530},'VLESS':{'VERSION':0x0,'SUPPORTED_COMMANDS':{'TCP':0x1,'UDP':0x2,'MUX':0x3},'HEADER_LENGTH':{'MIN':0x12,'MAX':0x200},'BUFFER_SIZE':0x20000,'CHUNK_SIZE':{'MIN':0x400,'MAX':0x10000,'DEFAULT':0x8000},'ADDRESS_TYPE':{'IPV4':0x1,'DOMAIN':0x2,'IPV6':0x3},'FLOW_CONTROL':{'ENABLED':!![],'WINDOW_SIZE':0x10000,'MAX_FRAME_SIZE':0x4000}},'SECURITY':{'RATE_LIMIT':{'ENABLED':!![],'REQUESTS_PER_MINUTE':0x12c,'CONNECTIONS_PER_USER':0xf,'MAX_IPS_PER_USER':0x8,'BAN_DURATION':0x6ddd00,'WHITELIST_IPS':[],'BLACKLIST_IPS':[],'ADAPTIVE_LIMITING':!![],'THREAT_SCORE_THRESHOLD':0x23,'AUTO_UNBAN':!![],'UNBAN_CHECK_INTERVAL':0x493e0},'BLOCKED_PORTS':[0x16,0x19,0x6e,0x8f,0x1d1,0x24b,0x3e1,0x3e3,0xd3d,0x170c,0x1f90,0x22b8,0x438,0xc38,0x235a,0x13c4,0x13c5],'BLOCKED_IPS':[/^127\./,/^10\./,/^172\.(1[6-9]|2[0-9]|3[01])\./,/^192\.168\./,/^169\.254\./,/^224\./,/^240\./,/^0\./,/^255\.255\.255\.255$/],'HONEYPOT':{'ENABLED':!![],'FAKE_PORTAL':!![],'FAKE_PORTS':[0x1f90,0xc38,0x438,0x235a,0x22b8,0x20fb,0x2760],'REDIRECT_URLS':['https://www.google.com','https://www.microsoft.com','https://www.cloudflare.com','https://www.amazon.com','https://www.apple.com','https://www.wikipedia.org','https://www.github.com'],'SCANNER_PATTERNS':[/shodan/i,/censys/i,/masscan/i,/nmap/i,/scanner/i,/zgrab/i,/internetcensus/i,/research/i,/bot/i,/crawler/i,/probe/i,/scan/i,/security/i,/nikto/i,/sqlmap/i,/burp/i,/zap/i,/acunetix/i,/qualys/i,/nessus/i],'FAKE_PORTAL_DELAY':0x5dc,'CREDENTIAL_LOG':!![],'AUTO_BAN':!![],'BAN_THRESHOLD':0x3,'BAN_DURATION_MULTIPLIER':0x2,'FAKE_SERVICES':['ssh','ftp','telnet','mysql','postgres','rdp','vnc'],'DECEPTION_RESPONSES':{'ssh':'SSH-2.0-OpenSSH_8.2p1\x20Ubuntu-4ubuntu0.5','http':'Server:\x20Apache/2.4.41\x20(Ubuntu)','mysql':'5.7.39-0ubuntu0.18.04.2'}},'SANITIZE':{'ENABLED':!![],'MAX_INPUT_LENGTH':0xfa0,'BLOCKED_PATTERNS':[/<script/i,/javascript:/i,/on\w+\s*=/i,/eval\(/i,/union\s+select/i,/drop\s+table/i,/insert\s+into/i,/delete\s+from/i,/update\s+set/i,/exec\(/i,/system\(/i,/passthru/i,/`/,/\$\{/i,/<%/i,/%>/i],'STRIP_HTML':!![],'ESCAPE_OUTPUT':!![]},'ENCRYPTION':{'ENABLED':!![],'ALGORITHM':'AES-256-GCM','KEY_ROTATION_INTERVAL':0x2bf20,'USE_QUANTUM_RESISTANT':!![],'MULTI_LAYER':!![],'LAYERS':['xor','aes-gcm','chacha20'],'IV_LENGTH':0xc,'AUTH_TAG_LENGTH':0x10},'DDoS_PROTECTION':{'ENABLED':!![],'MAX_REQUESTS_PER_SECOND':0x32,'CONNECTION_FLOOD_THRESHOLD':0x64,'SYN_FLOOD_PROTECTION':!![],'CHALLENGE_RESPONSE':!![]}},'TRAFFIC_MORPHING':{'ENABLED':!![],'JITTER':{'ENABLED':!![],'MIN_DELAY':0x3,'MAX_DELAY':0x78,'PATTERN':'gaussian','STANDARD_DEVIATION':0x19,'ADAPTIVE':!![]},'PADDING':{'ENABLED':!![],'MIN_BYTES':0x8,'MAX_BYTES':0x100,'RANDOM_PATTERN':!![],'ENTROPY_BASED':!![],'HEADER_RANDOMIZATION':!![]},'FRAGMENTATION':{'ENABLED':!![],'MIN_SIZE':0x30,'MAX_SIZE':0x300,'ENTROPY_BASED':!![],'RANDOM_ORDER':!![],'INTER_FRAGMENT_DELAY':!![],'DELAY_RANGE':[0x2,0x32]},'MIMICRY':{'ENABLED':!![],'PROTOCOLS':['https','http2','quic','websocket','http3'],'TLS_FINGERPRINT_RANDOMIZATION':!![],'USER_AGENT_ROTATION':!![],'CIPHER_SUITE_RANDOMIZATION':!![],'ALPN_RANDOMIZATION':!![]},'TIMING_OBFUSCATION':{'ENABLED':!![],'PACKET_BURST_RANDOMIZATION':!![],'INTER_PACKET_DELAY':!![],'FLOW_WATERMARKING_DEFENSE':!![]}},'THREE_LAYER_SECURITY':{'ENABLED':!![],'LAYER_1_HONEYPOT':{'ENABLED':!![],'AI_MODEL':'llama-3.3','STEALTH_MODE':!![],'REDIRECT_SUSPICIOUS':!![],'REDIRECT_URLS':['https://www.google.com','https://www.wikipedia.org','https://www.cloudflare.com'],'CHECK_GEO_LOCATION':!![],'CHECK_IP_REPUTATION':!![],'CHECK_BEHAVIOR_PATTERN':!![],'BLOCK_THRESHOLD':0.6,'CACHE_DECISIONS':!![],'CACHE_TTL':0x36ee80},'LAYER_2_TOTP':{'ENABLED':!![],'ALGORITHM':'SHA1','DIGITS':0x6,'PERIOD':0x1e,'WINDOW':0x1,'REQUIRE_SETUP':!![],'QR_CODE_GENERATION':!![],'BACKUP_CODES':{'ENABLED':!![],'COUNT':0xa,'LENGTH':0x8}},'LAYER_3_TELEGRAM':{'ENABLED':!![],'REQUIRE_CONFIRMATION':!![],'CONFIRMATION_TIMEOUT':0x1d4c0,'CODE_LENGTH':0x6,'SEND_DEVICE_INFO':!![],'SEND_LOCATION_INFO':!![],'ALLOW_DENY_BUTTONS':!![],'AUTO_APPROVE_KNOWN_DEVICES':![]},'ALL_LAYERS_REQUIRED':!![],'SKIP_LAYERS_FOR_TRUSTED':![],'TRUST_DEVICE_DAYS':0x1e,'LOG_ALL_ATTEMPTS':!![],'ALERT_ON_SUSPICIOUS':!![]},'ADVANCED_SECURITY':{'ENABLED':!![],'TWO_FACTOR_AUTH':{'ENABLED':!![],'METHOD':'combined','TOTP_WINDOW':0x1,'SESSION_TIMEOUT':0x36ee80,'REMEMBER_DEVICE':!![],'DEVICE_MEMORY_DAYS':0x1e},'TELEGRAM_OTP':{'ENABLED':!![],'CODE_LENGTH':0x6,'CODE_EXPIRY':0x493e0,'MAX_ATTEMPTS':0x3,'SEND_LOGIN_ALERTS':!![],'ALERT_TEMPLATE':{'LOGIN_ATTEMPT':'ðŸš¨\x20Login\x20Attempt\x20Detected\x0a\x0aIP:\x20{ip}\x0aCountry:\x20{country}\x0aTime:\x20{time}\x0a\x0aVerification\x20Code:\x20{code}\x0a\x0aIf\x20this\x20wasn\x27t\x20you,\x20ignore\x20this\x20message.','SUCCESSFUL_LOGIN':'âœ…\x20Successful\x20Admin\x20Login\x0a\x0aIP:\x20{ip}\x0aCountry:\x20{country}\x0aDevice:\x20{device}\x0aTime:\x20{time}','FAILED_LOGIN':'âŒ\x20Failed\x20Login\x20Attempt\x0a\x0aIP:\x20{ip}\x0aCountry:\x20{country}\x0aReason:\x20{reason}\x0aTime:\x20{time}'}},'GEO_RESTRICTION':{'ENABLED':!![],'MODE':'whitelist','ALLOWED_COUNTRIES':['IR','US','DE','GB','FR','NL','CA'],'BLOCKED_COUNTRIES':['KP','CU'],'ALLOW_VPN_IPS':!![],'AI_ANOMALY_DETECTION':!![]},'IP_INTELLIGENCE':{'ENABLED':!![],'CHECK_VPN':!![],'CHECK_PROXY':!![],'CHECK_TOR':!![],'CHECK_DATACENTER':!![],'CHECK_REPUTATION':!![],'BLOCK_HIGH_RISK':!![],'RISK_THRESHOLD':0x4b,'WHITELIST_IPS':[],'BLACKLIST_IPS':[]},'BEHAVIORAL_ANALYSIS':{'ENABLED':!![],'TRACK_LOGIN_PATTERNS':!![],'TRACK_USAGE_PATTERNS':!![],'ANOMALY_DETECTION':!![],'AI_MODEL':'deepseek-r1','LEARN_FROM_BEHAVIOR':!![],'SUSPICIOUS_ACTIVITY_THRESHOLD':0.7},'SESSION_MANAGEMENT':{'ENABLED':!![],'MAX_CONCURRENT_SESSIONS':0x3,'SESSION_BINDING':'ip+useragent','AUTO_LOGOUT_INACTIVE':!![],'INACTIVE_TIMEOUT':0x1b7740,'FORCE_REAUTH_CRITICAL':!![]},'LOGIN_RATE_LIMIT':{'ENABLED':!![],'MAX_ATTEMPTS':0x5,'WINDOW':0xdbba0,'LOCKOUT_DURATION':0x36ee80,'PROGRESSIVE_DELAY':!![],'CAPTCHA_AFTER_ATTEMPTS':0x3},'DEVICE_FINGERPRINTING':{'ENABLED':!![],'TRACK_BROWSER':!![],'TRACK_OS':!![],'TRACK_SCREEN_RESOLUTION':!![],'TRACK_TIMEZONE':!![],'ALERT_NEW_DEVICE':!![]},'SECURITY_HEADERS':{'HSTS':'max-age=31536000;\x20includeSubDomains;\x20preload','CSP':'default-src\x20\x27self\x27;\x20script-src\x20\x27self\x27\x20\x27unsafe-inline\x27;\x20style-src\x20\x27self\x27\x20\x27unsafe-inline\x27','X_FRAME_OPTIONS':'DENY','X_CONTENT_TYPE_OPTIONS':'nosniff','REFERRER_POLICY':'no-referrer','PERMISSIONS_POLICY':'geolocation=(),\x20microphone=(),\x20camera=()'},'AUDIT_LOG':{'ENABLED':!![],'LOG_ALL_LOGINS':!![],'LOG_FAILED_ATTEMPTS':!![],'LOG_CONFIG_CHANGES':!![],'LOG_USER_ACTIONS':!![],'RETENTION_DAYS':0x5a,'ALERT_CRITICAL':!![]}},'ANTI_CENSORSHIP':{'IRAN_OPTIMIZED':!![],'CHINA_OPTIMIZED':!![],'DPI_EVASION':{'ENABLED':!![],'TECHNIQUES':['fragmentation','padding','timing','mimicry','tunneling'],'SNI_FRAGMENTATION':!![],'ESNI_SUPPORT':!![],'ECH_SUPPORT':!![]},'DOMAIN_FRONTING':{'ENABLED':!![],'CDN_FRONTS':['cloudflare.com','www.cloudflare.com','cdnjs.cloudflare.com','ajax.googleapis.com','fonts.googleapis.com','d2c8v52ll5s99u.cloudfront.net','a248.e.akamai.net']},'PROTOCOL_CAMOUFLAGE':{'ENABLED':!![],'FAKE_PROTOCOLS':['http','websocket','grpc'],'HEADER_MANIPULATION':!![]}},'CDN':{'MULTI_CDN':!![],'PROVIDERS':[{'name':'cloudflare','priority':0x1,'weight':0x23,'endpoint':'cf.example.com','regions':['global']},{'name':'fastly','priority':0x2,'weight':0x19,'endpoint':'fastly.example.com','regions':['us','eu']},{'name':'akamai','priority':0x3,'weight':0x14,'endpoint':'akamai.example.com','regions':['asia','eu']},{'name':'cloudfront','priority':0x4,'weight':0xf,'endpoint':'cloudfront.example.com','regions':['global']},{'name':'bunny','priority':0x5,'weight':0x5,'endpoint':'bunny.example.com','regions':['eu']}],'FAILOVER':{'ENABLED':!![],'HEALTH_CHECK_INTERVAL':0x4e20,'MAX_RETRIES':0x4,'TIMEOUT':0xfa0,'AUTO_SWITCH':!![],'FALLBACK_STRATEGY':'cascade','CIRCUIT_BREAKER':{'ENABLED':!![],'FAILURE_THRESHOLD':0x5,'TIMEOUT':0xea60,'HALF_OPEN_REQUESTS':0x3}},'LOAD_BALANCING':{'ALGORITHM':'weighted-round-robin','STICKY_SESSIONS':!![],'SESSION_TTL':0x6ddd00,'GEO_AWARENESS':!![],'LATENCY_BASED':!![],'LOAD_AWARE':!![]}},'AI_ORCHESTRATION':{'ENABLED':!![],'STRATEGY':'intelligent-routing','MODELS':{'DEEPSEEK':{'id':'@cf/deepseek-ai/deepseek-r1-distill-qwen-32b','name':'Deepseek-R1-Distill-Qwen-32B','enabled':!![],'priority':0x1,'weight':0x3c,'specialization':['reasoning','analysis','problem-solving','mathematical-computation','code-analysis','logical-deduction','complex-queries','security-analysis','threat-assessment','pattern-recognition'],'maxTokens':0x1000,'temperature':0.3,'topP':0.9,'timeout':0x7530,'retryAttempts':0x3,'retryDelay':0x3e8,'costPerRequest':0.001,'averageLatency':0x320,'reliability':0.95},'LLAMA':{'id':'@cf/meta/llama-3.3-70b-instruct-fp8-fast','name':'Llama-3.3-70B-Instruct-FP8-Fast','enabled':!![],'priority':0x2,'weight':0x28,'specialization':['general-conversation','creative-writing','content-generation','quick-responses','summarization','translation','qa-answering','domain-suggestions','sni-discovery','user-interaction'],'maxTokens':0x1000,'temperature':0.7,'topP':0.95,'timeout':0x61a8,'retryAttempts':0x3,'retryDelay':0x3e8,'costPerRequest':0.0015,'averageLatency':0x258,'reliability':0.98},'FALLBACK':{'id':'@cf/meta/llama-2-7b-chat-int8','name':'Llama-2-7B-Chat-INT8','enabled':!![],'priority':0x3,'weight':0x0,'specialization':['fallback'],'maxTokens':0x800,'temperature':0.7,'topP':0.9,'timeout':0x4e20,'retryAttempts':0x2,'retryDelay':0x1f4,'costPerRequest':0.0005,'averageLatency':0x190,'reliability':0.9}},'TASK_ROUTING':{'sni-discovery':{'primary':'LLAMA','fallback':'DEEPSEEK','confidence':0.85,'reasoning':'Llama\x20excels\x20at\x20generating\x20creative\x20domain\x20lists'},'security-analysis':{'primary':'DEEPSEEK','fallback':'LLAMA','confidence':0.95,'reasoning':'Deepseek\x20superior\x20at\x20threat\x20detection\x20and\x20analysis'},'traffic-analysis':{'primary':'DEEPSEEK','fallback':'LLAMA','confidence':0.9,'reasoning':'Requires\x20deep\x20analytical\x20reasoning'},'anomaly-detection':{'primary':'DEEPSEEK','fallback':'LLAMA','confidence':0.92,'reasoning':'Pattern\x20recognition\x20is\x20Deepseek\x20strength'},'user-query':{'primary':'LLAMA','fallback':'DEEPSEEK','confidence':0.8,'reasoning':'Fast\x20responses\x20for\x20user\x20interaction'},'content-generation':{'primary':'LLAMA','fallback':'DEEPSEEK','confidence':0.85,'reasoning':'Creative\x20content\x20generation'},'code-review':{'primary':'DEEPSEEK','fallback':'LLAMA','confidence':0.93,'reasoning':'Code\x20analysis\x20requires\x20logical\x20reasoning'},'optimization-suggestions':{'primary':'DEEPSEEK','fallback':'LLAMA','confidence':0.88,'reasoning':'System\x20optimization\x20requires\x20analytical\x20thinking'}},'INTELLIGENT_ROUTING':{'ENABLED':!![],'USE_LOAD_BALANCING':!![],'USE_LATENCY_BASED':!![],'USE_COST_OPTIMIZATION':!![],'USE_RELIABILITY_SCORE':!![],'SCORING_WEIGHTS':{'specialization':0.4,'latency':0.25,'reliability':0.2,'cost':0.1,'load':0.05},'ADAPTIVE_LEARNING':{'ENABLED':!![],'TRACK_SUCCESS_RATE':!![],'ADJUST_WEIGHTS':!![],'LEARNING_RATE':0.1,'MIN_SAMPLES':0x64}},'MONITORING':{'ENABLED':!![],'TRACK_LATENCY':!![],'TRACK_TOKEN_USAGE':!![],'TRACK_ERROR_RATE':!![],'TRACK_COST':!![],'LOG_ALL_REQUESTS':!![],'ALERT_ON_FAILURE':!![],'FAILURE_THRESHOLD':0.15},'CACHE':{'ENABLED':!![],'TTL':0x36ee80,'MAX_SIZE':0x3e8,'CACHE_SIMILAR_QUERIES':!![],'SIMILARITY_THRESHOLD':0.85,'USE_SEMANTIC_CACHE':!![]},'PARALLEL_EXECUTION':{'ENABLED':![],'MAX_PARALLEL':0x2,'CONSENSUS_REQUIRED':![],'VOTING_STRATEGY':'weighted','TIMEOUT':0x88b8}},'AI_LEGACY':{'ENABLED':!![],'MODEL':'@cf/meta/llama-3.1-8b-instruct','MAX_TOKENS':0x800,'TEMPERATURE':0.7,'SNI_DISCOVERY':{'ENABLED':!![],'AUTO_SCAN_INTERVAL':0x124f80,'MIN_STABILITY_SCORE':0x4b,'MAX_LATENCY':0xb4,'TEST_ENDPOINTS':['cloudflare.com','google.com','microsoft.com','amazon.com','apple.com','github.com','stackoverflow.com','wikipedia.org'],'ASN_AWARE':!![],'GEO_OPTIMIZATION':!![],'CONCURRENT_TESTS':0x5,'TEST_RETRIES':0x3,'BLACKLIST_ON_FAILURE':!![]},'TRAFFIC_ANALYSIS':{'ENABLED':!![],'ANOMALY_DETECTION':!![],'PATTERN_LEARNING':!![],'THREAT_PREDICTION':!![],'BEHAVIORAL_ANALYSIS':!![],'ML_MODEL':'ensemble'},'OPTIMIZATION':{'ENABLED':!![],'AUTO_TUNE_ROUTES':!![],'ADAPTIVE_CACHING':!![],'PREDICTIVE_SCALING':!![],'RESOURCE_OPTIMIZATION':!![],'INTELLIGENT_ROUTING':!![]},'INSIGHTS':{'ENABLED':!![],'REAL_TIME':!![],'PREDICTIVE_ANALYTICS':!![],'SECURITY_SCORING':!![]}},'TELEGRAM':{'ENABLED':![],'BOT_TOKEN':'','ADMIN_IDS':[],'WEBHOOK_URL':'','COMMANDS':{'START':'/start','HELP':'/help','STATUS':'/status','STATS':'/stats','USERS':'/users','SCAN':'/scan','OPTIMIZE':'/optimize','RESTART':'/restart','BACKUP':'/backup'},'NOTIFICATIONS':{'ENABLED':!![],'ON_ERROR':!![],'ON_ATTACK':!![],'ON_HIGH_LOAD':!![],'ON_USER_LIMIT':!![],'ON_SYSTEM_CRITICAL':!![]},'AUTO_RESPONSES':!![],'RATE_LIMIT':0x1e},'MONITORING':{'ENABLED':!![],'METRICS_INTERVAL':0x7530,'ALERT_THRESHOLDS':{'CPU':0x4b,'MEMORY':0x50,'ERROR_RATE':0x3,'RESPONSE_TIME':0x5dc,'CONNECTION_RATE':0x5a},'LOG_RETENTION_DAYS':0x2d,'PERFORMANCE_TRACKING':!![],'REAL_TIME_DASHBOARD':!![],'EXPORT_METRICS':!![],'PROMETHEUS_COMPATIBLE':!![]},'CACHE':{'MULTI_LAYER':!![],'L1':{'TTL':0x7530,'MAX_SIZE':0x7d0,'TYPE':'memory'},'L2':{'TTL':0x2bf20,'MAX_SIZE':0x2710,'TYPE':'memory'},'L3':{'TTL':0x124f80,'MAX_SIZE':0xc350,'TYPE':'database'},'SMART_INVALIDATION':!![],'PREFETCH':!![],'COMPRESSION':!![],'CACHE_WARMING':!![]},'DATABASE':{'AUTO_CREATE_SCHEMA':!![],'SCHEMA_VERSION':0x5,'MIGRATION_STRATEGY':'safe','BACKUP_BEFORE_MIGRATION':!![],'AUTO_OPTIMIZE':!![],'VACUUM_INTERVAL':0x2932e00,'ANALYZE_INTERVAL':0x1499700,'CONNECTION_POOL_SIZE':0xa,'QUERY_TIMEOUT':0x2710,'RETRY_ON_BUSY':!![],'MAX_RETRIES':0x5},'ADMIN':{'DEFAULT_USERNAME':'admin','DEFAULT_PASSWORD':'ChangeMe123!','SESSION_TIMEOUT':0x36ee80,'MFA_ENABLED':![],'AUDIT_LOG':!![]},'PERFORMANCE':{'COMPRESSION':{'ENABLED':!![],'ALGORITHM':'gzip','LEVEL':0x6,'THRESHOLD':0x400},'KEEP_ALIVE':!![],'TCP_NODELAY':!![],'BUFFER_POOLING':!![],'ZERO_COPY':!![]}},MEMORY_CACHE={'l1':{'users':new Map(),'snis':new Map(),'connections':new Map(),'stats':new Map(),'metadata':new Map()},'l2':{'users':new Map(),'sessions':new Map(),'routes':new Map()},'stats':{'hits':0x0,'misses':0x0,'evictions':0x0,'size':0x0},'get'(a,b){const c=this[a];if(!c)return null;const d=c[Object['keys'](c)[0x0]]?.['get']?.(b)||Object['values'](c)['find'](e=>e['has']?.(b))?.['get'](b);if(d&&d['expires']>Date['now']())return this['stats']['hits']++,d['lastAccess']=Date['now'](),d['data'];return d&&Object['values'](c)['forEach'](e=>e['delete']?.(b)),this['stats']['misses']++,null;},'set'(a,b,c,d,e){const f=this[a]?.[b];if(!f)return![];const g={'data':d,'expires':Date['now']()+(e||CONFIG['CACHE'][a['toUpperCase']()]['TTL']),'created':Date['now'](),'lastAccess':Date['now'](),'hits':0x0};return f['set'](c,g),this['stats']['size']++,f['size']>CONFIG['CACHE'][a['toUpperCase']()]['MAX_SIZE']&&this['evictLRU'](a,b),!![];},'evictLRU'(a,b){const c=this[a]?.[b];if(!c)return;let d=null,e=null;for(const [f,g]of c['entries']()){(!d||g['lastAccess']<d['lastAccess'])&&(d=g,e=f);}e&&(c['delete'](e),this['stats']['evictions']++,this['stats']['size']--);},'clear'(a){if(a){const b=this[a];Object['values'](b)['forEach'](d=>d['clear']?.());}else Object['values'](this)['forEach'](c=>{typeof c==='object'&&c!==this['stats']&&Object['values'](c)['forEach'](d=>d['clear']?.());});this['stats']={'hits':0x0,'misses':0x0,'evictions':0x0,'size':0x0};}},DATABASE_SCHEMAS={'v5':{'users':'CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20users\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20uuid\x20TEXT\x20UNIQUE\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20username\x20TEXT\x20UNIQUE\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20password_hash\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20email\x20TEXT\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20traffic_used\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20traffic_limit\x20INTEGER\x20DEFAULT\x20107374182400,\x0a\x20\x20\x20\x20\x20\x20status\x20TEXT\x20DEFAULT\x20\x27active\x27\x20CHECK(status\x20IN\x20(\x27active\x27,\x20\x27suspended\x27,\x20\x27expired\x27,\x20\x27banned\x27)),\x0a\x20\x20\x20\x20\x20\x20expiry_date\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20created_at\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20updated_at\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20last_login\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20last_ip\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20device_count\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20connection_count\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20max_connections\x20INTEGER\x20DEFAULT\x205,\x0a\x20\x20\x20\x20\x20\x20max_devices\x20INTEGER\x20DEFAULT\x203,\x0a\x20\x20\x20\x20\x20\x20referral_code\x20TEXT\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20referred_by\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20subscription_tier\x20TEXT\x20DEFAULT\x20\x27free\x27\x20CHECK(subscription_tier\x20IN\x20(\x27free\x27,\x20\x27basic\x27,\x20\x27pro\x27,\x20\x27enterprise\x27)),\x0a\x20\x20\x20\x20\x20\x20notes\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20metadata\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(referred_by)\x20REFERENCES\x20users(id)\x20ON\x20DELETE\x20SET\x20NULL\x0a\x20\x20\x20\x20);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_users_uuid\x20ON\x20users(uuid);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_users_username\x20ON\x20users(username);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_users_email\x20ON\x20users(email);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_users_status\x20ON\x20users(status);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_users_expiry\x20ON\x20users(expiry_date);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_users_referral\x20ON\x20users(referral_code);','connections':'CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20connections\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20user_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20ip_address\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20user_agent\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20connected_at\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20disconnected_at\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20bytes_sent\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20bytes_received\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20duration\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20status\x20TEXT\x20DEFAULT\x20\x27active\x27\x20CHECK(status\x20IN\x20(\x27active\x27,\x20\x27idle\x27,\x20\x27closed\x27,\x20\x27error\x27)),\x0a\x20\x20\x20\x20\x20\x20connection_type\x20TEXT\x20DEFAULT\x20\x27vless\x27,\x0a\x20\x20\x20\x20\x20\x20cdn_provider\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20server_location\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20destination_host\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20destination_port\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20protocol_version\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20error_message\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(user_id)\x20REFERENCES\x20users(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_connections_user\x20ON\x20connections(user_id);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_connections_status\x20ON\x20connections(status);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_connections_time\x20ON\x20connections(connected_at);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_connections_ip\x20ON\x20connections(ip_address);','traffic_logs':'CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20traffic_logs\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20user_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20connection_id\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20bytes_transferred\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20direction\x20TEXT\x20NOT\x20NULL\x20CHECK(direction\x20IN\x20(\x27upload\x27,\x20\x27download\x27)),\x0a\x20\x20\x20\x20\x20\x20timestamp\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20protocol\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20destination\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20port\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20packet_count\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(user_id)\x20REFERENCES\x20users(id)\x20ON\x20DELETE\x20CASCADE,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(connection_id)\x20REFERENCES\x20connections(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_traffic_user\x20ON\x20traffic_logs(user_id);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_traffic_connection\x20ON\x20traffic_logs(connection_id);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_traffic_time\x20ON\x20traffic_logs(timestamp);','security_events':'CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20security_events\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20event_type\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20severity\x20TEXT\x20NOT\x20NULL\x20CHECK(severity\x20IN\x20(\x27low\x27,\x20\x27medium\x27,\x20\x27high\x27,\x20\x27critical\x27)),\x0a\x20\x20\x20\x20\x20\x20ip_address\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20user_agent\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20user_id\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20details\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20timestamp\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20handled\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20response_action\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20threat_score\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20blocked\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(user_id)\x20REFERENCES\x20users(id)\x20ON\x20DELETE\x20SET\x20NULL\x0a\x20\x20\x20\x20);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_security_type\x20ON\x20security_events(event_type);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_security_time\x20ON\x20security_events(timestamp);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_security_severity\x20ON\x20security_events(severity);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_security_ip\x20ON\x20security_events(ip_address);','optimal_snis':'CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20optimal_snis\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20domain\x20TEXT\x20UNIQUE\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20provider\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20asn\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20country_code\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20stability_score\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20avg_latency\x20REAL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20success_rate\x20REAL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20last_tested\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20test_count\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20failure_count\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20is_active\x20INTEGER\x20DEFAULT\x201,\x0a\x20\x20\x20\x20\x20\x20is_blacklisted\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20blacklist_reason\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20cdn_type\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20supports_http2\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20supports_http3\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20tls_version\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20created_at\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20updated_at\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27))\x0a\x20\x20\x20\x20);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_sni_domain\x20ON\x20optimal_snis(domain);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_sni_score\x20ON\x20optimal_snis(stability_score);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_sni_active\x20ON\x20optimal_snis(is_active);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_sni_country\x20ON\x20optimal_snis(country_code);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_sni_asn\x20ON\x20optimal_snis(asn);','cdn_health':'CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20cdn_health\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20provider\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20endpoint\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20status\x20TEXT\x20DEFAULT\x20\x27unknown\x27\x20CHECK(status\x20IN\x20(\x27healthy\x27,\x20\x27degraded\x27,\x20\x27down\x27,\x20\x27unknown\x27)),\x0a\x20\x20\x20\x20\x20\x20response_time\x20REAL,\x0a\x20\x20\x20\x20\x20\x20success_rate\x20REAL\x20DEFAULT\x20100,\x0a\x20\x20\x20\x20\x20\x20last_check\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20consecutive_failures\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20is_available\x20INTEGER\x20DEFAULT\x201,\x0a\x20\x20\x20\x20\x20\x20region\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20load_score\x20REAL\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20total_connections\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20active_connections\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20UNIQUE(provider,\x20endpoint,\x20region)\x0a\x20\x20\x20\x20);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_cdn_provider\x20ON\x20cdn_health(provider);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_cdn_status\x20ON\x20cdn_health(status);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_cdn_available\x20ON\x20cdn_health(is_available);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_cdn_region\x20ON\x20cdn_health(region);','performance_metrics':'CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20performance_metrics\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20metric_type\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20metric_value\x20REAL\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20timestamp\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20metadata\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20aggregation_period\x20TEXT\x20DEFAULT\x20\x27minute\x27\x20CHECK(aggregation_period\x20IN\x20(\x27second\x27,\x20\x27minute\x27,\x20\x27hour\x27,\x20\x27day\x27)),\x0a\x20\x20\x20\x20\x20\x20node_id\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20region\x20TEXT\x0a\x20\x20\x20\x20);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_metrics_type\x20ON\x20performance_metrics(metric_type);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_metrics_time\x20ON\x20performance_metrics(timestamp);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_metrics_period\x20ON\x20performance_metrics(aggregation_period);','system_config':'CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20system_config\x20(\x0a\x20\x20\x20\x20\x20\x20key\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20value\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20value_type\x20TEXT\x20DEFAULT\x20\x27string\x27\x20CHECK(value_type\x20IN\x20(\x27string\x27,\x20\x27number\x27,\x20\x27boolean\x27,\x20\x27json\x27)),\x0a\x20\x20\x20\x20\x20\x20description\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20is_sensitive\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20updated_at\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20updated_by\x20TEXT\x0a\x20\x20\x20\x20);','api_keys':'CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20api_keys\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20key\x20TEXT\x20UNIQUE\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20user_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20permissions\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20created_at\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20expires_at\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20last_used\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20usage_count\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20is_active\x20INTEGER\x20DEFAULT\x201,\x0a\x20\x20\x20\x20\x20\x20rate_limit\x20INTEGER\x20DEFAULT\x20100,\x0a\x20\x20\x20\x20\x20\x20ip_whitelist\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(user_id)\x20REFERENCES\x20users(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_apikeys_key\x20ON\x20api_keys(key);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_apikeys_user\x20ON\x20api_keys(user_id);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_apikeys_active\x20ON\x20api_keys(is_active);','rate_limits':'CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20rate_limits\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20identifier\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20identifier_type\x20TEXT\x20NOT\x20NULL\x20CHECK(identifier_type\x20IN\x20(\x27ip\x27,\x20\x27user\x27,\x20\x27api_key\x27)),\x0a\x20\x20\x20\x20\x20\x20request_count\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20window_start\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20window_end\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20is_banned\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20ban_expires_at\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20ban_reason\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20UNIQUE(identifier,\x20identifier_type,\x20window_start)\x0a\x20\x20\x20\x20);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_ratelimit_id\x20ON\x20rate_limits(identifier);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_ratelimit_type\x20ON\x20rate_limits(identifier_type);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_ratelimit_window\x20ON\x20rate_limits(window_start,\x20window_end);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_ratelimit_banned\x20ON\x20rate_limits(is_banned);','ai_insights':'CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20ai_insights\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20insight_type\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20data\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20confidence\x20REAL,\x0a\x20\x20\x20\x20\x20\x20created_at\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20expires_at\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20is_applied\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20applied_at\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20impact_score\x20REAL,\x0a\x20\x20\x20\x20\x20\x20metadata\x20TEXT\x0a\x20\x20\x20\x20);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_insights_type\x20ON\x20ai_insights(insight_type);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_insights_created\x20ON\x20ai_insights(created_at);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_insights_applied\x20ON\x20ai_insights(is_applied);','audit_logs':'CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20audit_logs\x20(\x0a\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20user_id\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20action\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20resource_type\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20resource_id\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20changes\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20ip_address\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20user_agent\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20timestamp\x20INTEGER\x20DEFAULT\x20(strftime(\x27%s\x27,\x20\x27now\x27)),\x0a\x20\x20\x20\x20\x20\x20success\x20INTEGER\x20DEFAULT\x201,\x0a\x20\x20\x20\x20\x20\x20error_message\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(user_id)\x20REFERENCES\x20users(id)\x20ON\x20DELETE\x20SET\x20NULL\x0a\x20\x20\x20\x20);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_audit_user\x20ON\x20audit_logs(user_id);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_audit_action\x20ON\x20audit_logs(action);\x0a\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_audit_time\x20ON\x20audit_logs(timestamp);'}},Utils={'generateUUID'(){return crypto['randomUUID']();},'getRandomBytes'(a){const b=new Uint8Array(a);return crypto['getRandomValues'](b),b;},'arrayBufferToHex'(a){return[...new Uint8Array(a)]['map'](c=>c['toString'](0x10)['padStart'](0x2,'0'))['join']('');},'hexToArrayBuffer'(a){const b=new Uint8Array(a['length']/0x2);for(let c=0x0;c<a['length'];c+=0x2){b[c/0x2]=parseInt(a['substr'](c,0x2),0x10);}return b['buffer'];},async 'hashPassword'(a){const b=new TextEncoder(),c=b['encode'](a+CONFIG['VERSION']),d=await crypto['subtle']['digest']('SHA-256',c);return this['arrayBufferToHex'](d);},async 'verifyPassword'(a,b){const c=await this['hashPassword'](a);return c===b;},'formatBytes'(a,b=0x2){if(a===0x0)return'0\x20B';const c=0x400,d=b<0x0?0x0:b,e=['B','KB','MB','GB','TB','PB'],f=Math['floor'](Math['log'](a)/Math['log'](c));return parseFloat((a/Math['pow'](c,f))['toFixed'](d))+'\x20'+e[f];},'formatDuration'(a){const b=Math['floor'](a/0x3e8),c=Math['floor'](b/0x3c),d=Math['floor'](c/0x3c),e=Math['floor'](d/0x18);if(e>0x0)return e+'d\x20'+d%0x18+'h';if(d>0x0)return d+'h\x20'+c%0x3c+'m';if(c>0x0)return c+'m\x20'+b%0x3c+'s';return b+'s';},'formatDate'(a){if(!a)return'Never';const b=new Date(a*0x3e8);return b['toISOString']()['replace']('T','\x20')['substring'](0x0,0x13);},'escapeHtml'(a){if(!a)return'';const b={'&':'&amp;','<':'&lt;','>':'&gt;','\x22':'&quot;','\x27':'&#039;'};return a['toString']()['replace'](/[&<>"']/g,c=>b[c]);},'sanitizeInput'(a,b=CONFIG['SECURITY']['SANITIZE']['MAX_INPUT_LENGTH']){if(!a)return'';let c=a['toString']()['substring'](0x0,b);if(CONFIG['SECURITY']['SANITIZE']['ENABLED']){for(const d of CONFIG['SECURITY']['SANITIZE']['BLOCKED_PATTERNS']){if(d['test'](c))return'';}CONFIG['SECURITY']['SANITIZE']['STRIP_HTML']&&(c=c['replace'](/<[^>]*>/g,''));}return c;},'parseUUID'(a){const b=new Uint8Array(a),c=this['arrayBufferToHex'](a);return[c['substring'](0x0,0x8),c['substring'](0x8,0xc),c['substring'](0xc,0x10),c['substring'](0x10,0x14),c['substring'](0x14,0x20)]['join']('-');},'getGaussianDelay'(a,b){const c=(a+b)/0x2,d=(b-a)/0x6;let e=0x0,f=0x0;while(e===0x0)e=Math['random']();while(f===0x0)f=Math['random']();const g=Math['sqrt'](-0x2*Math['log'](e))*Math['cos'](0x2*Math['PI']*f),h=c+d*g;return Math['max'](a,Math['min'](b,Math['floor'](h)));},'sleep'(a){return new Promise(b=>setTimeout(b,a));},'isIPBlocked'(a){return CONFIG['SECURITY']['BLOCKED_IPS']['some'](b=>b['test'](a));},'isPortBlocked'(a){return CONFIG['SECURITY']['BLOCKED_PORTS']['includes'](a);},'getClientInfo'(a){return{'ip':a['headers']['get']('cf-connecting-ip')||a['headers']['get']('x-real-ip')||'unknown','country':a['headers']['get']('cf-ipcountry')||'unknown','asn':a['headers']['get']('cf-asn')||'unknown','userAgent':a['headers']['get']('user-agent')||'unknown','ray':a['headers']['get']('cf-ray')||'unknown'};}};class DatabaseManager{constructor(a){this['db']=a,this['queryCache']=new Map();}async['executeWithRetry'](a,b=CONFIG['DATABASE']['MAX_RETRIES']){for(let c=0x0;c<b;c++){try{return await a();}catch(d){if(d['message']?.['includes']('SQLITE_BUSY')&&c<b-0x1){await Utils['sleep'](0x64*Math['pow'](0x2,c));continue;}throw d;}}}async['initializeSchema'](){try{const a=await this['getSchemaVersion']();if(a<CONFIG['SCHEMA_VERSION']){console['log']('Upgrading\x20schema\x20from\x20v'+a+'\x20to\x20v'+CONFIG['SCHEMA_VERSION']);const b=DATABASE_SCHEMAS['v'+CONFIG['SCHEMA_VERSION']];for(const [c,d]of Object['entries'](b)){await this['executeWithRetry'](()=>this['db']['prepare'](d)['run']()),console['log']('âœ…\x20Table\x20'+c+'\x20created/updated');}await this['setSchemaVersion'](CONFIG['SCHEMA_VERSION']),console['log']('âœ…\x20Schema\x20upgraded\x20to\x20v'+CONFIG['SCHEMA_VERSION']);}return!![];}catch(e){console['error']('Schema\x20initialization\x20failed:',e);throw e;}}async['getSchemaVersion'](){try{const a=await this['db']['prepare']('SELECT\x20value\x20FROM\x20system_config\x20WHERE\x20key\x20=\x20?')['bind']('schema_version')['first']();return a?parseInt(a['value']):0x0;}catch{return 0x0;}}async['setSchemaVersion'](a){return this['db']['prepare']('INSERT\x20OR\x20REPLACE\x20INTO\x20system_config\x20(key,\x20value,\x20description)\x20VALUES\x20(?,\x20?,\x20?)')['bind']('schema_version',a['toString'](),'Database\x20schema\x20version')['run']();}async['getUser'](a,b='uuid'){const c='user:'+b+':'+a,d=MEMORY_CACHE['get']('l1',c);if(d)return d;const e=b==='username'?'username':'uuid',f=await this['db']['prepare']('SELECT\x20*\x20FROM\x20users\x20WHERE\x20'+e+'\x20=\x20?\x20AND\x20status\x20!=\x20\x27banned\x27')['bind'](a)['first']();return f&&MEMORY_CACHE['set']('l1','users',c,f,0xea60),f;}async['createUser'](a){const b=a['uuid']||Utils['generateUUID'](),c=a['password']?await Utils['hashPassword'](a['password']):null,d=await this['db']['prepare']('\x0a\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20users\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20uuid,\x20username,\x20password_hash,\x20email,\x20traffic_limit,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20expiry_date,\x20subscription_tier,\x20max_connections,\x20max_devices\x0a\x20\x20\x20\x20\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20\x20\x20')['bind'](b,a['username'],c,a['email']||null,a['trafficLimit']||0x1900000000,a['expiryDate']||null,a['subscriptionTier']||'free',a['maxConnections']||0x5,a['maxDevices']||0x3)['run']();if(d['success'])return{'uuid':b,...a};throw new Error('Failed\x20to\x20create\x20user');}async['updateUser'](a,b){const c=[],d=[];for(const [g,h]of Object['entries'](b)){if(h!==undefined){const i=g['replace'](/([A-Z])/g,'_$1')['toLowerCase']();c['push'](i+'\x20=\x20?'),d['push'](h);}}if(c['length']===0x0)return![];c['push']('updated_at\x20=\x20strftime(\x27%s\x27,\x20\x27now\x27)'),d['push'](a);const e='UPDATE\x20users\x20SET\x20'+c['join'](',\x20')+'\x20WHERE\x20uuid\x20=\x20?',f=await this['db']['prepare'](e)['bind'](...d)['run']();return MEMORY_CACHE['set']('l1','users','user:uuid:'+a,null,0x0),f['success'];}async['updateTraffic'](a,b){return this['db']['prepare']('\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20users\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20traffic_used\x20=\x20traffic_used\x20+\x20?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20=\x20strftime(\x27%s\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20\x20\x20WHERE\x20uuid\x20=\x20?\x0a\x20\x20\x20\x20')['bind'](b,a)['run']();}async['listUsers'](a={}){let b='SELECT\x20*\x20FROM\x20users\x20WHERE\x201=1';const c=[];a['status']&&(b+='\x20AND\x20status\x20=\x20?',c['push'](a['status']));a['tier']&&(b+='\x20AND\x20subscription_tier\x20=\x20?',c['push'](a['tier']));b+='\x20ORDER\x20BY\x20created_at\x20DESC';a['limit']&&(b+='\x20LIMIT\x20?',c['push'](a['limit']));const d=await this['db']['prepare'](b)['bind'](...c)['all']();return d['results']||[];}async['deleteUser'](a){const b=await this['db']['prepare']('DELETE\x20FROM\x20users\x20WHERE\x20uuid\x20=\x20?')['bind'](a)['run']();return MEMORY_CACHE['set']('l1','users','user:uuid:'+a,null,0x0),b['success'];}async['createConnection'](a){return this['db']['prepare']('\x0a\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20connections\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_id,\x20ip_address,\x20user_agent,\x20connection_type,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20cdn_provider,\x20server_location,\x20destination_host,\x20destination_port\x0a\x20\x20\x20\x20\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20\x20\x20')['bind'](a['userId'],a['ipAddress'],a['userAgent']||null,a['connectionType']||'vless',a['cdnProvider']||null,a['serverLocation']||null,a['destinationHost']||null,a['destinationPort']||null)['run']();}async['updateConnection'](a,b){const c=[],d=[];for(const [f,g]of Object['entries'](b)){if(g!==undefined){const h=f['replace'](/([A-Z])/g,'_$1')['toLowerCase']();c['push'](h+'\x20=\x20?'),d['push'](g);}}if(c['length']===0x0)return![];d['push'](a);const e='UPDATE\x20connections\x20SET\x20'+c['join'](',\x20')+'\x20WHERE\x20id\x20=\x20?';return this['db']['prepare'](e)['bind'](...d)['run']();}async['getActiveConnections'](a=null){let b='SELECT\x20*\x20FROM\x20connections\x20WHERE\x20status\x20=\x20\x27active\x27';const c=[];a&&(b+='\x20AND\x20user_id\x20=\x20?',c['push'](a));b+='\x20ORDER\x20BY\x20connected_at\x20DESC';const d=await this['db']['prepare'](b)['bind'](...c)['all']();return d['results']||[];}async['logTraffic'](a){return this['db']['prepare']('\x0a\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20traffic_logs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_id,\x20connection_id,\x20bytes_transferred,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20direction,\x20protocol,\x20destination,\x20port\x0a\x20\x20\x20\x20\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20\x20\x20')['bind'](a['userId'],a['connectionId']||null,a['bytesTransferred'],a['direction'],a['protocol']||null,a['destination']||null,a['port']||null)['run']();}async['logSecurityEvent'](a){return this['db']['prepare']('\x0a\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20security_events\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20event_type,\x20severity,\x20ip_address,\x20user_agent,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_id,\x20details,\x20response_action,\x20threat_score,\x20blocked\x0a\x20\x20\x20\x20\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20\x20\x20')['bind'](a['eventType'],a['severity'],a['ipAddress']||null,a['userAgent']||null,a['userId']||null,a['details']||null,a['responseAction']||null,a['threatScore']||0x0,a['blocked']?0x1:0x0)['run']();}async['getRecentSecurityEvents'](a=0x32){const b=await this['db']['prepare']('SELECT\x20*\x20FROM\x20security_events\x20ORDER\x20BY\x20timestamp\x20DESC\x20LIMIT\x20?')['bind'](a)['all']();return b['results']||[];}async['saveSNI'](a){return this['db']['prepare']('\x0a\x20\x20\x20\x20\x20\x20INSERT\x20OR\x20REPLACE\x20INTO\x20optimal_snis\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20domain,\x20provider,\x20asn,\x20country_code,\x20stability_score,\x0a\x20\x20\x20\x20\x20\x20\x20\x20avg_latency,\x20success_rate,\x20test_count,\x20is_active,\x0a\x20\x20\x20\x20\x20\x20\x20\x20cdn_type,\x20tls_version,\x20updated_at\x0a\x20\x20\x20\x20\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20strftime(\x27%s\x27,\x20\x27now\x27))\x0a\x20\x20\x20\x20')['bind'](a['domain'],a['provider']||null,a['asn']||null,a['countryCode']||null,a['stabilityScore']||0x0,a['avgLatency']||0x0,a['successRate']||0x0,a['testCount']||0x1,a['isActive']?0x1:0x0,a['cdnType']||null,a['tlsVersion']||null)['run']();}async['getOptimalSNIs'](a={}){let b='SELECT\x20*\x20FROM\x20optimal_snis\x20WHERE\x20is_active\x20=\x201\x20AND\x20is_blacklisted\x20=\x200';const c=[];a['countryCode']&&(b+='\x20AND\x20country_code\x20=\x20?',c['push'](a['countryCode']));a['minScore']&&(b+='\x20AND\x20stability_score\x20>=\x20?',c['push'](a['minScore']));b+='\x20ORDER\x20BY\x20stability_score\x20DESC,\x20avg_latency\x20ASC\x20LIMIT\x20?',c['push'](a['limit']||0x14);const d=await this['db']['prepare'](b)['bind'](...c)['all']();return d['results']||[];}async['blacklistSNI'](a,b){return this['db']['prepare']('\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20optimal_snis\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20is_blacklisted\x20=\x201,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20blacklist_reason\x20=\x20?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20=\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20=\x20strftime(\x27%s\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20\x20\x20WHERE\x20domain\x20=\x20?\x0a\x20\x20\x20\x20')['bind'](b,a)['run']();}async['getSystemStats'](){const a='stats:system',b=MEMORY_CACHE['get']('l1',a);if(b)return b;const c={'totalUsers':0x0,'activeUsers':0x0,'totalConnections':0x0,'activeConnections':0x0,'totalTraffic':0x0,'securityEvents':0x0};try{const d=[this['db']['prepare']('SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20users')['first'](),this['db']['prepare']('SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20users\x20WHERE\x20status\x20=\x20\x27active\x27')['first'](),this['db']['prepare']('SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20connections')['first'](),this['db']['prepare']('SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20connections\x20WHERE\x20status\x20=\x20\x27active\x27')['first'](),this['db']['prepare']('SELECT\x20COALESCE(SUM(traffic_used),\x200)\x20as\x20total\x20FROM\x20users')['first'](),this['db']['prepare']('SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20security_events\x20WHERE\x20timestamp\x20>\x20strftime(\x27%s\x27,\x20\x27now\x27,\x20\x27-24\x20hours\x27)')['first']()],e=await Promise['all'](d);c['totalUsers']=e[0x0]?.['count']||0x0,c['activeUsers']=e[0x1]?.['count']||0x0,c['totalConnections']=e[0x2]?.['count']||0x0,c['activeConnections']=e[0x3]?.['count']||0x0,c['totalTraffic']=e[0x4]?.['total']||0x0,c['securityEvents']=e[0x5]?.['count']||0x0,MEMORY_CACHE['set']('l1','stats',a,c,0x7530);}catch(f){console['error']('Failed\x20to\x20get\x20system\x20stats:',f);}return c;}async['getUserStats'](a){const b=await this['db']['prepare']('\x0a\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20COUNT(DISTINCT\x20c.id)\x20as\x20total_connections,\x0a\x20\x20\x20\x20\x20\x20\x20\x20COALESCE(SUM(c.bytes_sent),\x200)\x20as\x20bytes_sent,\x0a\x20\x20\x20\x20\x20\x20\x20\x20COALESCE(SUM(c.bytes_received),\x200)\x20as\x20bytes_received,\x0a\x20\x20\x20\x20\x20\x20\x20\x20COALESCE(AVG(c.duration),\x200)\x20as\x20avg_duration\x0a\x20\x20\x20\x20\x20\x20FROM\x20connections\x20c\x0a\x20\x20\x20\x20\x20\x20WHERE\x20c.user_id\x20=\x20?\x0a\x20\x20\x20\x20')['bind'](a)['first']();return b||{'total_connections':0x0,'bytes_sent':0x0,'bytes_received':0x0,'avg_duration':0x0};}async['updateCDNHealth'](a){return this['db']['prepare']('\x0a\x20\x20\x20\x20\x20\x20INSERT\x20OR\x20REPLACE\x20INTO\x20cdn_health\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20provider,\x20endpoint,\x20status,\x20response_time,\x20success_rate,\x0a\x20\x20\x20\x20\x20\x20\x20\x20consecutive_failures,\x20is_available,\x20region,\x20load_score,\x0a\x20\x20\x20\x20\x20\x20\x20\x20last_check\x0a\x20\x20\x20\x20\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20strftime(\x27%s\x27,\x20\x27now\x27))\x0a\x20\x20\x20\x20')['bind'](a['provider'],a['endpoint'],a['status'],a['responseTime']||null,a['successRate']||0x64,a['consecutiveFailures']||0x0,a['isAvailable']?0x1:0x0,a['region']||null,a['loadScore']||0x0)['run']();}async['getCDNHealth'](a=null){let b='SELECT\x20*\x20FROM\x20cdn_health\x20WHERE\x20is_available\x20=\x201';const c=[];a&&(b+='\x20AND\x20provider\x20=\x20?',c['push'](a));b+='\x20ORDER\x20BY\x20load_score\x20ASC,\x20response_time\x20ASC';const d=await this['db']['prepare'](b)['bind'](...c)['all']();return d['results']||[];}async['logMetric'](a,b,c=null){return this['db']['prepare']('\x0a\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20performance_metrics\x20(metric_type,\x20metric_value,\x20metadata)\x0a\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?)\x0a\x20\x20\x20\x20')['bind'](a,b,c?JSON['stringify'](c):null)['run']();}async['logAudit'](a){return this['db']['prepare']('\x0a\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20audit_logs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20user_id,\x20action,\x20resource_type,\x20resource_id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20changes,\x20ip_address,\x20user_agent,\x20success,\x20error_message\x0a\x20\x20\x20\x20\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20\x20\x20')['bind'](a['userId']||null,a['action'],a['resourceType']||null,a['resourceId']||null,a['changes']?JSON['stringify'](a['changes']):null,a['ipAddress']||null,a['userAgent']||null,a['success']?0x1:0x0,a['errorMessage']||null)['run']();}async['cleanup'](a=0x1e){const b=Math['floor'](Date['now']()/0x3e8)-a*0x15180,c=[this['db']['prepare']('DELETE\x20FROM\x20traffic_logs\x20WHERE\x20timestamp\x20<\x20?')['bind'](b),this['db']['prepare']('DELETE\x20FROM\x20security_events\x20WHERE\x20timestamp\x20<\x20?\x20AND\x20severity\x20IN\x20(\x27low\x27,\x20\x27medium\x27)')['bind'](b),this['db']['prepare']('DELETE\x20FROM\x20performance_metrics\x20WHERE\x20timestamp\x20<\x20?')['bind'](b),this['db']['prepare']('DELETE\x20FROM\x20audit_logs\x20WHERE\x20timestamp\x20<\x20?')['bind'](b),this['db']['prepare']('DELETE\x20FROM\x20connections\x20WHERE\x20status\x20=\x20\x27closed\x27\x20AND\x20disconnected_at\x20<\x20?')['bind'](b)];for(const d of c){try{await d['run']();}catch(e){console['error']('Cleanup\x20error:',e);}}return!![];}async['vacuum'](){try{return await this['db']['prepare']('VACUUM')['run'](),await this['db']['prepare']('ANALYZE')['run'](),!![];}catch(a){return console['error']('Vacuum\x20error:',a),![];}}}class VLESSProtocol{constructor(){this['version']=CONFIG['VLESS']['VERSION'];}async['parseHeader'](a){try{const b=new DataView(a);let c=0x0;const d=b['getUint8'](c);c+=0x1;if(d!==this['version'])throw new Error('Unsupported\x20VLESS\x20version:\x20'+d);const e=a['slice'](c,c+0x10),f=Utils['parseUUID'](e);c+=0x10;const g=b['getUint8'](c);c+=0x1;g>0x0&&(c+=g);const h=b['getUint8'](c);c+=0x1;const j=b['getUint16'](c);c+=0x2;const k=b['getUint8'](c);c+=0x1;let l;switch(k){case CONFIG['VLESS']['ADDRESS_TYPE']['IPV4']:{const n=new Uint8Array(a['slice'](c,c+0x4));l=Array['from'](n)['join']('.'),c+=0x4;break;}case CONFIG['VLESS']['ADDRESS_TYPE']['DOMAIN']:{const o=b['getUint8'](c);c+=0x1;const p=new Uint8Array(a['slice'](c,c+o));l=new TextDecoder()['decode'](p),c+=o;break;}case CONFIG['VLESS']['ADDRESS_TYPE']['IPV6']:{const q=new Uint8Array(a['slice'](c,c+0x10)),r=[];for(let s=0x0;s<0x10;s+=0x2){r['push']((q[s]<<0x8|q[s+0x1])['toString'](0x10));}l=r['join'](':'),c+=0x10;break;}default:throw new Error('Unknown\x20address\x20type:\x20'+k);}const m=a['slice'](c);return{'version':d,'uuid':f,'command':h,'port':j,'address':l,'addressType':k,'payload':m,'headerLength':c};}catch(t){console['error']('VLESS\x20header\x20parse\x20error:',t);throw new Error('Failed\x20to\x20parse\x20VLESS\x20header:\x20'+t['message']);}}['createResponse'](a=null){const b=new Uint8Array(0x2);b[0x0]=this['version'],b[0x1]=0x0;if(a){const c=new Uint8Array(b['length']+a['length']);return c['set'](b),c['set'](a,b['length']),c;}return b;}async['validateUUID'](a,b){try{const c=await b['getUser'](a,'uuid');if(!c)return{'valid':![],'reason':'USER_NOT_FOUND'};if(c['status']!=='active')return{'valid':![],'reason':'USER_INACTIVE','status':c['status']};if(c['expiry_date']&&c['expiry_date']<Math['floor'](Date['now']()/0x3e8))return await b['updateUser'](a,{'status':'expired'}),{'valid':![],'reason':'USER_EXPIRED'};if(c['traffic_limit']>0x0&&c['traffic_used']>=c['traffic_limit'])return{'valid':![],'reason':'TRAFFIC_LIMIT_EXCEEDED'};return{'valid':!![],'user':c};}catch(d){return console['error']('UUID\x20validation\x20error:',d),{'valid':![],'reason':'VALIDATION_ERROR'};}}}class TrafficMorpher{constructor(){this['config']=CONFIG['TRAFFIC_MORPHING'];}async['applyJitter'](a){if(!this['config']['JITTER']['ENABLED'])return;const b=this['config']['JITTER']['ADAPTIVE']?this['getAdaptiveJitter']():Utils['getGaussianDelay'](this['config']['JITTER']['MIN_DELAY'],this['config']['JITTER']['MAX_DELAY']);b>0x0&&await Utils['sleep'](b);}['getAdaptiveJitter'](){const a=new Date()['getHours'](),b=a>=0x12&&a<=0x17,c=this['config']['JITTER']['MIN_DELAY'],d=this['config']['JITTER']['MAX_DELAY']-c,e=b?0.6:0.4;return Math['floor'](c+d*e*Math['random']());}['addPadding'](a){if(!this['config']['PADDING']['ENABLED'])return a;const b=Math['floor'](Math['random']()*(this['config']['PADDING']['MAX_BYTES']-this['config']['PADDING']['MIN_BYTES'])+this['config']['PADDING']['MIN_BYTES']),c=this['config']['PADDING']['RANDOM_PATTERN']?Utils['getRandomBytes'](b):new Uint8Array(b)['fill'](0x0),d=new Uint8Array(a['length']+b+0x2);return d[0x0]=b>>0x8&0xff,d[0x1]=b&0xff,d['set'](c,0x2),d['set'](new Uint8Array(a),b+0x2),d['buffer'];}['removePadding'](a){if(!this['config']['PADDING']['ENABLED'])return a;try{const b=new DataView(a),c=b['getUint16'](0x0);if(c>a['byteLength']-0x2)return a;return a['slice'](c+0x2);}catch(d){return a;}}async['fragmentPacket'](a,b,c){if(!this['config']['FRAGMENTATION']['ENABLED'])return[a];const d=[],e=new Uint8Array(a);let f=0x0;while(f<e['length']){const g=this['config']['FRAGMENTATION']['ENTROPY_BASED']?this['getEntropyBasedSize'](b||this['config']['FRAGMENTATION']['MIN_SIZE'],c||this['config']['FRAGMENTATION']['MAX_SIZE']):Math['floor'](Math['random']()*(c-b)+b),h=Math['min'](f+g,e['length']);d['push'](e['slice'](f,h)['buffer']),f=h;if(this['config']['FRAGMENTATION']['INTER_FRAGMENT_DELAY']&&f<e['length']){const [i,j]=this['config']['FRAGMENTATION']['DELAY_RANGE'];await Utils['sleep'](Math['floor'](Math['random']()*(j-i)+i));}}return this['config']['FRAGMENTATION']['RANDOM_ORDER']&&d['length']>0x1&&d['sort'](()=>Math['random']()-0.5),d;}['getEntropyBasedSize'](a,b){const c=Utils['getRandomBytes'](0x1)[0x0]/0xff,d=b-a;return Math['floor'](a+d*c);}async['mimicProtocol'](a,b){if(!this['config']['MIMICRY']['ENABLED'])return a;switch(b){case'https':return this['addHTTPSHeaders'](a);case'http2':return this['addHTTP2Frames'](a);case'websocket':return this['addWebSocketFrames'](a);default:return a;}}['addHTTPSHeaders'](a){const b=new TextEncoder()['encode']('GET\x20/\x20HTTP/1.1\x0d\x0a'+('Host:\x20'+this['getRandomDomain']()+'\x0d\x0a')+('User-Agent:\x20'+this['getRandomUserAgent']()+'\x0d\x0a')+'Accept:\x20*/*\x0d\x0a'+'Connection:\x20keep-alive\x0d\x0a\x0d\x0a'),c=new Uint8Array(b['length']+a['byteLength']);return c['set'](b),c['set'](new Uint8Array(a),b['length']),c['buffer'];}['addHTTP2Frames'](a){const b=new Uint8Array(0x9),c=new Uint8Array(a);b[0x0]=c['length']>>0x10&0xff,b[0x1]=c['length']>>0x8&0xff,b[0x2]=c['length']&0xff,b[0x3]=0x0,b[0x4]=0x0;const d=Math['floor'](Math['random']()*0x7fffffff);b[0x5]=d>>0x18&0xff,b[0x6]=d>>0x10&0xff,b[0x7]=d>>0x8&0xff,b[0x8]=d&0xff;const e=new Uint8Array(b['length']+c['length']);return e['set'](b),e['set'](c,b['length']),e['buffer'];}['addWebSocketFrames'](a){const b=new Uint8Array(a),c=new Uint8Array(0x2+(b['length']>0x7d?0x2:0x0));c[0x0]=0x82;b['length']<=0x7d?c[0x1]=0x80|b['length']:(c[0x1]=0xfe,c[0x2]=b['length']>>0x8&0xff,c[0x3]=b['length']&0xff);const d=Utils['getRandomBytes'](0x4),e=new Uint8Array(c['length']+d['length']+b['length']);e['set'](c),e['set'](d,c['length']);for(let f=0x0;f<b['length'];f++){e[c['length']+d['length']+f]=b[f]^d[f%0x4];}return e['buffer'];}['getRandomDomain'](){const a=CONFIG['ANTI_CENSORSHIP']['DOMAIN_FRONTING']['CDN_FRONTS'];return a[Math['floor'](Math['random']()*a['length'])];}['getRandomUserAgent'](){const a=['Mozilla/5.0\x20(Windows\x20NT\x2010.0;\x20Win64;\x20x64)\x20AppleWebKit/537.36','Mozilla/5.0\x20(Macintosh;\x20Intel\x20Mac\x20OS\x20X\x2010_15_7)\x20AppleWebKit/537.36','Mozilla/5.0\x20(X11;\x20Linux\x20x86_64)\x20AppleWebKit/537.36','Mozilla/5.0\x20(iPhone;\x20CPU\x20iPhone\x20OS\x2015_0\x20like\x20Mac\x20OS\x20X)\x20AppleWebKit/605.1.15'];return a[Math['floor'](Math['random']()*a['length'])]+('\x20Chrome/'+(Math['floor'](Math['random']()*0x14)+0x5a)+'.0.'+Math['floor'](Math['random']()*0x1388)+'.'+Math['floor'](Math['random']()*0xc8)+'\x20Safari/537.36');}}class ProtocolObfuscator{constructor(){this['config']=CONFIG['SECURITY']['ENCRYPTION'],this['xorKey']=this['generateXORKey'](),this['lastKeyRotation']=Date['now']();}['generateXORKey'](){return Utils['getRandomBytes'](0x20);}async['rotateKeysIfNeeded'](){Date['now']()-this['lastKeyRotation']>this['config']['KEY_ROTATION_INTERVAL']&&(this['xorKey']=this['generateXORKey'](),this['lastKeyRotation']=Date['now']());}async['obfuscate'](a){if(!this['config']['ENABLED'])return a;await this['rotateKeysIfNeeded']();let b=a;return this['config']['MULTI_LAYER']?(b=this['xorObfuscate'](b),b=await this['aesGCMEncrypt'](b)):b=await this['aesGCMEncrypt'](b),b;}async['deobfuscate'](a){if(!this['config']['ENABLED'])return a;let b=a;return this['config']['MULTI_LAYER']?(b=await this['aesGCMDecrypt'](b),b=this['xorObfuscate'](b)):b=await this['aesGCMDecrypt'](b),b;}['xorObfuscate'](a){const b=new Uint8Array(a),c=new Uint8Array(b['length']);for(let d=0x0;d<b['length'];d++){c[d]=b[d]^this['xorKey'][d%this['xorKey']['length']];}return c['buffer'];}async['aesGCMEncrypt'](a){try{const b=Utils['getRandomBytes'](this['config']['IV_LENGTH']),c=await crypto['subtle']['importKey']('raw',this['xorKey'],{'name':'AES-GCM'},![],['encrypt']),d=await crypto['subtle']['encrypt']({'name':'AES-GCM','iv':b,'tagLength':this['config']['AUTH_TAG_LENGTH']*0x8},c,a),e=new Uint8Array(b['length']+d['byteLength']);return e['set'](b),e['set'](new Uint8Array(d),b['length']),e['buffer'];}catch(f){return console['error']('AES-GCM\x20encryption\x20error:',f),a;}}async['aesGCMDecrypt'](a){try{const b=new Uint8Array(a),c=b['slice'](0x0,this['config']['IV_LENGTH']),d=b['slice'](this['config']['IV_LENGTH']),e=await crypto['subtle']['importKey']('raw',this['xorKey'],{'name':'AES-GCM'},![],['decrypt']),f=await crypto['subtle']['decrypt']({'name':'AES-GCM','iv':c,'tagLength':this['config']['AUTH_TAG_LENGTH']*0x8},e,d);return f;}catch(g){return console['error']('AES-GCM\x20decryption\x20error:',g),a;}}}class AISNIHunter{constructor(a,b){this['ai']=a,this['db']=b,this['config']=CONFIG['AI']['SNI_DISCOVERY'];}async['discoverOptimalSNIs'](a){if(!this['config']['ENABLED'])return[];try{console['log']('ðŸ”\x20Starting\x20AI\x20SNI\x20discovery\x20for\x20'+a['country']+'/'+a['asn']);const b=await this['getAIRecommendations'](a),c=await this['testDomainsInBatch'](b,a),d=c['filter'](e=>e['score']>=this['config']['MIN_STABILITY_SCORE']&&e['latency']<=this['config']['MAX_LATENCY'])['sort']((e,f)=>f['score']-e['score'])['slice'](0x0,0x14);for(const e of d){await this['db']['saveSNI'](e);}return console['log']('âœ…\x20Discovered\x20'+d['length']+'\x20optimal\x20SNIs'),d;}catch(f){return console['error']('AI\x20SNI\x20discovery\x20error:',f),[];}}async['getAIRecommendations'](a){try{const b='You\x20are\x20an\x20expert\x20network\x20engineer.\x20Suggest\x2030\x20highly\x20reliable\x20domain\x20names\x20for\x20SNI\x20(Server\x20Name\x20Indication)\x20that\x20are:\x0a1.\x20Hosted\x20on\x20major\x20CDN\x20providers\x20(Cloudflare,\x20Akamai,\x20Fastly,\x20AWS\x20CloudFront)\x0a2.\x20Have\x20global\x20presence\x20and\x20low\x20latency\x0a3.\x20Suitable\x20for\x20'+a['country']+'\x20region\x20('+a['asn']+')\x0a4.\x20Support\x20modern\x20TLS\x20(1.2+)\x0a5.\x20Highly\x20available\x20and\x20stable\x0a6.\x20Popular\x20services\x20that\x20are\x20unlikely\x20to\x20be\x20blocked\x0a\x0aFocus\x20on:\x20cloud\x20services,\x20CDN\x20endpoints,\x20major\x20tech\x20companies,\x20popular\x20SaaS\x20platforms.\x0aReturn\x20ONLY\x20a\x20JSON\x20array\x20of\x20domain\x20names,\x20no\x20explanations:\x20[\x22domain1.com\x22,\x20\x22domain2.com\x22,\x20...]',c=await this['ai']['run']('@cf/meta/llama-3.1-8b-instruct',{'messages':[{'role':'user','content':b}],'max_tokens':0x400,'temperature':0.7}),d=c['response']||'',e=d['match'](/\[.*?\]/s);if(e){const f=JSON['parse'](e[0x0]);return f['filter'](g=>typeof g==='string'&&g['length']>0x0);}return this['config']['TEST_ENDPOINTS'];}catch(g){return console['error']('AI\x20recommendation\x20error:',g),this['config']['TEST_ENDPOINTS'];}}async['testDomainsInBatch'](a,b){const c=[],d=this['config']['CONCURRENT_TESTS'];for(let e=0x0;e<a['length'];e+=d){const f=a['slice'](e,e+d),g=await Promise['all'](f['map'](h=>this['testSNI'](h,b)));c['push'](...g['filter'](h=>h!==null)),e+d<a['length']&&await Utils['sleep'](0x1f4);}return c;}async['testSNI'](a,b){const c=[];let d=0x0,e='unknown',f='unknown';for(let k=0x0;k<this['config']['TEST_RETRIES'];k++){try{const l=Date['now'](),m=await fetch('https://'+a,{'method':'HEAD','headers':{'User-Agent':'Mozilla/5.0\x20(Windows\x20NT\x2010.0;\x20Win64;\x20x64)\x20AppleWebKit/537.36'},'signal':AbortSignal['timeout'](0x1388)}),n=Date['now']()-l;c['push'](n);if(m['ok']||m['status']===0x12d||m['status']===0x12e){d++;const o=m['headers']['get']('server')||'',p=m['headers']['get']('cf-ray'),q=m['headers']['get']('x-cache')||'';if(p)f='cloudflare';else{if(o['includes']('cloudfront'))f='cloudfront';else{if(q['includes']('akamai'))f='akamai';else{if(o['includes']('fastly'))f='fastly';}}}}}catch(r){}k<this['config']['TEST_RETRIES']-0x1&&await Utils['sleep'](0xc8);}if(c['length']===0x0)return this['config']['BLACKLIST_ON_FAILURE']&&await this['db']['blacklistSNI'](a,'Failed\x20all\x20connection\x20attempts'),null;c['sort']((s,t)=>s-t);const g=c[Math['floor'](c['length']/0x2)],h=d/this['config']['TEST_RETRIES']*0x64,i=Math['max'](0x0,0x64-g/this['config']['MAX_LATENCY']*0x64),j=Math['floor'](i*0.3+h*0.4+(f!=='unknown'?0x14:0x0)+(e['includes']('1.3')?0xa:0x0));return{'domain':a,'provider':f,'asn':b['asn'],'countryCode':b['country'],'stabilityScore':j,'avgLatency':g,'successRate':h,'testCount':this['config']['TEST_RETRIES'],'isActive':j>=this['config']['MIN_STABILITY_SCORE'],'cdnType':f,'tlsVersion':e};}async['getOptimalSNI'](a){const b='sni:optimal:'+a['country']+':'+a['asn'],c=MEMORY_CACHE['get']('l2',b);if(c)return c;const d=await this['db']['getOptimalSNIs']({'countryCode':a['country'],'minScore':this['config']['MIN_STABILITY_SCORE'],'limit':0xa});if(d['length']>0x0){const e=d[Math['floor'](Math['random']()*Math['min'](0x5,d['length']))];return MEMORY_CACHE['set']('l2','routes',b,e['domain'],0x493e0),e['domain'];}return this['discoverOptimalSNIs'](a)['catch'](console['error']),this['config']['TEST_ENDPOINTS'][0x0];}}class CDNFailoverManager{constructor(a){this['db']=a,this['config']=CONFIG['CDN'],this['currentProviderIndex']=0x0,this['providerHealth']=new Map(),this['circuitBreakers']=new Map();}async['startHealthChecks'](){if(!this['config']['FAILOVER']['ENABLED'])return;setInterval(()=>{this['checkAllProviders']()['catch'](console['error']);},this['config']['FAILOVER']['HEALTH_CHECK_INTERVAL']),await this['checkAllProviders']();}async['checkAllProviders'](){const a=this['config']['PROVIDERS']['map'](c=>this['checkProvider'](c)),b=await Promise['allSettled'](a);b['forEach']((c,d)=>{if(c['status']==='fulfilled'){const e=this['config']['PROVIDERS'][d];this['providerHealth']['set'](e['name'],c['value']);}});}async['checkProvider'](a){const b=this['getCircuitBreaker'](a['name']);if(b['state']==='open'){if(Date['now']()-b['openedAt']>this['config']['FAILOVER']['CIRCUIT_BREAKER']['TIMEOUT'])b['state']='half-open',b['failureCount']=0x0;else return{'status':'down','isAvailable':![],'responseTime':null,'consecutiveFailures':b['failureCount']};}try{const c=Date['now'](),d=await fetch('https://'+a['endpoint'],{'method':'HEAD','signal':AbortSignal['timeout'](this['config']['FAILOVER']['TIMEOUT'])}),e=Date['now']()-c,f=d['ok']&&e<this['config']['FAILOVER']['TIMEOUT'];f?(b['failureCount']=0x0,b['state']==='half-open'&&(b['state']='closed')):this['recordFailure'](a['name']);const g={'provider':a['name'],'endpoint':a['endpoint'],'status':f?'healthy':'degraded','responseTime':e,'isAvailable':f,'consecutiveFailures':b['failureCount']};return await this['db']['updateCDNHealth'](g),g;}catch(h){return this['recordFailure'](a['name']),{'provider':a['name'],'endpoint':a['endpoint'],'status':'down','responseTime':null,'isAvailable':![],'consecutiveFailures':this['getCircuitBreaker'](a['name'])['failureCount']};}}['getCircuitBreaker'](a){return!this['circuitBreakers']['has'](a)&&this['circuitBreakers']['set'](a,{'state':'closed','failureCount':0x0,'openedAt':null}),this['circuitBreakers']['get'](a);}['recordFailure'](a){const b=this['getCircuitBreaker'](a);b['failureCount']++,b['failureCount']>=this['config']['FAILOVER']['CIRCUIT_BREAKER']['FAILURE_THRESHOLD']&&(b['state']='open',b['openedAt']=Date['now'](),console['warn']('âš ï¸\x20Circuit\x20breaker\x20OPEN\x20for\x20'+a));}async['getBestProvider'](a={}){const b=this['config']['PROVIDERS']['filter'](c=>{const d=this['providerHealth']['get'](c['name']),e=this['getCircuitBreaker'](c['name']);return d?.['isAvailable']&&e['state']!=='open';});if(b['length']===0x0)return console['warn']('âš ï¸\x20All\x20CDN\x20providers\x20unavailable,\x20using\x20fallback'),this['config']['PROVIDERS'][0x0];if(this['config']['LOAD_BALANCING']['GEO_AWARENESS']&&a['country']){const c=b['filter'](d=>!d['regions']||d['regions']['includes']('global')||this['matchesRegion'](a['country'],d['regions']));if(c['length']>0x0)return this['selectWeightedProvider'](c);}return this['selectWeightedProvider'](b);}['selectWeightedProvider'](a){const b=a['reduce']((d,e)=>d+e['weight'],0x0);let c=Math['random']()*b;for(const d of a){c-=d['weight'];if(c<=0x0)return d;}return a[0x0];}['matchesRegion'](a,b){const c={'us':['US','CA','MX'],'eu':['GB','FR','DE','IT','ES','NL','BE','SE','NO','FI','DK','PL'],'asia':['CN','JP','KR','IN','SG','TH','VN','ID','MY','PH','IR']};return b['some'](d=>c[d]?.['includes'](a)||d==='global');}}class HoneypotSystem{constructor(a){this['db']=a,this['config']=CONFIG['SECURITY']['HONEYPOT'],this['suspiciousIPs']=new Map();}['isScannerDetected'](a){if(!this['config']['ENABLED'])return![];const b=a['userAgent']['toLowerCase']();for(const d of this['config']['SCANNER_PATTERNS']){if(d['test'](b))return!![];}const c=this['calculateSuspicionScore'](a);return c>=0x3c;}['calculateSuspicionScore'](a){let b=0x0;(!a['userAgent']||a['userAgent']==='unknown')&&(b+=0x1e);this['config']['SCANNER_PATTERNS']['some'](d=>d['test'](a['userAgent']))&&(b+=0x28);const c=this['suspiciousIPs']['get'](a['ip']);return c&&(b+=Math['min'](c['failedAttempts']*0xa,0x1e)),this['config']['FAKE_PORTS']['includes'](parseInt(a['port']))&&(b+=0x14),b;}async['handleScanner'](a,b){console['log']('ðŸ¯\x20Honeypot\x20triggered:\x20'+a['ip']+'\x20/\x20'+a['userAgent']),await this['db']['logSecurityEvent']({'eventType':'scanner_detected','severity':'high','ipAddress':a['ip'],'userAgent':a['userAgent'],'details':JSON['stringify']({'country':a['country'],'asn':a['asn'],'ray':a['ray']}),'responseAction':'honeypot','threatScore':0x50,'blocked':!![]});const c=this['suspiciousIPs']['get'](a['ip'])||{'firstSeen':Date['now'](),'failedAttempts':0x0,'banned':![]};c['failedAttempts']++,this['suspiciousIPs']['set'](a['ip'],c);this['config']['AUTO_BAN']&&c['failedAttempts']>=this['config']['BAN_THRESHOLD']&&(c['banned']=!![],console['log']('ðŸš«\x20Auto-banned:\x20'+a['ip']));if(this['config']['FAKE_PORTAL'])return await Utils['sleep'](this['config']['FAKE_PORTAL_DELAY']),this['generateFakePortal'](b);const d=this['config']['REDIRECT_URLS'][Math['floor'](Math['random']()*this['config']['REDIRECT_URLS']['length'])];return Response['redirect'](d,0x12e);}['generateFakePortal'](a){const b='<!DOCTYPE\x20html>\x0a<html>\x0a<head>\x0a\x20\x20<title>Login\x20Required</title>\x0a\x20\x20<style>\x0a\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20height:\x20100vh;\x0a\x20\x20\x20\x20\x20\x20margin:\x200;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#667eea\x200%,\x20#764ba2\x20100%);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.login-box\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20padding:\x2040px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2010px;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x2010px\x2040px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20width:\x20300px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20h2\x20{\x20text-align:\x20center;\x20color:\x20#333;\x20margin-bottom:\x2030px;\x20}\x0a\x20\x20\x20\x20input\x20{\x0a\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20padding:\x2012px;\x0a\x20\x20\x20\x20\x20\x20margin:\x2010px\x200;\x0a\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ddd;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x205px;\x0a\x20\x20\x20\x20\x20\x20box-sizing:\x20border-box;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20button\x20{\x0a\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20padding:\x2012px;\x0a\x20\x20\x20\x20\x20\x20background:\x20#667eea;\x0a\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x205px;\x0a\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20button:hover\x20{\x20background:\x20#5568d3;\x20}\x0a\x20\x20\x20\x20.error\x20{\x0a\x20\x20\x20\x20\x20\x20color:\x20#dc3545;\x0a\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20margin-top:\x2010px;\x0a\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20}\x0a\x20\x20</style>\x0a</head>\x0a<body>\x0a\x20\x20<div\x20class=\x22login-box\x22>\x0a\x20\x20\x20\x20<h2>ðŸ”\x20Secure\x20Login</h2>\x0a\x20\x20\x20\x20<form\x20id=\x22loginForm\x22\x20action=\x22/login\x22\x20method=\x22POST\x22>\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20name=\x22username\x22\x20placeholder=\x22Username\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22password\x22\x20name=\x22password\x22\x20placeholder=\x22Password\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22>Login</button>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22error\x22\x20id=\x22error\x22>Invalid\x20credentials</div>\x0a\x20\x20\x20\x20</form>\x0a\x20\x20</div>\x0a\x20\x20<script>\x0a\x20\x20\x20\x20document.getElementById(\x27loginForm\x27).addEventListener(\x27submit\x27,\x20function(e)\x20{\x0a\x20\x20\x20\x20\x20\x20e.preventDefault();\x0a\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20document.getElementById(\x27error\x27).style.display\x20=\x20\x27block\x27;\x0a\x20\x20\x20\x20\x20\x20},\x201000);\x0a\x20\x20\x20\x20});\x0a\x20\x20</script>\x0a</body>\x0a</html>';return new Response(b,{'status':0xc8,'headers':{'Content-Type':'text/html','Server':this['config']['DECEPTION_RESPONSES']['http'],'X-Powered-By':'PHP/7.4.3'}});}['isIPBanned'](a){const b=this['suspiciousIPs']['get'](a);return b?.['banned']||![];}async['logFakeCredentials'](a,b,c){if(!this['config']['CREDENTIAL_LOG'])return;await this['db']['logSecurityEvent']({'eventType':'honeypot_credentials','severity':'medium','ipAddress':c['ip'],'userAgent':c['userAgent'],'details':JSON['stringify']({'username':a,'password':b['substring'](0x0,0x3)+'***','country':c['country']}),'responseAction':'logged','threatScore':0x32});}}class TelegramBot{constructor(a){this['db']=a,this['config']=CONFIG['TELEGRAM'],this['lastCommandTime']=new Map();}async['handleWebhook'](a){if(!this['config']['ENABLED']||!this['config']['BOT_TOKEN'])return new Response('Telegram\x20bot\x20not\x20configured',{'status':0xc8});try{const b=await a['json']();if(b['message'])await this['handleMessage'](b['message']);else b['callback_query']&&await this['handleCallback'](b['callback_query']);return new Response('OK',{'status':0xc8});}catch(c){return console['error']('Telegram\x20webhook\x20error:',c),new Response('Error',{'status':0x1f4});}}async['handleMessage'](a){const b=a['chat']['id'],c=a['from']['id'],d=a['text']||'';if(!this['config']['ADMIN_IDS']['includes'](c)){await this['sendMessage'](b,'â›”\x20Unauthorized.\x20This\x20bot\x20is\x20for\x20admins\x20only.');return;}if(!this['checkRateLimit'](c)){await this['sendMessage'](b,'â±ï¸\x20Too\x20many\x20commands.\x20Please\x20wait\x20a\x20moment.');return;}d['startsWith']('/')&&await this['handleCommand'](b,d);}['checkRateLimit'](a){const b=Date['now'](),c=this['lastCommandTime']['get'](a)||0x0;if(b-c<0xea60/this['config']['RATE_LIMIT'])return![];return this['lastCommandTime']['set'](a,b),!![];}async['handleCommand'](a,b){const [c,...d]=b['split']('\x20');switch(c){case this['config']['COMMANDS']['START']:await this['commandStart'](a);break;case this['config']['COMMANDS']['HELP']:await this['commandHelp'](a);break;case this['config']['COMMANDS']['STATUS']:await this['commandStatus'](a);break;case this['config']['COMMANDS']['STATS']:await this['commandStats'](a);break;case this['config']['COMMANDS']['USERS']:await this['commandUsers'](a,d);break;case this['config']['COMMANDS']['SCAN']:await this['commandScan'](a);break;case this['config']['COMMANDS']['OPTIMIZE']:await this['commandOptimize'](a);break;case this['config']['COMMANDS']['RESTART']:await this['commandRestart'](a);break;case this['config']['COMMANDS']['BACKUP']:await this['commandBackup'](a);break;default:await this['sendMessage'](a,'â“\x20Unknown\x20command:\x20'+c+'\x0aUse\x20/help\x20for\x20available\x20commands.');}}async['commandStart'](a){const b='\x0aðŸš€\x20*Quantum\x20VLESS\x20Admin\x20Bot\x20v'+CONFIG['VERSION']+'*\x0a\x0aWelcome\x20to\x20the\x20admin\x20control\x20panel!\x0aUse\x20/help\x20to\x20see\x20available\x20commands.\x0a\x0a*System\x20Status:*\x20ðŸŸ¢\x20Online\x0a*Build:*\x20'+CONFIG['BUILD_DATE']+'\x0a';await this['sendMessage'](a,b,{'parse_mode':'Markdown'});}async['commandHelp'](a){const b='\x0aðŸ“š\x20*Available\x20Commands:*\x0a\x0a*Basic:*\x0a/start\x20-\x20Start\x20bot\x0a/help\x20-\x20Show\x20this\x20help\x0a/status\x20-\x20System\x20status\x0a/stats\x20-\x20Statistics\x0a\x0a*Management:*\x0a/users\x20-\x20List\x20users\x0a/scan\x20-\x20Run\x20SNI\x20scan\x0a/optimize\x20-\x20Optimize\x20system\x0a/restart\x20-\x20Restart\x20services\x0a/backup\x20-\x20Create\x20backup\x0a\x0a*Format:*\x0a'/users<limit>'\x20-\x20List\x20users\x20(default:\x2010)\x0a';await this['sendMessage'](a,b,{'parse_mode':'Markdown'});}async['commandStatus'](a){try{const b=await this['db']['getSystemStats'](),c=MEMORY_CACHE['stats'],d='\x0aðŸ“Š\x20*System\x20Status*\x0a\x0a*Users:*\x0aâ€¢\x20Total:\x20'+b['totalUsers']+'\x0aâ€¢\x20Active:\x20'+b['activeUsers']+'\x0a\x0a*Connections:*\x0aâ€¢\x20Total:\x20'+b['totalConnections']+'\x0aâ€¢\x20Active:\x20'+b['activeConnections']+'\x0a\x0a*Traffic:*\x0aâ€¢\x20Total:\x20'+Utils['formatBytes'](b['totalTraffic'])+'\x0a\x0a*Security:*\x0aâ€¢\x20Events\x20(24h):\x20'+b['securityEvents']+'\x0a\x0a*Cache:*\x0aâ€¢\x20Hits:\x20'+c['hits']+'\x0aâ€¢\x20Misses:\x20'+c['misses']+'\x0aâ€¢\x20Hit\x20Rate:\x20'+(c['hits']>0x0?(c['hits']/(c['hits']+c['misses'])*0x64)['toFixed'](0x1):0x0)+'%\x0a\x0a*System:*\x0aâ€¢\x20Version:\x20'+CONFIG['VERSION']+'\x0aâ€¢\x20Uptime:\x20Online\x0a';await this['sendMessage'](a,d,{'parse_mode':'Markdown'});}catch(e){await this['sendMessage'](a,'âŒ\x20Failed\x20to\x20get\x20status:\x20'+e['message']);}}async['commandStats'](a){try{const b=await this['db']['getSystemStats'](),c='\x0aðŸ“ˆ\x20*Detailed\x20Statistics*\x0a\x0a*Traffic\x20Analysis:*\x0aâ€¢\x20Total\x20Used:\x20'+Utils['formatBytes'](b['totalTraffic'])+'\x0aâ€¢\x20Avg\x20per\x20User:\x20'+(b['totalUsers']>0x0?Utils['formatBytes'](b['totalTraffic']/b['totalUsers']):'0\x20B')+'\x0a\x0a*Connection\x20Stats:*\x0aâ€¢\x20Total\x20Connections:\x20'+b['totalConnections']+'\x0aâ€¢\x20Active:\x20'+b['activeConnections']+'\x0aâ€¢\x20Success\x20Rate:\x20'+(b['totalConnections']>0x0?(b['activeConnections']/b['totalConnections']*0x64)['toFixed'](0x1):0x64)+'%\x0a\x0a*Security\x20Events\x20(24h):*\x0aâ€¢\x20Total:\x20'+b['securityEvents']+'\x0aâ€¢\x20Status:\x20'+(b['securityEvents']>0x32?'âš ï¸\x20High':'âœ…\x20Normal')+'\x0a';await this['sendMessage'](a,c,{'parse_mode':'Markdown'});}catch(d){await this['sendMessage'](a,'âŒ\x20Failed\x20to\x20get\x20stats:\x20'+d['message']);}}async['commandUsers'](a,b){try{const c=parseInt(b[0x0])||0xa,d=await this['db']['listUsers']({'limit':c,'status':'active'});if(d['length']===0x0){await this['sendMessage'](a,'ðŸ“\x20No\x20active\x20users\x20found.');return;}let e='ðŸ‘¥\x20*Active\x20Users\x20('+d['length']+'):*\x0a\x0a';for(const f of d){const g=Utils['formatBytes'](f['traffic_used'])+'/'+Utils['formatBytes'](f['traffic_limit']);e+='â€¢\x20*'+Utils['escapeHtml'](f['username'])+'*\x0a',e+='\x20\x20UUID:\x20'+f['uuid']+'\x0a',e+='\x20\x20Traffic:\x20'+g+'\x0a',e+='\x20\x20Connections:\x20'+(f['connection_count']||0x0)+'\x0a\x0a';}await this['sendMessage'](a,e,{'parse_mode':'Markdown'});}catch(h){await this['sendMessage'](a,'âŒ\x20Failed\x20to\x20list\x20users:\x20'+h['message']);}}async['commandScan'](a){await this['sendMessage'](a,'ðŸ”\x20Starting\x20SNI\x20discovery\x20scan...');try{await this['sendMessage'](a,'âœ…\x20SNI\x20scan\x20scheduled.\x20Results\x20will\x20be\x20available\x20shortly.');}catch(b){await this['sendMessage'](a,'âŒ\x20Scan\x20failed:\x20'+b['message']);}}async['commandOptimize'](a){await this['sendMessage'](a,'âš™ï¸\x20Running\x20system\x20optimization...');try{MEMORY_CACHE['clear']('l1'),await this['db']['cleanup'](0x1e),await this['sendMessage'](a,'âœ…\x20Optimization\x20complete:\x0aâ€¢\x20Cache\x20cleared\x0aâ€¢\x20Database\x20cleaned');}catch(b){await this['sendMessage'](a,'âŒ\x20Optimization\x20failed:\x20'+b['message']);}}async['commandRestart'](a){await this['sendMessage'](a,'ðŸ”„\x20Restart\x20command\x20received.\x20Note:\x20Worker\x20restart\x20requires\x20deployment.');}async['commandBackup'](a){await this['sendMessage'](a,'ðŸ’¾\x20Backup\x20feature\x20not\x20available\x20in\x20Workers\x20environment.');}async['handleCallback'](a){const b=a['message']['chat']['id'],c=a['data'];await this['answerCallback'](a['id']);}async['sendMessage'](a,b,c={}){if(!this['config']['BOT_TOKEN'])return;try{const d='https://api.telegram.org/bot'+this['config']['BOT_TOKEN']+'/sendMessage',e=await fetch(d,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'chat_id':a,'text':b,...c})});return await e['json']();}catch(f){console['error']('Telegram\x20send\x20message\x20error:',f);}}async['answerCallback'](a,b=null){if(!this['config']['BOT_TOKEN'])return;try{const c='https://api.telegram.org/bot'+this['config']['BOT_TOKEN']+'/answerCallbackQuery';await fetch(c,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'callback_query_id':a,'text':b||'Processing...'})});}catch(d){console['error']('Telegram\x20answer\x20callback\x20error:',d);}}async['sendNotification'](a,b='info'){if(!this['config']['NOTIFICATIONS']['ENABLED'])return;const c={'info':'â„¹ï¸','warning':'âš ï¸','error':'âŒ','critical':'ðŸš¨'};for(const d of this['config']['ADMIN_IDS']){await this['sendMessage'](d,(c[b]||'â„¹ï¸')+'\x20'+a);}}}class AIOrchestrator{constructor(a,b){this['env']=a,this['config']=b||CONFIG['AI'],this['ai']=a['AI'],this['models']=this['config']['MODELS'],this['stats']={'DEEPSEEK':{'requests':0x0,'successes':0x0,'failures':0x0,'totalLatency':0x0,'totalTokens':0x0},'LLAMA':{'requests':0x0,'successes':0x0,'failures':0x0,'totalLatency':0x0,'totalTokens':0x0},'FALLBACK':{'requests':0x0,'successes':0x0,'failures':0x0,'totalLatency':0x0,'totalTokens':0x0}},this['cache']=new Map(),this['cacheHits']=0x0,this['cacheMisses']=0x0,this['taskSuccessRates']=new Map();}async['execute'](a,b,c={}){if(!this['config']['ENABLED']||!this['ai'])throw new Error('AI\x20not\x20available');if(this['config']['CACHE']['ENABLED']){const e=this['getCachedResponse'](a,b);if(e)return this['cacheHits']++,{...e,'fromCache':!![]};this['cacheMisses']++;}const d=this['selectModel'](a);console['log']('Selected\x20model:',d['name'],'for\x20task:',a);try{const f=await this['executeWithModel'](d,b,c);return this['recordSuccess'](d['name'],f['latency'],f['tokens']),this['config']['CACHE']['ENABLED']&&this['cacheResponse'](a,b,f),f;}catch(g){this['recordFailure'](d['name']);const h=this['getFallbackModel'](d['name']);if(h){console['log']('Trying\x20fallback:',h['name']);const i=await this['executeWithModel'](h,b,c);return this['recordSuccess'](h['name'],i['latency'],i['tokens']),{...i,'usedFallback':!![]};}throw g;}}['selectModel'](a){const b=this['config']['TASK_ROUTING'][a];if(b){const c=this['models'][b['primary']];if(c&&c['enabled'])return c;}return this['intelligentRouting'](a);}['intelligentRouting'](a){const b=this['config']['INTELLIGENT_ROUTING']['SCORING_WEIGHTS'];let c=null,d=-0x1;for(const [e,f]of Object['entries'](this['models'])){if(!f['enabled']||e==='FALLBACK')continue;let g=0x0;g+=this['calculateSpecializationScore'](f,a)*b['specialization'],g+=(0x1-f['averageLatency']/0x7d0)*b['latency'],g+=f['reliability']*b['reliability'],g+=(0x1-f['costPerRequest']/0.002)*b['cost'],g>d&&(d=g,c=f);}return c||this['getDefaultModel']();}['calculateSpecializationScore'](a,b){if(!a['specialization'])return 0.5;if(a['specialization']['includes'](b))return 0x1;const c=b['toLowerCase']()['split']('-');let d=0x0;for(const e of a['specialization']){const f=e['toLowerCase']()['split']('-');for(const g of c){if(f['includes'](g))d++;}}return d>0x0?0.7+d*0.1:0.3;}['getDefaultModel'](){return Object['values'](this['models'])['filter'](a=>a['enabled'])['sort']((c,d)=>c['priority']-d['priority'])[0x0]||this['models']['FALLBACK'];}['getFallbackModel'](a){for(const b of Object['values'](this['config']['TASK_ROUTING'])){if(this['models'][b['primary']]?.['name']===a){const c=this['models'][b['fallback']];if(c?.['enabled'])return c;}}return this['models']['FALLBACK']?.['enabled']?this['models']['FALLBACK']:null;}async['executeWithModel'](a,b,c={}){const d=Date['now'](),e=[{'role':'user','content':b}];c['systemMessage']&&e['unshift']({'role':'system','content':c['systemMessage']});const f=await this['ai']['run'](a['id'],{'messages':e,'max_tokens':c['maxTokens']||a['maxTokens'],'temperature':c['temperature']!==undefined?c['temperature']:a['temperature'],'top_p':c['topP']!==undefined?c['topP']:a['topP']}),g=Date['now']()-d;let h=f['response']||f['content']||'';return Array['isArray'](f)&&(h=f['map'](j=>j['text']||j['content']||'')['join']('')),{'text':h,'model':a['name'],'modelId':a['id'],'latency':g,'tokens':Math['ceil'](h['length']/0x4),'timestamp':Date['now']()};}['getCachedResponse'](a,b){const c=this['generateCacheKey'](a,b),d=this['cache']['get'](c);if(d&&Date['now']()-d['timestamp']<this['config']['CACHE']['TTL'])return d;if(d)this['cache']['delete'](c);return null;}['cacheResponse'](a,b,c){const d=this['generateCacheKey'](a,b);this['cache']['set'](d,{...c,'cachedAt':Date['now']()});if(this['cache']['size']>this['config']['CACHE']['MAX_SIZE']){const e=this['cache']['keys']()['next']()['value'];this['cache']['delete'](e);}}['generateCacheKey'](a,b){let c=0x0;const d=a+'::'+b;for(let e=0x0;e<d['length'];e++){c=(c<<0x5)-c+d['charCodeAt'](e),c=c&c;}return'ai_'+Math['abs'](c)['toString'](0x24);}['recordSuccess'](a,b,c){const d=Object['keys'](this['models'])['find'](f=>this['models'][f]['name']===a);if(!d)return;const e=this['stats'][d];e['requests']++,e['successes']++,e['totalLatency']+=b,e['totalTokens']+=c;}['recordFailure'](a){const b=Object['keys'](this['models'])['find'](c=>this['models'][c]['name']===a);if(!b)return;this['stats'][b]['requests']++,this['stats'][b]['failures']++;}['getStatistics'](){const a={};for(const [b,c]of Object['entries'](this['stats'])){const d=this['models'][b];if(!d)continue;a[d['name']]={'requests':c['requests'],'successes':c['successes'],'failures':c['failures'],'successRate':c['requests']>0x0?(c['successes']/c['requests']*0x64)['toFixed'](0x2)+'%':'N/A','averageLatency':c['successes']>0x0?Math['round'](c['totalLatency']/c['successes'])+'ms':'N/A','totalTokens':c['totalTokens']};}return a['cache']={'hits':this['cacheHits'],'misses':this['cacheMisses'],'hitRate':this['cacheHits']+this['cacheMisses']>0x0?(this['cacheHits']/(this['cacheHits']+this['cacheMisses'])*0x64)['toFixed'](0x2)+'%':'N/A','size':this['cache']['size']},a;}['clearCache'](){this['cache']['clear'](),this['cacheHits']=0x0,this['cacheMisses']=0x0;}['resetStatistics'](){for(const a in this['stats']){this['stats'][a]={'requests':0x0,'successes':0x0,'failures':0x0,'totalLatency':0x0,'totalTokens':0x0};}this['taskSuccessRates']['clear']();}}function generateAdminPanel(a,b,c,d){const e=b['map']((h,i)=>'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20<td>'+(i+0x1)+'</td>\x0a\x20\x20\x20\x20\x20\x20<td><strong>'+Utils['escapeHtml'](h['username'])+'</strong></td>\x0a\x20\x20\x20\x20\x20\x20<td><code\x20class=\x22uuid-cell\x22>'+h['uuid']+'</code></td>\x0a\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22badge\x20badge-'+(h['status']==='active'?'success':'danger')+'\x22>'+h['status']+'</span></td>\x0a\x20\x20\x20\x20\x20\x20<td>'+Utils['formatBytes'](h['traffic_used'])+'\x20/\x20'+Utils['formatBytes'](h['traffic_limit'])+'</td>\x0a\x20\x20\x20\x20\x20\x20<td><div\x20class=\x22progress-bar\x22><div\x20class=\x22progress-fill\x22\x20style=\x22width:\x20'+Math['min'](h['traffic_used']/h['traffic_limit']*0x64,0x64)+'%\x22></div></div></td>\x0a\x20\x20\x20\x20\x20\x20<td>'+(h['connection_count']||0x0)+'</td>\x0a\x20\x20\x20\x20\x20\x20<td>'+Utils['formatDate'](h['last_login'])+'</td>\x0a\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22editUser(\x27'+h['uuid']+'\x27)\x22\x20class=\x22btn-sm\x20btn-primary\x22\x20title=\x22Edit\x22>âœï¸</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22deleteUser(\x27'+h['uuid']+'\x27)\x22\x20class=\x22btn-sm\x20btn-danger\x22\x20title=\x22Delete\x22>ðŸ—‘ï¸</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resetTraffic(\x27'+h['uuid']+'\x27)\x22\x20class=\x22btn-sm\x20btn-warning\x22\x20title=\x22Reset\x20Traffic\x22>ðŸ”„</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22viewDetails(\x27'+h['uuid']+'\x27)\x22\x20class=\x22btn-sm\x20btn-info\x22\x20title=\x22Details\x22>ðŸ‘ï¸</button>\x0a\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20')['join'](''),f=c['slice'](0x0,0x14)['map'](h=>'\x0a\x20\x20\x20\x20<tr\x20class=\x22event-'+h['severity']+'\x22>\x0a\x20\x20\x20\x20\x20\x20<td>'+Utils['formatDate'](h['timestamp'])+'</td>\x0a\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22badge\x20badge-'+getSeverityBadge(h['severity'])+'\x22>'+h['event_type']+'</span></td>\x0a\x20\x20\x20\x20\x20\x20<td>'+Utils['escapeHtml'](h['ip_address']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20<td\x20class=\x22details-cell\x22>'+Utils['escapeHtml'](h['details']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20<td>'+(h['handled']?'âœ…':'â³')+'</td>\x0a\x20\x20\x20\x20\x20\x20<td>'+(h['blocked']?'ðŸš«':'ðŸ‘ï¸')+'</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20')['join'](''),g=d['slice'](0x0,0xf)['map'](h=>'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20<td><code>'+Utils['escapeHtml'](h['domain'])+'</code></td>\x0a\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22badge\x20badge-info\x22>'+Utils['escapeHtml'](h['cdn_type']||'unknown')+'</span></td>\x0a\x20\x20\x20\x20\x20\x20<td><div\x20class=\x22score-badge\x20score-'+Math['floor'](h['stability_score']/0x19)+'\x22>'+h['stability_score']+'</div></td>\x0a\x20\x20\x20\x20\x20\x20<td>'+(h['avg_latency']?Math['round'](h['avg_latency'])+'ms':'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20<td>'+(h['success_rate']?h['success_rate']['toFixed'](0x1)+'%':'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20<td>'+(h['test_count']||0x0)+'</td>\x0a\x20\x20\x20\x20\x20\x20<td>'+(h['is_active']?'âœ…':'âŒ')+'</td>\x0a\x20\x20\x20\x20</tr>\x0a\x20\x20')['join']('');return'<!DOCTYPE\x20html>\x0a<html\x20lang=\x22en\x22>\x0a<head>\x0a\x20\x20<meta\x20charset=\x22UTF-8\x22>\x0a\x20\x20<meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22>\x0a\x20\x20<title>ðŸš€\x20Quantum\x20VLESS\x20Admin\x20Panel\x20v'+CONFIG['VERSION']+'</title>\x0a\x20\x20<style>\x0a\x20\x20\x20\x20*\x20{\x20margin:\x200;\x20padding:\x200;\x20box-sizing:\x20border-box;\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20:root\x20{\x0a\x20\x20\x20\x20\x20\x20--primary:\x20#667eea;\x0a\x20\x20\x20\x20\x20\x20--secondary:\x20#764ba2;\x0a\x20\x20\x20\x20\x20\x20--success:\x20#28a745;\x0a\x20\x20\x20\x20\x20\x20--danger:\x20#dc3545;\x0a\x20\x20\x20\x20\x20\x20--warning:\x20#ffc107;\x0a\x20\x20\x20\x20\x20\x20--info:\x20#17a2b8;\x0a\x20\x20\x20\x20\x20\x20--light:\x20#f8f9fa;\x0a\x20\x20\x20\x20\x20\x20--dark:\x20#343a40;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20font-family:\x20-apple-system,\x20BlinkMacSystemFont,\x20\x27Segoe\x20UI\x27,\x20Roboto,\x20\x27Helvetica\x20Neue\x27,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20var(--primary)\x200%,\x20var(--secondary)\x20100%);\x0a\x20\x20\x20\x20\x20\x20color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20line-height:\x201.6;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.container\x20{\x0a\x20\x20\x20\x20\x20\x20max-width:\x201600px;\x0a\x20\x20\x20\x20\x20\x20margin:\x200\x20auto;\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2020px;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x2030px\x2080px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20overflow:\x20hidden;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.header\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20var(--primary)\x200%,\x20var(--secondary)\x20100%);\x0a\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20padding:\x2040px;\x0a\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20position:\x20relative;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.header\x20h1\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x203em;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20text-shadow:\x202px\x202px\x204px\x20rgba(0,0,0,0.2);\x0a\x20\x20\x20\x20\x20\x20animation:\x20fadeInDown\x200.6s\x20ease;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.header\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x201.2em;\x0a\x20\x20\x20\x20\x20\x20opacity:\x200.9;\x0a\x20\x20\x20\x20\x20\x20animation:\x20fadeInUp\x200.6s\x20ease\x200.2s\x20both;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.version-badge\x20{\x0a\x20\x20\x20\x20\x20\x20position:\x20absolute;\x0a\x20\x20\x20\x20\x20\x20top:\x2020px;\x0a\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20background:\x20rgba(255,255,255,0.2);\x0a\x20\x20\x20\x20\x20\x20padding:\x208px\x2016px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2020px;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(10px);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.stats-grid\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20grid;\x0a\x20\x20\x20\x20\x20\x20grid-template-columns:\x20repeat(auto-fit,\x20minmax(200px,\x201fr));\x0a\x20\x20\x20\x20\x20\x20gap:\x2025px;\x0a\x20\x20\x20\x20\x20\x20padding:\x2040px;\x0a\x20\x20\x20\x20\x20\x20background:\x20var(--light);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.stat-card\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x208px\x2025px\x20rgba(0,0,0,0.1);\x0a\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20cubic-bezier(0.4,\x200,\x200.2,\x201);\x0a\x20\x20\x20\x20\x20\x20position:\x20relative;\x0a\x20\x20\x20\x20\x20\x20overflow:\x20hidden;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.stat-card::before\x20{\x0a\x20\x20\x20\x20\x20\x20content:\x20\x27\x27;\x0a\x20\x20\x20\x20\x20\x20position:\x20absolute;\x0a\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20height:\x204px;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(90deg,\x20var(--primary),\x20var(--secondary));\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.stat-card:hover\x20{\x0a\x20\x20\x20\x20\x20\x20transform:\x20translateY(-8px);\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x2015px\x2040px\x20rgba(0,0,0,0.15);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.stat-icon\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x202.5em;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20opacity:\x200.8;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.stat-value\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x202.8em;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20700;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20var(--primary),\x20var(--secondary));\x0a\x20\x20\x20\x20\x20\x20-webkit-background-clip:\x20text;\x0a\x20\x20\x20\x20\x20\x20-webkit-text-fill-color:\x20transparent;\x0a\x20\x20\x20\x20\x20\x20background-clip:\x20text;\x0a\x20\x20\x20\x20\x20\x20margin:\x2010px\x200;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.stat-label\x20{\x0a\x20\x20\x20\x20\x20\x20color:\x20#6c757d;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.95em;\x0a\x20\x20\x20\x20\x20\x20text-transform:\x20uppercase;\x0a\x20\x20\x20\x20\x20\x20letter-spacing:\x201.5px;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.section\x20{\x0a\x20\x20\x20\x20\x20\x20padding:\x2040px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.section-title\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x202em;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2030px;\x0a\x20\x20\x20\x20\x20\x20color:\x20var(--primary);\x0a\x20\x20\x20\x20\x20\x20border-bottom:\x204px\x20solid\x20var(--primary);\x0a\x20\x20\x20\x20\x20\x20padding-bottom:\x2015px;\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20gap:\x2015px;\x0a\x20\x20\x20\x20\x20\x20animation:\x20slideInLeft\x200.6s\x20ease;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.section-title::before\x20{\x0a\x20\x20\x20\x20\x20\x20content:\x20attr(data-icon);\x0a\x20\x20\x20\x20\x20\x20font-size:\x201.2em;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.action-bar\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20gap:\x2015px;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2025px;\x0a\x20\x20\x20\x20\x20\x20flex-wrap:\x20wrap;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.btn-action\x20{\x0a\x20\x20\x20\x20\x20\x20padding:\x2012px\x2028px;\x0a\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2010px;\x0a\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.95em;\x0a\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s;\x0a\x20\x20\x20\x20\x20\x20text-decoration:\x20none;\x0a\x20\x20\x20\x20\x20\x20display:\x20inline-flex;\x0a\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20gap:\x208px;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2015px\x20rgba(0,0,0,0.1);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.btn-primary\x20{\x20background:\x20var(--primary);\x20color:\x20white;\x20}\x0a\x20\x20\x20\x20.btn-success\x20{\x20background:\x20var(--success);\x20color:\x20white;\x20}\x0a\x20\x20\x20\x20.btn-danger\x20{\x20background:\x20var(--danger);\x20color:\x20white;\x20}\x0a\x20\x20\x20\x20.btn-warning\x20{\x20background:\x20var(--warning);\x20color:\x20#333;\x20}\x0a\x20\x20\x20\x20.btn-info\x20{\x20background:\x20var(--info);\x20color:\x20white;\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.btn-action:hover\x20{\x0a\x20\x20\x20\x20\x20\x20transform:\x20translateY(-2px);\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x206px\x2020px\x20rgba(0,0,0,0.15);\x0a\x20\x20\x20\x20\x20\x20opacity:\x200.9;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20border-collapse:\x20separate;\x0a\x20\x20\x20\x20\x20\x20border-spacing:\x200;\x0a\x20\x20\x20\x20\x20\x20margin-top:\x2020px;\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20overflow:\x20hidden;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x208px\x2025px\x20rgba(0,0,0,0.1);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20var(--primary)\x200%,\x20var(--secondary)\x20100%);\x0a\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20padding:\x2018px\x2015px;\x0a\x20\x20\x20\x20\x20\x20text-align:\x20left;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20\x20\x20text-transform:\x20uppercase;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.85em;\x0a\x20\x20\x20\x20\x20\x20letter-spacing:\x201.2px;\x0a\x20\x20\x20\x20\x20\x20position:\x20sticky;\x0a\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20z-index:\x2010;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20padding:\x2016px\x2015px;\x0a\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#e9ecef;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.95em;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20tr:hover\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(90deg,\x20rgba(102,\x20126,\x20234,\x200.05),\x20transparent);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20tr:last-child\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20border-bottom:\x20none;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.badge\x20{\x0a\x20\x20\x20\x20\x20\x20padding:\x206px\x2014px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2020px;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.85em;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20\x20\x20display:\x20inline-block;\x0a\x20\x20\x20\x20\x20\x20text-transform:\x20uppercase;\x0a\x20\x20\x20\x20\x20\x20letter-spacing:\x200.5px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.badge-success\x20{\x20background:\x20#d4edda;\x20color:\x20#155724;\x20}\x0a\x20\x20\x20\x20.badge-danger\x20{\x20background:\x20#f8d7da;\x20color:\x20#721c24;\x20}\x0a\x20\x20\x20\x20.badge-warning\x20{\x20background:\x20#fff3cd;\x20color:\x20#856404;\x20}\x0a\x20\x20\x20\x20.badge-info\x20{\x20background:\x20#d1ecf1;\x20color:\x20#0c5460;\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.btn-sm\x20{\x0a\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x206px;\x0a\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20font-size:\x201.1em;\x0a\x20\x20\x20\x20\x20\x20margin:\x202px;\x0a\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20background:\x20none;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.btn-sm:hover\x20{\x0a\x20\x20\x20\x20\x20\x20transform:\x20scale(1.2);\x0a\x20\x20\x20\x20\x20\x20filter:\x20brightness(1.2);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.event-critical\x20{\x20background:\x20#ffe6e6;\x20}\x0a\x20\x20\x20\x20.event-high\x20{\x20background:\x20#fff3cd;\x20}\x0a\x20\x20\x20\x20.event-medium\x20{\x20background:\x20#d1ecf1;\x20}\x0a\x20\x20\x20\x20.event-low\x20{\x20background:\x20#d4edda;\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.progress-bar\x20{\x0a\x20\x20\x20\x20\x20\x20height:\x208px;\x0a\x20\x20\x20\x20\x20\x20background:\x20#e9ecef;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2010px;\x0a\x20\x20\x20\x20\x20\x20overflow:\x20hidden;\x0a\x20\x20\x20\x20\x20\x20width:\x20100px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.progress-fill\x20{\x0a\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(90deg,\x20var(--success),\x20var(--info));\x0a\x20\x20\x20\x20\x20\x20transition:\x20width\x200.3s\x20ease;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.uuid-cell\x20{\x0a\x20\x20\x20\x20\x20\x20font-family:\x20\x27Courier\x20New\x27,\x20monospace;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.85em;\x0a\x20\x20\x20\x20\x20\x20color:\x20#6c757d;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.details-cell\x20{\x0a\x20\x20\x20\x20\x20\x20max-width:\x20300px;\x0a\x20\x20\x20\x20\x20\x20overflow:\x20hidden;\x0a\x20\x20\x20\x20\x20\x20text-overflow:\x20ellipsis;\x0a\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.score-badge\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20inline-block;\x0a\x20\x20\x20\x20\x20\x20padding:\x206px\x2014px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20700;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.95em;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.score-0\x20{\x20background:\x20#f8d7da;\x20color:\x20#721c24;\x20}\x0a\x20\x20\x20\x20.score-1\x20{\x20background:\x20#fff3cd;\x20color:\x20#856404;\x20}\x0a\x20\x20\x20\x20.score-2\x20{\x20background:\x20#d1ecf1;\x20color:\x20#0c5460;\x20}\x0a\x20\x20\x20\x20.score-3\x20{\x20background:\x20#d4edda;\x20color:\x20#155724;\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.modal\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20background:\x20rgba(0,0,0,0.7);\x0a\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20animation:\x20fadeIn\x200.3s\x20ease;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.modal-content\x20{\x0a\x20\x20\x20\x20\x20\x20position:\x20absolute;\x0a\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20padding:\x2040px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2020px;\x0a\x20\x20\x20\x20\x20\x20max-width:\x20600px;\x0a\x20\x20\x20\x20\x20\x20width:\x2090%;\x0a\x20\x20\x20\x20\x20\x20max-height:\x2080vh;\x0a\x20\x20\x20\x20\x20\x20overflow-y:\x20auto;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x2020px\x2060px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20animation:\x20slideInDown\x200.3s\x20ease;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.modal-header\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x201.8em;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2025px;\x0a\x20\x20\x20\x20\x20\x20color:\x20var(--primary);\x0a\x20\x20\x20\x20\x20\x20border-bottom:\x203px\x20solid\x20var(--primary);\x0a\x20\x20\x20\x20\x20\x20padding-bottom:\x2015px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.form-group\x20{\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.form-label\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x208px;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20\x20\x20color:\x20#495057;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.form-control\x20{\x0a\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20padding:\x2012px;\x0a\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#e9ecef;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20font-size:\x201em;\x0a\x20\x20\x20\x20\x20\x20transition:\x20border-color\x200.3s;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.form-control:focus\x20{\x0a\x20\x20\x20\x20\x20\x20outline:\x20none;\x0a\x20\x20\x20\x20\x20\x20border-color:\x20var(--primary);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.close-btn\x20{\x0a\x20\x20\x20\x20\x20\x20position:\x20absolute;\x0a\x20\x20\x20\x20\x20\x20top:\x2020px;\x0a\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20background:\x20none;\x0a\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20font-size:\x202em;\x0a\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20color:\x20#6c757d;\x0a\x20\x20\x20\x20\x20\x20transition:\x20color\x200.3s;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.close-btn:hover\x20{\x0a\x20\x20\x20\x20\x20\x20color:\x20var(--danger);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@keyframes\x20fadeIn\x20{\x0a\x20\x20\x20\x20\x20\x20from\x20{\x20opacity:\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20to\x20{\x20opacity:\x201;\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@keyframes\x20fadeInDown\x20{\x0a\x20\x20\x20\x20\x20\x20from\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(-30px);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20to\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(0);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@keyframes\x20fadeInUp\x20{\x0a\x20\x20\x20\x20\x20\x20from\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(30px);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20to\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(0);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@keyframes\x20slideInLeft\x20{\x0a\x20\x20\x20\x20\x20\x20from\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateX(-30px);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20to\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateX(0);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.loading\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20inline-block;\x0a\x20\x20\x20\x20\x20\x20width:\x2020px;\x0a\x20\x20\x20\x20\x20\x20height:\x2020px;\x0a\x20\x20\x20\x20\x20\x20border:\x203px\x20solid\x20rgba(255,255,255,.3);\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2050%;\x0a\x20\x20\x20\x20\x20\x20border-top-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20animation:\x20spin\x201s\x20ease-in-out\x20infinite;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@keyframes\x20spin\x20{\x0a\x20\x20\x20\x20\x20\x20to\x20{\x20transform:\x20rotate(360deg);\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.toast\x20{\x0a\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20bottom:\x2030px;\x0a\x20\x20\x20\x20\x20\x20right:\x2030px;\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px\x2030px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2010px;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x2010px\x2030px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20z-index:\x202000;\x0a\x20\x20\x20\x20\x20\x20animation:\x20slideInUp\x200.3s\x20ease;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.toast.show\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@media\x20(max-width:\x20768px)\x20{\x0a\x20\x20\x20\x20\x20\x20.stats-grid\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20grid-template-columns:\x201fr;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x200.85em;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20.action-bar\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20flex-direction:\x20column;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20</style>\x0a</head>\x0a<body>\x0a\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22version-badge\x22>v'+CONFIG['VERSION']+'</div>\x0a\x20\x20\x20\x20\x20\x20<h1>ðŸš€\x20Quantum\x20VLESS\x20Ultimate</h1>\x0a\x20\x20\x20\x20\x20\x20<p>Enterprise-Grade\x20Admin\x20Control\x20Panel</p>\x0a\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20<div\x20class=\x22stats-grid\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-icon\x22>ðŸ‘¥</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22>'+a['totalUsers']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-label\x22>Total\x20Users</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-icon\x22>âœ…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22>'+a['activeUsers']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-label\x22>Active\x20Users</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-icon\x22>ðŸ”—</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22>'+a['activeConnections']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-label\x22>Active\x20Connections</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-icon\x22>ðŸ“Š</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22>'+Utils['formatBytes'](a['totalTraffic'])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-label\x22>Total\x20Traffic</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-icon\x22>ðŸ›¡ï¸</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22>'+a['securityEvents']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-label\x22>Security\x20Events</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-icon\x22>âš¡</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22>'+(MEMORY_CACHE['stats']['hits']/(MEMORY_CACHE['stats']['hits']+MEMORY_CACHE['stats']['misses']||0x1)*0x64)['toFixed'](0x0)+'%</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-label\x22>Cache\x20Hit\x20Rate</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20<div\x20class=\x22section\x22>\x0a\x20\x20\x20\x20\x20\x20<h2\x20class=\x22section-title\x22\x20data-icon=\x22ðŸ‘¥\x22>User\x20Management</h2>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22action-bar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-success\x22\x20onclick=\x22createUser()\x22>âž•\x20Add\x20User</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-primary\x22\x20onclick=\x22refreshUsers()\x22>ðŸ”„\x20Refresh</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-warning\x22\x20onclick=\x22exportUsers()\x22>ðŸ“¥\x20Export</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-info\x22\x20onclick=\x22bulkActions()\x22>âš™ï¸\x20Bulk\x20Actions</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22overflow-x:\x20auto;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>#</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>UUID</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Status</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Traffic\x20Usage</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Progress</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Connections</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Last\x20Login</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Actions</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody\x20id=\x22userTableBody\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(e||'<tr><td\x20colspan=\x229\x22\x20style=\x22text-align:\x20center;\x22>No\x20users\x20found</td></tr>')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20<div\x20class=\x22section\x22>\x0a\x20\x20\x20\x20\x20\x20<h2\x20class=\x22section-title\x22\x20data-icon=\x22ðŸ›¡ï¸\x22>Security\x20Events</h2>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22action-bar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-primary\x22\x20onclick=\x22refreshEvents()\x22>ðŸ”„\x20Refresh</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-danger\x22\x20onclick=\x22clearEvents()\x22>ðŸ—‘ï¸\x20Clear\x20Old</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22overflow-x:\x20auto;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Timestamp</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Event\x20Type</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>IP\x20Address</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Details</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Handled</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Blocked</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody\x20id=\x22eventsTableBody\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(f||'<tr><td\x20colspan=\x226\x22\x20style=\x22text-align:\x20center;\x22>No\x20events</td></tr>')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20<div\x20class=\x22section\x22>\x0a\x20\x20\x20\x20\x20\x20<h2\x20class=\x22section-title\x22\x20data-icon=\x22ðŸŒ\x22>Optimal\x20SNIs</h2>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22action-bar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-success\x22\x20onclick=\x22discoverSNIs()\x22>ðŸ”\x20Discover\x20New</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-primary\x22\x20onclick=\x22refreshSNIs()\x22>ðŸ”„\x20Refresh</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-warning\x22\x20onclick=\x22testAllSNIs()\x22>ðŸ§ª\x20Test\x20All</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22overflow-x:\x20auto;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Domain</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>CDN\x20Provider</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Score</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Latency</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Success\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Tests</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Status</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody\x20id=\x22sniTableBody\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(g||'<tr><td\x20colspan=\x227\x22\x20style=\x22text-align:\x20center;\x22>No\x20SNIs\x20configured</td></tr>')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20<div\x20class=\x22section\x22>\x0a\x20\x20\x20\x20\x20\x20<h2\x20class=\x22section-title\x22\x20data-icon=\x22âš™ï¸\x22>System\x20Actions</h2>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22action-bar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-primary\x22\x20onclick=\x22optimizeSystem()\x22>âš¡\x20Optimize</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-warning\x22\x20onclick=\x22clearCache()\x22>ðŸ—‘ï¸\x20Clear\x20Cache</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-info\x22\x20onclick=\x22viewLogs()\x22>ðŸ“œ\x20View\x20Logs</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn-action\x20btn-success\x22\x20onclick=\x22runMaintenance()\x22>ðŸ”§\x20Maintenance</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20</div>\x0a\x0a\x20\x20<!--\x20Create/Edit\x20User\x20Modal\x20-->\x0a\x20\x20<div\x20id=\x22userModal\x22\x20class=\x22modal\x22>\x0a\x20\x20\x20\x20<div\x20class=\x22modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20<button\x20class=\x22close-btn\x22\x20onclick=\x22closeModal(\x27userModal\x27)\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20<h3\x20class=\x22modal-header\x22>Create\x20New\x20User</h3>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<form\x20id=\x22userForm\x22\x20onsubmit=\x22return\x20saveUser(event)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22form-label\x22>Username</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22form-control\x22\x20name=\x22username\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22form-label\x22>Email\x20(Optional)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22email\x22\x20class=\x22form-control\x22\x20name=\x22email\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22form-label\x22>Password</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22password\x22\x20class=\x22form-control\x22\x20name=\x22password\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22form-label\x22>Traffic\x20Limit\x20(GB)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22form-control\x22\x20name=\x22trafficLimit\x22\x20value=\x22100\x22\x20min=\x221\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22form-label\x22>Expiry\x20Days</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22form-control\x22\x20name=\x22expiryDays\x22\x20value=\x2230\x22\x20min=\x221\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22form-label\x22>Max\x20Connections</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22form-control\x22\x20name=\x22maxConnections\x22\x20value=\x225\x22\x20min=\x221\x22\x20max=\x2220\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2030px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22btn-action\x20btn-success\x22\x20style=\x22flex:\x201;\x22>ðŸ’¾\x20Save\x20User</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22btn-action\x20btn-danger\x22\x20onclick=\x22closeModal(\x27userModal\x27)\x22\x20style=\x22flex:\x201;\x22>âŒ\x20Cancel</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20</div>\x0a\x0a\x20\x20<!--\x20Toast\x20Notification\x20-->\x0a\x20\x20<div\x20id=\x22toast\x22\x20class=\x22toast\x22></div>\x0a\x0a\x20\x20<script>\x0a\x20\x20\x20\x20//\x20API\x20Base\x20URL\x0a\x20\x20\x20\x20const\x20API_BASE\x20=\x20window.location.origin\x20+\x20\x27/api\x27;\x0a\x0a\x20\x20\x20\x20//\x20Show\x20modal\x0a\x20\x20\x20\x20function\x20showModal(modalId)\x20{\x0a\x20\x20\x20\x20\x20\x20document.getElementById(modalId).style.display\x20=\x20\x27block\x27;\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Close\x20modal\x0a\x20\x20\x20\x20function\x20closeModal(modalId)\x20{\x0a\x20\x20\x20\x20\x20\x20document.getElementById(modalId).style.display\x20=\x20\x27none\x27;\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Show\x20toast\x20notification\x0a\x20\x20\x20\x20function\x20showToast(message,\x20duration\x20=\x203000)\x20{\x0a\x20\x20\x20\x20\x20\x20const\x20toast\x20=\x20document.getElementById(\x27toast\x27);\x0a\x20\x20\x20\x20\x20\x20toast.textContent\x20=\x20message;\x0a\x20\x20\x20\x20\x20\x20toast.classList.add(\x27show\x27);\x0a\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20toast.classList.remove(\x27show\x27),\x20duration);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Create\x20user\x0a\x20\x20\x20\x20function\x20createUser()\x20{\x0a\x20\x20\x20\x20\x20\x20document.getElementById(\x27userForm\x27).reset();\x0a\x20\x20\x20\x20\x20\x20document.querySelector(\x27.modal-header\x27).textContent\x20=\x20\x27Create\x20New\x20User\x27;\x0a\x20\x20\x20\x20\x20\x20showModal(\x27userModal\x27);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Save\x20user\x0a\x20\x20\x20\x20async\x20function\x20saveUser(event)\x20{\x0a\x20\x20\x20\x20\x20\x20event.preventDefault();\x0a\x20\x20\x20\x20\x20\x20const\x20formData\x20=\x20new\x20FormData(event.target);\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20const\x20userData\x20=\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20username:\x20formData.get(\x27username\x27),\x0a\x20\x20\x20\x20\x20\x20\x20\x20email:\x20formData.get(\x27email\x27),\x0a\x20\x20\x20\x20\x20\x20\x20\x20password:\x20formData.get(\x27password\x27),\x0a\x20\x20\x20\x20\x20\x20\x20\x20trafficLimit:\x20parseInt(formData.get(\x27trafficLimit\x27))\x20*\x201073741824,\x0a\x20\x20\x20\x20\x20\x20\x20\x20expiryDate:\x20Math.floor(Date.now()\x20/\x201000)\x20+\x20(parseInt(formData.get(\x27expiryDays\x27))\x20*\x2086400),\x0a\x20\x20\x20\x20\x20\x20\x20\x20maxConnections:\x20parseInt(formData.get(\x27maxConnections\x27))\x0a\x20\x20\x20\x20\x20\x20};\x0a\x0a\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20response\x20=\x20await\x20fetch(API_BASE\x20+\x20\x27/users\x27,\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20method:\x20\x27POST\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20headers:\x20{\x20\x27Content-Type\x27:\x20\x27application/json\x27\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body:\x20JSON.stringify(userData)\x0a\x20\x20\x20\x20\x20\x20\x20\x20});\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20(response.ok)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âœ…\x20User\x20created\x20successfully!\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20closeModal(\x27userModal\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20refreshUsers(),\x201000);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20error\x20=\x20await\x20response.json();\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âŒ\x20Error:\x20\x27\x20+\x20error.message);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âŒ\x20Network\x20error:\x20\x27\x20+\x20error.message);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Edit\x20user\x0a\x20\x20\x20\x20function\x20editUser(uuid)\x20{\x0a\x20\x20\x20\x20\x20\x20showToast(\x27ðŸ”§\x20Edit\x20feature\x20-\x20UUID:\x20\x27\x20+\x20uuid);\x0a\x20\x20\x20\x20\x20\x20//\x20Implementation\x20would\x20fetch\x20user\x20data\x20and\x20populate\x20modal\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Delete\x20user\x0a\x20\x20\x20\x20async\x20function\x20deleteUser(uuid)\x20{\x0a\x20\x20\x20\x20\x20\x20if\x20(!confirm(\x27Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20user?\x27))\x20return;\x0a\x0a\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20response\x20=\x20await\x20fetch(API_BASE\x20+\x20\x27/users/\x27\x20+\x20uuid,\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20method:\x20\x27DELETE\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20});\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20(response.ok)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âœ…\x20User\x20deleted\x20successfully!\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20refreshUsers(),\x201000);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âŒ\x20Failed\x20to\x20delete\x20user\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âŒ\x20Network\x20error:\x20\x27\x20+\x20error.message);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Reset\x20traffic\x0a\x20\x20\x20\x20async\x20function\x20resetTraffic(uuid)\x20{\x0a\x20\x20\x20\x20\x20\x20if\x20(!confirm(\x27Reset\x20traffic\x20usage\x20for\x20this\x20user?\x27))\x20return;\x0a\x0a\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20response\x20=\x20await\x20fetch(API_BASE\x20+\x20\x27/users/\x27\x20+\x20uuid\x20+\x20\x27/reset-traffic\x27,\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20method:\x20\x27POST\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20});\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20(response.ok)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âœ…\x20Traffic\x20reset\x20successfully!\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20refreshUsers(),\x201000);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âŒ\x20Failed\x20to\x20reset\x20traffic\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âŒ\x20Network\x20error:\x20\x27\x20+\x20error.message);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20View\x20details\x0a\x20\x20\x20\x20function\x20viewDetails(uuid)\x20{\x0a\x20\x20\x20\x20\x20\x20showToast(\x27ðŸ‘ï¸\x20Viewing\x20details\x20for:\x20\x27\x20+\x20uuid);\x0a\x20\x20\x20\x20\x20\x20//\x20Implementation\x20would\x20show\x20detailed\x20modal\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Refresh\x20functions\x0a\x20\x20\x20\x20function\x20refreshUsers()\x20{\x0a\x20\x20\x20\x20\x20\x20showToast(\x27ðŸ”„\x20Refreshing\x20users...\x27);\x0a\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20window.location.reload(),\x20500);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20function\x20refreshEvents()\x20{\x0a\x20\x20\x20\x20\x20\x20showToast(\x27ðŸ”„\x20Refreshing\x20events...\x27);\x0a\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20window.location.reload(),\x20500);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20function\x20refreshSNIs()\x20{\x0a\x20\x20\x20\x20\x20\x20showToast(\x27ðŸ”„\x20Refreshing\x20SNIs...\x27);\x0a\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20window.location.reload(),\x20500);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20System\x20actions\x0a\x20\x20\x20\x20async\x20function\x20optimizeSystem()\x20{\x0a\x20\x20\x20\x20\x20\x20showToast(\x27âš¡\x20Running\x20optimization...\x27);\x0a\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20await\x20fetch(API_BASE\x20+\x20\x27/system/optimize\x27,\x20{\x20method:\x20\x27POST\x27\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âœ…\x20System\x20optimized!\x27);\x0a\x20\x20\x20\x20\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âŒ\x20Optimization\x20failed\x27);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20async\x20function\x20clearCache()\x20{\x0a\x20\x20\x20\x20\x20\x20if\x20(!confirm(\x27Clear\x20all\x20cache\x20data?\x27))\x20return;\x0a\x20\x20\x20\x20\x20\x20showToast(\x27ðŸ—‘ï¸\x20Clearing\x20cache...\x27);\x0a\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20await\x20fetch(API_BASE\x20+\x20\x27/system/clear-cache\x27,\x20{\x20method:\x20\x27POST\x27\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âœ…\x20Cache\x20cleared!\x27);\x0a\x20\x20\x20\x20\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âŒ\x20Failed\x20to\x20clear\x20cache\x27);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20async\x20function\x20discoverSNIs()\x20{\x0a\x20\x20\x20\x20\x20\x20showToast(\x27ðŸ”\x20Starting\x20SNI\x20discovery...\x27);\x0a\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20await\x20fetch(API_BASE\x20+\x20\x27/sni/discover\x27,\x20{\x20method:\x20\x27POST\x27\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âœ…\x20SNI\x20discovery\x20started!\x20Check\x20back\x20in\x20a\x20few\x20minutes.\x27);\x0a\x20\x20\x20\x20\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âŒ\x20Failed\x20to\x20start\x20discovery\x27);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20function\x20viewLogs()\x20{\x0a\x20\x20\x20\x20\x20\x20window.open(\x27/logs\x27,\x20\x27_blank\x27);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20async\x20function\x20runMaintenance()\x20{\x0a\x20\x20\x20\x20\x20\x20if\x20(!confirm(\x27Run\x20database\x20maintenance?\x20This\x20may\x20take\x20a\x20few\x20moments.\x27))\x20return;\x0a\x20\x20\x20\x20\x20\x20showToast(\x27ðŸ”§\x20Running\x20maintenance...\x27);\x0a\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20await\x20fetch(API_BASE\x20+\x20\x27/system/maintenance\x27,\x20{\x20method:\x20\x27POST\x27\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âœ…\x20Maintenance\x20complete!\x27);\x0a\x20\x20\x20\x20\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20showToast(\x27âŒ\x20Maintenance\x20failed\x27);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Close\x20modal\x20when\x20clicking\x20outside\x0a\x20\x20\x20\x20window.onclick\x20=\x20function(event)\x20{\x0a\x20\x20\x20\x20\x20\x20if\x20(event.target.classList.contains(\x27modal\x27))\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20event.target.style.display\x20=\x20\x27none\x27;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Auto-refresh\x20every\x2030\x20seconds\x0a\x20\x20\x20\x20setInterval(()\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20//\x20Silently\x20refresh\x20cache\x20stats\x0a\x20\x20\x20\x20\x20\x20fetch(API_BASE\x20+\x20\x27/stats\x27).catch(()\x20=>\x20{});\x0a\x20\x20\x20\x20},\x2030000);\x0a\x20\x20</script>\x0a</body>\x0a</html>';}function getSeverityBadge(a){const b={'critical':'danger','high':'warning','medium':'info','low':'success'};return b[a]||'info';}async function generateUserPanel(a,b){const c=Math['min'](a['traffic_used']/a['traffic_limit']*0x64,0x64),d=a['expiry_date']?Math['max'](0x0,Math['floor']((a['expiry_date']-Date['now']()/0x3e8)/0x15180)):'âˆž',e='vless://'+a['uuid']+'@'+(a['hostname']||'YOUR-WORKER.workers.dev')+':443?encryption=none&security=tls&type=ws&host='+(a['hostname']||'YOUR-WORKER.workers.dev')+'&path=/vless#'+encodeURIComponent(a['username']);return'<!DOCTYPE\x20html>\x0a<html\x20lang=\x22en\x22>\x0a<head>\x0a\x20\x20<meta\x20charset=\x22UTF-8\x22>\x0a\x20\x20<meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22>\x0a\x20\x20<title>Quantum\x20VLESS\x20-\x20My\x20Account</title>\x0a\x20\x20<style>\x0a\x20\x20\x20\x20*\x20{\x20margin:\x200;\x20padding:\x200;\x20box-sizing:\x20border-box;\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20font-family:\x20-apple-system,\x20BlinkMacSystemFont,\x20\x27Segoe\x20UI\x27,\x20Roboto,\x20\x27Helvetica\x20Neue\x27,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#667eea\x200%,\x20#764ba2\x20100%);\x0a\x20\x20\x20\x20\x20\x20color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20min-height:\x20100vh;\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.container\x20{\x0a\x20\x20\x20\x20\x20\x20max-width:\x20900px;\x0a\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2025px;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x2030px\x2080px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20overflow:\x20hidden;\x0a\x20\x20\x20\x20\x20\x20animation:\x20fadeInUp\x200.6s\x20ease;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.header\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#667eea\x200%,\x20#764ba2\x20100%);\x0a\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20padding:\x2050px\x2040px;\x0a\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.header\x20h1\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x202.5em;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20text-shadow:\x202px\x202px\x204px\x20rgba(0,0,0,0.2);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.user-name\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x201.3em;\x0a\x20\x20\x20\x20\x20\x20opacity:\x200.95;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.content\x20{\x0a\x20\x20\x20\x20\x20\x20padding:\x2040px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.info-grid\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20grid;\x0a\x20\x20\x20\x20\x20\x20grid-template-columns:\x20repeat(auto-fit,\x20minmax(200px,\x201fr));\x0a\x20\x20\x20\x20\x20\x20gap:\x2025px;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2040px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.info-card\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#f8f9fa\x200%,\x20#e9ecef\x20100%);\x0a\x20\x20\x20\x20\x20\x20padding:\x2025px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20transition:\x20transform\x200.3s;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.info-card:hover\x20{\x0a\x20\x20\x20\x20\x20\x20transform:\x20translateY(-5px);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.info-icon\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x202.5em;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.info-value\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x202em;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20700;\x0a\x20\x20\x20\x20\x20\x20color:\x20#667eea;\x0a\x20\x20\x20\x20\x20\x20margin:\x2010px\x200;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.info-label\x20{\x0a\x20\x20\x20\x20\x20\x20color:\x20#6c757d;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20\x20\x20text-transform:\x20uppercase;\x0a\x20\x20\x20\x20\x20\x20letter-spacing:\x201px;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.traffic-section\x20{\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2040px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.section-title\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x201.5em;\x0a\x20\x20\x20\x20\x20\x20color:\x20#667eea;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20gap:\x2010px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.progress-container\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20#e9ecef;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20height:\x2030px;\x0a\x20\x20\x20\x20\x20\x20overflow:\x20hidden;\x0a\x20\x20\x20\x20\x20\x20position:\x20relative;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2015px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.progress-bar\x20{\x0a\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(90deg,\x20#28a745\x200%,\x20#20c997\x2050%,\x20#17a2b8\x20100%);\x0a\x20\x20\x20\x20\x20\x20transition:\x20width\x201s\x20ease;\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20justify-content:\x20flex-end;\x0a\x20\x20\x20\x20\x20\x20padding:\x200\x2015px;\x0a\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.traffic-info\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20color:\x20#6c757d;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.95em;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.config-section\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20#f8f9fa;\x0a\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2040px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.config-box\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#e9ecef;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2010px;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20font-family:\x20\x27Courier\x20New\x27,\x20monospace;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.85em;\x0a\x20\x20\x20\x20\x20\x20word-break:\x20break-all;\x0a\x20\x20\x20\x20\x20\x20color:\x20#495057;\x0a\x20\x20\x20\x20\x20\x20margin:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20position:\x20relative;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.copy-btn\x20{\x0a\x20\x20\x20\x20\x20\x20position:\x20absolute;\x0a\x20\x20\x20\x20\x20\x20top:\x2015px;\x0a\x20\x20\x20\x20\x20\x20right:\x2015px;\x0a\x20\x20\x20\x20\x20\x20padding:\x208px\x2016px;\x0a\x20\x20\x20\x20\x20\x20background:\x20#667eea;\x0a\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.copy-btn:hover\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20#5568d3;\x0a\x20\x20\x20\x20\x20\x20transform:\x20scale(1.05);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.qr-container\x20{\x0a\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2010px;\x0a\x20\x20\x20\x20\x20\x20margin-top:\x2020px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.qr-code\x20{\x0a\x20\x20\x20\x20\x20\x20max-width:\x20250px;\x0a\x20\x20\x20\x20\x20\x20margin:\x200\x20auto;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.stats-section\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20grid;\x0a\x20\x20\x20\x20\x20\x20grid-template-columns:\x20repeat(auto-fit,\x20minmax(150px,\x201fr));\x0a\x20\x20\x20\x20\x20\x20gap:\x2020px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.stat-box\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#667eea\x200%,\x20#764ba2\x20100%);\x0a\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.stat-number\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x202em;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20700;\x0a\x20\x20\x20\x20\x20\x20margin:\x2010px\x200;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.stat-label\x20{\x0a\x20\x20\x20\x20\x20\x20opacity:\x200.9;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.85em;\x0a\x20\x20\x20\x20\x20\x20text-transform:\x20uppercase;\x0a\x20\x20\x20\x20\x20\x20letter-spacing:\x201px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.status-badge\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20inline-block;\x0a\x20\x20\x20\x20\x20\x20padding:\x208px\x2020px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2025px;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20\x20\x20text-transform:\x20uppercase;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.status-active\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20#d4edda;\x0a\x20\x20\x20\x20\x20\x20color:\x20#155724;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.status-expired\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20#f8d7da;\x0a\x20\x20\x20\x20\x20\x20color:\x20#721c24;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.instructions\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20#fff3cd;\x0a\x20\x20\x20\x20\x20\x20border-left:\x204px\x20solid\x20#ffc107;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20margin-top:\x2030px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.instructions\x20h3\x20{\x0a\x20\x20\x20\x20\x20\x20color:\x20#856404;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2015px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.instructions\x20ol\x20{\x0a\x20\x20\x20\x20\x20\x20padding-left:\x2020px;\x0a\x20\x20\x20\x20\x20\x20color:\x20#856404;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.instructions\x20li\x20{\x0a\x20\x20\x20\x20\x20\x20margin:\x2010px\x200;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@keyframes\x20fadeInUp\x20{\x0a\x20\x20\x20\x20\x20\x20from\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(30px);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20to\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(0);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.toast\x20{\x0a\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20bottom:\x2030px;\x0a\x20\x20\x20\x20\x20\x20right:\x2030px;\x0a\x20\x20\x20\x20\x20\x20background:\x20#28a745;\x0a\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20padding:\x2015px\x2025px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2010px;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x2010px\x2030px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20animation:\x20slideIn\x200.3s\x20ease;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20.toast.show\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@keyframes\x20slideIn\x20{\x0a\x20\x20\x20\x20\x20\x20from\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateX(400px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20to\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateX(0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@media\x20(max-width:\x20768px)\x20{\x0a\x20\x20\x20\x20\x20\x20.info-grid\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20grid-template-columns:\x201fr;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20.copy-btn\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20static;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x2015px;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20</style>\x0a</head>\x0a<body>\x0a\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20<h1>ðŸš€\x20Quantum\x20VLESS</h1>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-name\x22>Welcome,\x20'+Utils['escapeHtml'](a['username'])+'!</div>\x0a\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-grid\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-icon\x22>ðŸ“Š</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-value\x22>'+Utils['formatBytes'](a['traffic_used'])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-label\x22>Used</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-icon\x22>ðŸ“ˆ</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-value\x22>'+Utils['formatBytes'](a['traffic_limit'])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-label\x22>Total\x20Limit</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-icon\x22>ðŸ“…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-value\x22>'+d+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-label\x22>Days\x20Left</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-icon\x22>ðŸ”—</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-value\x22>'+(a['connection_count']||0x0)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-label\x22>Connections</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22traffic-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22section-title\x22>ðŸ“Š\x20Traffic\x20Usage</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22progress-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22progress-bar\x22\x20style=\x22width:\x20'+c+'%\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+c['toFixed'](0x1)+'%\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22traffic-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+Utils['formatBytes'](a['traffic_used'])+'\x20used</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+Utils['formatBytes'](a['traffic_limit']-a['traffic_used'])+'\x20remaining</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22section-title\x22>ðŸ”\x20Your\x20VLESS\x20Configuration</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>Status:</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22status-badge\x20status-'+a['status']+'\x22>'+a['status']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22configText\x22>'+e+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22copy-btn\x22\x20onclick=\x22copyConfig()\x22>ðŸ“‹\x20Copy</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22qr-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22qr-code\x22\x20id=\x22qrCode\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22margin-top:\x2010px;\x20color:\x20#6c757d;\x22>Scan\x20with\x20your\x20VLESS\x20client</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stats-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-number\x22>'+(b['totalConnections']||0x0)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-label\x22>Total\x20Sessions</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-number\x22>'+Utils['formatBytes'](b['bytes_sent']||0x0)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-label\x22>Uploaded</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-number\x22>'+Utils['formatBytes'](b['bytes_received']||0x0)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-label\x22>Downloaded</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-number\x22>'+(a['device_count']||0x0)+'/'+(a['max_devices']||0x3)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-label\x22>Devices</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22instructions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h3>ðŸ“±\x20How\x20to\x20Connect</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<ol>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Install\x20a\x20VLESS-compatible\x20client\x20(v2rayNG,\x20v2rayN,\x20Shadowrocket,\x20etc.)</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Click\x20\x22Copy\x22\x20button\x20above\x20to\x20copy\x20your\x20configuration</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Paste\x20the\x20configuration\x20into\x20your\x20client\x20app</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Or\x20scan\x20the\x20QR\x20code\x20with\x20your\x20app</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Connect\x20and\x20enjoy\x20secure\x20browsing!</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</ol>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20</div>\x0a\x0a\x20\x20<div\x20id=\x22toast\x22\x20class=\x22toast\x22>âœ…\x20Configuration\x20copied\x20to\x20clipboard!</div>\x0a\x0a\x20\x20<script>\x0a\x20\x20\x20\x20function\x20copyConfig()\x20{\x0a\x20\x20\x20\x20\x20\x20const\x20configText\x20=\x20document.getElementById(\x27configText\x27).textContent;\x0a\x20\x20\x20\x20\x20\x20navigator.clipboard.writeText(configText).then(()\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20toast\x20=\x20document.getElementById(\x27toast\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20toast.classList.add(\x27show\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20toast.classList.remove(\x27show\x27),\x203000);\x0a\x20\x20\x20\x20\x20\x20});\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Generate\x20QR\x20Code\x0a\x20\x20\x20\x20function\x20generateQRCode(text)\x20{\x0a\x20\x20\x20\x20\x20\x20const\x20qrContainer\x20=\x20document.getElementById(\x27qrCode\x27);\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20//\x20Using\x20a\x20simple\x20QR\x20code\x20API\x0a\x20\x20\x20\x20\x20\x20const\x20qrCodeURL\x20=\x20\x27https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=\x27\x20+\x20encodeURIComponent(text);\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20const\x20img\x20=\x20document.createElement(\x27img\x27);\x0a\x20\x20\x20\x20\x20\x20img.src\x20=\x20qrCodeURL;\x0a\x20\x20\x20\x20\x20\x20img.alt\x20=\x20\x27VLESS\x20Config\x20QR\x20Code\x27;\x0a\x20\x20\x20\x20\x20\x20img.style.width\x20=\x20\x27100%\x27;\x0a\x20\x20\x20\x20\x20\x20img.style.borderRadius\x20=\x20\x2710px\x27;\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20qrContainer.appendChild(img);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Initialize\x20QR\x20Code\x0a\x20\x20\x20\x20generateQRCode(document.getElementById(\x27configText\x27).textContent);\x0a\x20\x20</script>\x0a</body>\x0a</html>';}async function handleVLESS(a,b,c,d){const e=a['headers']['get']('Upgrade');if(e!=='websocket')return new Response('Expected\x20WebSocket',{'status':0x1aa});const f=Utils['getClientInfo'](a),g=new HoneypotSystem(d);if(g['isScannerDetected'](f))return await g['handleScanner'](f,a);if(g['isIPBanned'](f['ip']))return await d['logSecurityEvent']({'eventType':'banned_ip_attempt','severity':'high','ipAddress':f['ip'],'userAgent':f['userAgent'],'blocked':!![]}),new Response('Access\x20Denied',{'status':0x193});const h=new WebSocketPair(),[i,j]=Object['values'](h);return j['accept'](),handleWebSocket(j,i,b,f,d)['catch'](k=>{console['error']('WebSocket\x20handling\x20error:',k);try{j['close'](0x3f3,'Internal\x20error');}catch(l){}}),new Response(null,{'status':0x65,'webSocket':i});}async function handleWebSocket(a,b,c,d,f){const g=new VLESSProtocol(),h=new TrafficMorpher(),i=new ProtocolObfuscator();let j=null,k=null,l=null,m=0x0,n=0x0,o=Date['now']();try{const p=await new Promise((C,D)=>{const E=setTimeout(()=>D(new Error('Header\x20timeout')),0x2710);a['addEventListener']('message',F=>{clearTimeout(E),C(F['data']);},{'once':!![]}),a['addEventListener']('error',F=>{clearTimeout(E),D(new Error('WebSocket\x20error'));},{'once':!![]});}),q=await p['arrayBuffer'](),r=await g['parseHeader'](q),s=await g['validateUUID'](r['uuid'],f);if(!s['valid']){await f['logSecurityEvent']({'eventType':'invalid_uuid','severity':'high','ipAddress':d['ip'],'details':JSON['stringify']({'uuid':r['uuid'],'reason':s['reason']}),'blocked':!![]}),a['close'](0x3f0,'Authentication\x20failed:\x20'+s['reason']);return;}const t=s['user'];k=t['id'];const u=await f['getActiveConnections'](k);if(u['length']>=(t['max_connections']||0x5)){a['close'](0x3f0,'Connection\x20limit\x20reached');return;}if(Utils['isPortBlocked'](r['port'])){await f['logSecurityEvent']({'eventType':'blocked_port_attempt','severity':'medium','ipAddress':d['ip'],'details':JSON['stringify']({'port':r['port'],'address':r['address']}),'userId':k}),a['close'](0x3f0,'Port\x20not\x20allowed');return;}if(Utils['isIPBlocked'](r['address'])){a['close'](0x3f0,'Destination\x20not\x20allowed');return;}const v=new CDNFailoverManager(f),w=await v['getBestProvider'](d),x=await f['createConnection']({'userId':k,'ipAddress':d['ip'],'userAgent':d['userAgent'],'connectionType':'vless','cdnProvider':w['name'],'destinationHost':r['address'],'destinationPort':r['port']});j=x['meta']?.['last_row_id'],await f['updateUser'](t['uuid'],{'lastLogin':Math['floor'](Date['now']()/0x3e8),'lastIp':d['ip'],'connectionCount':(t['connection_count']||0x0)+0x1});const y=r['addressType']===0x2?'hostname':'address';l=await connect({[y]:r['address'],'port':r['port']});const z=g['createResponse']();await l['writable']['getWriter']()['write'](z);r['payload']&&r['payload']['byteLength']>0x0&&(await l['writable']['getWriter']()['write'](r['payload']),m+=r['payload']['byteLength']);const A=async()=>{try{const C=a['readable']['getReader'](),D=l['writable']['getWriter']();while(!![]){const {done:E,value:F}=await C['read']();if(E)break;if(CONFIG['TRAFFIC_MORPHING']['ENABLED']){await h['applyJitter']();let G=F;CONFIG['TRAFFIC_MORPHING']['PADDING']['ENABLED']&&(G=h['addPadding'](G));CONFIG['SECURITY']['ENCRYPTION']['ENABLED']&&(G=await i['obfuscate'](G));if(CONFIG['TRAFFIC_MORPHING']['FRAGMENTATION']['ENABLED']&&G['byteLength']>0x400){const H=await h['fragmentPacket'](G);for(const I of H){await D['write'](I),m+=I['byteLength'];}}else await D['write'](G),m+=G['byteLength'];}else await D['write'](F),m+=F['byteLength'];if(t['traffic_limit']>0x0&&t['traffic_used']+m+n>=t['traffic_limit'])throw new Error('Traffic\x20limit\x20exceeded');}}catch(J){console['error']('Client\x20to\x20server\x20relay\x20error:',J);throw J;}},B=async()=>{try{const C=l['readable']['getReader'](),D=a['writable']['getWriter']();while(!![]){const {done:E,value:F}=await C['read']();if(E)break;let G=F;CONFIG['SECURITY']['ENCRYPTION']['ENABLED']&&(G=await i['deobfuscate'](G)),CONFIG['TRAFFIC_MORPHING']['PADDING']['ENABLED']&&(G=h['removePadding'](G)),await D['write'](G),n+=F['byteLength'];}}catch(H){console['error']('Server\x20to\x20client\x20relay\x20error:',H);throw H;}};await Promise['race']([A(),B()]);}catch(C){console['error']('Connection\x20error:',C),j&&await f['updateConnection'](j,{'status':'error','errorMessage':C['message']}),await f['logSecurityEvent']({'eventType':'connection_error','severity':'medium','ipAddress':d['ip'],'userId':k,'details':C['message']});}finally{const D=Date['now']()-o,E=m+n;j&&k&&(await f['updateConnection'](j,{'bytesSent':m,'bytesReceived':n,'duration':D,'disconnectedAt':Math['floor'](Date['now']()/0x3e8),'status':'closed'}),await f['updateTraffic'](user['uuid'],E),await f['logTraffic']({'userId':k,'connectionId':j,'bytesTransferred':E,'direction':'bidirectional','protocol':'vless'}),await f['logMetric']('connection_duration',D),await f['logMetric']('traffic_bytes',E));try{l&&await l['close']();}catch(F){}try{a['close'](0x3e8,'Normal\x20closure');}catch(G){}}}async function handleAPI(a,b,c){const d=new URL(a['url']),e=d['pathname'],f=a['method'],g={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','Access-Control-Allow-Headers':'Content-Type,\x20Authorization'};if(f==='OPTIONS')return new Response(null,{'headers':g});try{if(e==='/api/stats'&&f==='GET'){const h=await c['getSystemStats']();return jsonResponse(h,g);}if(e==='/api/users'&&f==='GET'){const i=await c['listUsers']({'limit':0x64});return jsonResponse({'users':i},g);}if(e==='/api/users'&&f==='POST'){const j=await a['json'](),k=await c['createUser'](j);return jsonResponse({'success':!![],'user':k},g);}if(e['startsWith']('/api/users/')&&f==='DELETE'){const l=e['split']('/')['pop']();return await c['deleteUser'](l),jsonResponse({'success':!![]},g);}if(e['startsWith']('/api/users/')&&e['endsWith']('/reset-traffic')&&f==='POST'){const m=e['split']('/')[0x3];return await c['updateUser'](m,{'trafficUsed':0x0}),jsonResponse({'success':!![]},g);}if(e==='/api/sni/list'&&f==='GET'){const n=await c['getOptimalSNIs']({'limit':0x32});return jsonResponse({'snis':n},g);}if(e==='/api/sni/discover'&&f==='POST'){const o=Utils['getClientInfo'](a),p=new AISNIHunter(b['AI'],c);return b['ctx']['waitUntil'](p['discoverOptimalSNIs'](o)),jsonResponse({'success':!![],'message':'SNI\x20discovery\x20started'},g);}if(e==='/api/connections'&&f==='GET'){const q=await c['getActiveConnections']();return jsonResponse({'connections':q},g);}if(e==='/api/security/events'&&f==='GET'){const r=await c['getRecentSecurityEvents'](0x64);return jsonResponse({'events':r},g);}if(e==='/api/system/optimize'&&f==='POST')return MEMORY_CACHE['clear']('l1'),await c['cleanup'](0x1e),jsonResponse({'success':!![],'message':'System\x20optimized'},g);if(e==='/api/system/clear-cache'&&f==='POST')return MEMORY_CACHE['clear'](),jsonResponse({'success':!![]},g);if(e==='/api/system/maintenance'&&f==='POST')return await c['cleanup'](CONFIG['MONITORING']['LOG_RETENTION_DAYS']),await c['vacuum'](),jsonResponse({'success':!![],'message':'Maintenance\x20complete'},g);if(e==='/api/health'&&f==='GET')return jsonResponse({'status':'healthy','version':CONFIG['VERSION'],'timestamp':new Date()['toISOString'](),'uptime':process?.['uptime']?.()||'N/A'},g);return jsonResponse({'error':'Not\x20found'},g,0x194);}catch(s){return console['error']('API\x20error:',s),jsonResponse({'error':s['message']},g,0x1f4);}}function jsonResponse(a,b={},c=0xc8){return new Response(JSON['stringify'](a),{'status':c,'headers':{'Content-Type':'application/json',...b}});}async function handleRequest(a,b,c){const d=new URL(a['url']),f=d['pathname'],g=new DatabaseManager(b['DB']);try{!b['DB_INITIALIZED']&&(await g['initializeSchema'](),b['DB_INITIALIZED']=!![]);if(f==='/'||f==='/admin'){const h=await g['getSystemStats'](),i=await g['listUsers']({'limit':0x32,'status':'active'}),j=await g['getRecentSecurityEvents'](0x14),k=await g['getOptimalSNIs']({'limit':0xf}),l=generateAdminPanel(h,i,j,k);return new Response(l,{'headers':{'Content-Type':'text/html;\x20charset=utf-8'}});}if(f==='/user'||f['startsWith']('/u/')){const m=f==='/user'?d['searchParams']['get']('uuid'):f['split']('/')['pop']();if(!m)return new Response('Missing\x20UUID\x20parameter',{'status':0x190});const n=await g['getUser'](m,'uuid');if(!n)return new Response('User\x20not\x20found',{'status':0x194});const o=await g['getUserStats'](n['id']),p=await generateUserPanel(n,o);return new Response(p,{'headers':{'Content-Type':'text/html;\x20charset=utf-8'}});}if(f==='/vless'||a['headers']['get']('Upgrade')==='websocket')return await handleVLESS(a,b,c,g);if(f['startsWith']('/api/'))return await handleAPI(a,b,g);if(f==='/telegram'&&a['method']==='POST'){const q=new TelegramBot(g);return await q['handleWebhook'](a);}if(f==='/health')return jsonResponse({'status':'healthy','version':CONFIG['VERSION'],'build':CONFIG['BUILD_NUMBER'],'timestamp':new Date()['toISOString']()});return new Response('Not\x20Found',{'status':0x194});}catch(r){console['error']('Request\x20handling\x20error:',r);try{await g['logSecurityEvent']({'eventType':'system_error','severity':'critical','details':r['message'],'ipAddress':Utils['getClientInfo'](a)['ip']});}catch(s){}return new Response('Internal\x20Server\x20Error',{'status':0x1f4});}}async function handleScheduled(a,b,c){const d=new DatabaseManager(b['DB']);try{console['log']('ðŸ•\x20Running\x20scheduled\x20tasks...'),await d['cleanup'](CONFIG['MONITORING']['LOG_RETENTION_DAYS']),console['log']('âœ…\x20Cleanup\x20complete');CONFIG['DATABASE']['AUTO_OPTIMIZE']&&(await d['vacuum'](),console['log']('âœ…\x20Database\x20optimized'));const f=await d['listUsers']({'status':'active'}),g=Math['floor'](Date['now']()/0x3e8);for(const i of f){i['expiry_date']&&i['expiry_date']<g&&(await d['updateUser'](i['uuid'],{'status':'expired'}),console['log']('â°\x20User\x20'+i['username']+'\x20expired'));}if(CONFIG['AI']['SNI_DISCOVERY']['ENABLED']&&CONFIG['AI']['SNI_DISCOVERY']['AUTO_SCAN_INTERVAL']){const j=new AISNIHunter(b['AI'],d),k={'country':'US','asn':'unknown'};c['waitUntil'](j['discoverOptimalSNIs'](k)),console['log']('âœ…\x20SNI\x20discovery\x20triggered');}const h=new CDNFailoverManager(d);await h['checkAllProviders'](),console['log']('âœ…\x20CDN\x20health\x20checks\x20complete'),MEMORY_CACHE['clear']('l1'),console['log']('âœ…\x20Cache\x20cleared');if(CONFIG['TELEGRAM']['ENABLED']&&CONFIG['TELEGRAM']['NOTIFICATIONS']['ENABLED']){const l=new TelegramBot(d),m=await d['getSystemStats']();m['securityEvents']>0x32&&await l['sendNotification']('âš ï¸\x20High\x20security\x20activity\x20detected:\x20'+m['securityEvents']+'\x20events\x20in\x2024h','warning');}console['log']('ðŸŽ‰\x20Scheduled\x20tasks\x20completed\x20successfully');}catch(n){console['error']('Scheduled\x20task\x20error:',n);if(CONFIG['TELEGRAM']['ENABLED'])try{const o=new TelegramBot(d);await o['sendNotification']('âŒ\x20Scheduled\x20task\x20failed:\x20'+n['message'],'error');}catch(p){}}}async function handleWarRoom(a,b){const c='<!DOCTYPE\x20html>\x0a<html\x20lang=\x22en\x22>\x0a<head>\x0a\x20\x20<meta\x20charset=\x22UTF-8\x22>\x0a\x20\x20<meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22>\x0a\x20\x20<title>Quantum\x20VLESS\x20War\x20Room\x20v12</title>\x0a\x20\x20<style>\x0a\x20\x20\x20\x20*\x20{\x20margin:\x200;\x20padding:\x200;\x20box-sizing:\x20border-box;\x20}\x0a\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20font-family:\x20\x27Segoe\x20UI\x27,\x20Tahoma,\x20Geneva,\x20Verdana,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#0f0c29\x200%,\x20#302b63\x2050%,\x20#24243e\x20100%);\x0a\x20\x20\x20\x20\x20\x20color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20overflow-x:\x20hidden;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.header\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20border-bottom:\x202px\x20solid\x20#00ff88;\x0a\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(10px);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.header\x20h1\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x202.5em;\x0a\x20\x20\x20\x20\x20\x20text-shadow:\x200\x200\x2020px\x20#00ff88;\x0a\x20\x20\x20\x20\x20\x20animation:\x20glow\x202s\x20ease-in-out\x20infinite\x20alternate;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20@keyframes\x20glow\x20{\x0a\x20\x20\x20\x20\x20\x20from\x20{\x20text-shadow:\x200\x200\x2010px\x20#00ff88,\x200\x200\x2020px\x20#00ff88;\x20}\x0a\x20\x20\x20\x20\x20\x20to\x20{\x20text-shadow:\x200\x200\x2020px\x20#00ff88,\x200\x200\x2030px\x20#00ff88,\x200\x200\x2040px\x20#00ff88;\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.container\x20{\x0a\x20\x20\x20\x20\x20\x20max-width:\x201400px;\x0a\x20\x20\x20\x20\x20\x20margin:\x200\x20auto;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.stats-grid\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20grid;\x0a\x20\x20\x20\x20\x20\x20grid-template-columns:\x20repeat(auto-fit,\x20minmax(250px,\x201fr));\x0a\x20\x20\x20\x20\x20\x20gap:\x2020px;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2030px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.stat-card\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20rgba(255,255,255,0.1);\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(10px);\x0a\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20rgba(255,255,255,0.2);\x0a\x20\x20\x20\x20\x20\x20transition:\x20transform\x200.3s,\x20box-shadow\x200.3s;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.stat-card:hover\x20{\x0a\x20\x20\x20\x20\x20\x20transform:\x20translateY(-5px);\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x2010px\x2030px\x20rgba(0,255,136,0.3);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.stat-card\x20h3\x20{\x0a\x20\x20\x20\x20\x20\x20color:\x20#00ff88;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20text-transform:\x20uppercase;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.stat-value\x20{\x0a\x20\x20\x20\x20\x20\x20font-size:\x202em;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20\x20\x20\x20\x20text-shadow:\x200\x200\x2010px\x20rgba(0,255,136,0.5);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.map-container\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2030px;\x0a\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20rgba(255,255,255,0.2);\x0a\x20\x20\x20\x20\x20\x20height:\x20400px;\x0a\x20\x20\x20\x20\x20\x20position:\x20relative;\x0a\x20\x20\x20\x20\x20\x20overflow:\x20hidden;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20canvas\x20{\x0a\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2010px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.connections-list\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20rgba(255,255,255,0.2);\x0a\x20\x20\x20\x20\x20\x20max-height:\x20400px;\x0a\x20\x20\x20\x20\x20\x20overflow-y:\x20auto;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.connection\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20rgba(255,255,255,0.05);\x0a\x20\x20\x20\x20\x20\x20padding:\x2015px;\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2010px;\x0a\x20\x20\x20\x20\x20\x20border-left:\x203px\x20solid\x20#00ff88;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.cdn-status\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20padding:\x2010px;\x0a\x20\x20\x20\x20\x20\x20margin:\x205px\x200;\x0a\x20\x20\x20\x20\x20\x20background:\x20rgba(255,255,255,0.05);\x0a\x20\x20\x20\x20\x20\x20border-radius:\x205px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.status-dot\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20inline-block;\x0a\x20\x20\x20\x20\x20\x20width:\x2010px;\x0a\x20\x20\x20\x20\x20\x20height:\x2010px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2050%;\x0a\x20\x20\x20\x20\x20\x20margin-right:\x208px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.status-healthy\x20{\x20background:\x20#00ff88;\x20box-shadow:\x200\x200\x2010px\x20#00ff88;\x20}\x0a\x20\x20\x20\x20.status-degraded\x20{\x20background:\x20#ffaa00;\x20box-shadow:\x200\x200\x2010px\x20#ffaa00;\x20}\x0a\x20\x20\x20\x20.status-down\x20{\x20background:\x20#ff4444;\x20box-shadow:\x200\x200\x2010px\x20#ff4444;\x20}\x0a\x20\x20\x20\x20.version-badge\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20inline-block;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#667eea\x200%,\x20#764ba2\x20100%);\x0a\x20\x20\x20\x20\x20\x20padding:\x205px\x2015px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2020px;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.8em;\x0a\x20\x20\x20\x20\x20\x20margin-left:\x2010px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20::-webkit-scrollbar\x20{\x0a\x20\x20\x20\x20\x20\x20width:\x208px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20::-webkit-scrollbar-track\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20rgba(255,255,255,0.1);\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2010px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20::-webkit-scrollbar-thumb\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20#00ff88;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2010px;\x0a\x20\x20\x20\x20}\x0a\x20\x20</style>\x0a</head>\x0a<body>\x0a\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20<h1>âš¡\x20QUANTUM\x20VLESS\x20WAR\x20ROOM\x20<span\x20class=\x22version-badge\x22>v'+CONFIG['VERSION']+'</span></h1>\x0a\x20\x20\x20\x20<p>Real-Time\x20Enterprise\x20Monitoring\x20Dashboard\x20with\x20Auto\x20Database</p>\x0a\x20\x20</div>\x0a\x0a\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20<div\x20class=\x22stats-grid\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h3>ðŸ”Œ\x20Total\x20Connections</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22\x20id=\x22connections\x22>0</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h3>âœ…\x20Active\x20Now</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22\x20id=\x22active\x22>0</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h3>â¬‡ï¸\x20Data\x20In\x20(MB)</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22\x20id=\x22bytesIn\x22>0</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h3>â¬†ï¸\x20Data\x20Out\x20(MB)</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22\x20id=\x22bytesOut\x22>0</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h3>ðŸ§¬\x20Fragmented\x20Packets</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22\x20id=\x22fragmented\x22>0</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h3>ðŸ¤–\x20AI\x20Predictions</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22\x20id=\x22predictions\x22>0</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h3>ðŸ”„\x20Cache\x20Hit\x20Rate</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22\x20id=\x22cacheRate\x22>0%</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h3>ðŸ›¡ï¸\x20Honeypot\x20Triggers</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stat-value\x22\x20id=\x22honeypot\x22>0</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20<div\x20class=\x22map-container\x22>\x0a\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-bottom:\x2015px;\x22>ðŸŒ\x20Global\x20Connection\x20Map</h3>\x0a\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22worldMap\x22></canvas>\x0a\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2020px;\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22connections-list\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-bottom:\x2015px;\x22>ðŸ”Œ\x20Active\x20Connections</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22activeConnections\x22></div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22connections-list\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-bottom:\x2015px;\x22>ðŸŒ\x20CDN\x20Health\x20Status</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22cdnStatus\x22></div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20</div>\x0a\x0a\x20\x20<script>\x0a\x20\x20\x20\x20const\x20canvas\x20=\x20document.getElementById(\x27worldMap\x27);\x0a\x20\x20\x20\x20const\x20ctx\x20=\x20canvas.getContext(\x272d\x27);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20canvas.width\x20=\x20canvas.offsetWidth;\x0a\x20\x20\x20\x20canvas.height\x20=\x20canvas.offsetHeight;\x0a\x0a\x20\x20\x20\x20function\x20drawMap()\x20{\x0a\x20\x20\x20\x20\x20\x20ctx.clearRect(0,\x200,\x20canvas.width,\x20canvas.height);\x0a\x20\x20\x20\x20\x20\x20ctx.fillStyle\x20=\x20\x27rgba(0,\x20255,\x20136,\x200.1)\x27;\x0a\x20\x20\x20\x20\x20\x20ctx.fillRect(0,\x200,\x20canvas.width,\x20canvas.height);\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20ctx.strokeStyle\x20=\x20\x27rgba(0,\x20255,\x20136,\x200.3)\x27;\x0a\x20\x20\x20\x20\x20\x20ctx.lineWidth\x20=\x201;\x0a\x20\x20\x20\x20\x20\x20for\x20(let\x20i\x20=\x200;\x20i\x20<\x20canvas.width;\x20i\x20+=\x2050)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20ctx.beginPath();\x0a\x20\x20\x20\x20\x20\x20\x20\x20ctx.moveTo(i,\x200);\x0a\x20\x20\x20\x20\x20\x20\x20\x20ctx.lineTo(i,\x20canvas.height);\x0a\x20\x20\x20\x20\x20\x20\x20\x20ctx.stroke();\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20for\x20(let\x20i\x20=\x200;\x20i\x20<\x20canvas.height;\x20i\x20+=\x2050)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20ctx.beginPath();\x0a\x20\x20\x20\x20\x20\x20\x20\x20ctx.moveTo(0,\x20i);\x0a\x20\x20\x20\x20\x20\x20\x20\x20ctx.lineTo(canvas.width,\x20i);\x0a\x20\x20\x20\x20\x20\x20\x20\x20ctx.stroke();\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20drawMap();\x0a\x0a\x20\x20\x20\x20setInterval(()\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20fetch(\x27/api/stats\x27)\x0a\x20\x20\x20\x20\x20\x20\x20\x20.then(r\x20=>\x20r.json())\x0a\x20\x20\x20\x20\x20\x20\x20\x20.then(data\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20document.getElementById(\x27connections\x27).textContent\x20=\x20data.metrics.connections;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20document.getElementById(\x27active\x27).textContent\x20=\x20data.activeConnections;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20document.getElementById(\x27bytesIn\x27).textContent\x20=\x20(data.metrics.bytesIn\x20/\x201048576).toFixed(2);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20document.getElementById(\x27bytesOut\x27).textContent\x20=\x20(data.metrics.bytesOut\x20/\x201048576).toFixed(2);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20document.getElementById(\x27fragmented\x27).textContent\x20=\x20data.metrics.fragmentedPackets;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20document.getElementById(\x27predictions\x27).textContent\x20=\x20data.metrics.aiPredictions;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20document.getElementById(\x27honeypot\x27).textContent\x20=\x20data.metrics.honeypotTriggers;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20cacheTotal\x20=\x20data.metrics.cacheHits\x20+\x20data.metrics.cacheMisses;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20cacheRate\x20=\x20cacheTotal\x20>\x200\x20?\x20((data.metrics.cacheHits\x20/\x20cacheTotal)\x20*\x20100).toFixed(1)\x20:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20document.getElementById(\x27cacheRate\x27).textContent\x20=\x20cacheRate\x20+\x20\x27%\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20})\x0a\x20\x20\x20\x20\x20\x20\x20\x20.catch(console.error);\x0a\x20\x20\x20\x20},\x20'+CONFIG['WARROOM']['UPDATE_INTERVAL']+');\x0a\x20\x20</script>\x0a</body>\x0a</html>';return new Response(c,{'headers':{'Content-Type':'text/html;\x20charset=utf-8'}});}export default{async 'fetch'(a,b,c){const d=Date['now']();try{!GLOBAL_STATE['initialized']&&await initializeWorker(b);const e=new URL(a['url']),f=e['pathname'],g=a['method'];GLOBAL_STATE['metrics']['requests']++;const h=await checkSecurity(a,b);if(!h['allowed'])return GLOBAL_STATE['metrics']['errors']++,new Response(h['reason'],{'status':h['status']});const i=await AdvancedHoneypot['checkRequest'](a);if(i['isHoneypot'])return i['response'];c['waitUntil'](ResilienceManager['checkAndRecover'](b));CONFIG['WORKER']['AUTO_OPTIMIZATION']&&Date['now']()-GLOBAL_STATE['lastOptimization']>CONFIG['WORKER']['OPTIMIZATION_INTERVAL']&&(c['waitUntil'](SmartDatabaseManager['optimizeDatabase'](b)),GLOBAL_STATE['lastOptimization']=Date['now']());CONFIG['STORAGE']['D1']['AUTO_BACKUP']&&Date['now']()-GLOBAL_STATE['lastBackup']>CONFIG['STORAGE']['D1']['BACKUP_INTERVAL']&&c['waitUntil'](SmartDatabaseManager['backupDatabase'](b));if(g==='OPTIONS')return new Response(null,{'headers':{'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','Access-Control-Allow-Headers':'*'}});if(f==='/'||f==='/health')return handleHealthCheck(b);if(f==='/ws'||f['startsWith']('/ws/'))return await handleVLESSConnection(a,b,c);if(f==='/warroom'||f==='/war-room')return await handleWarRoom(a,b);if(f['startsWith']('/api/'))return await handleAPIRequest(a,b,c);return new Response('Not\x20Found',{'status':0x194});}catch(j){return GLOBAL_STATE['metrics']['errors']++,await log(b,'ERROR','Unhandled\x20error',{'error':j['message'],'stack':j['stack'],'url':a['url']}),new Response('Internal\x20Server\x20Error',{'status':0x1f4});}finally{const k=Date['now']()-d;GLOBAL_STATE['metrics']['avgResponseTime']=GLOBAL_STATE['metrics']['avgResponseTime']*0.95+k*0.05;}},async 'scheduled'(a,b,c){try{await log(b,'INFO','Cron\x20job\x20triggered',{'cron':a['cron']}),a['cron']==='*/5\x20*\x20*\x20*\x20*'&&(c['waitUntil'](performCDNHealthCheck(b)),c['waitUntil'](ResilienceManager['performRecovery'](b)),obfuscationEngine['shouldRotateKey']()&&await obfuscationEngine['rotateKey'](b)),a['cron']==='0\x20*/6\x20*\x20*\x20*'&&(c['waitUntil'](runAISNIHunt(b,'IR')),c['waitUntil'](AIPredictionEngine['analyzeBlockedDomains'](b))),a['cron']==='0\x200\x20*\x20*\x20*'&&(c['waitUntil'](SmartDatabaseManager['optimizeDatabase'](b)),c['waitUntil'](SmartDatabaseManager['backupDatabase'](b)));}catch(d){await log(b,'ERROR','Cron\x20job\x20failed',{'error':d['message']});}}};console['log']('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'),console['log']('âœ…\x20Quantum\x20VLESS\x20Enterprise\x20v'+CONFIG['VERSION']+'\x20-\x20Loaded\x20Successfully'),console['log']('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'),console['log']('ðŸ”¢\x20Build:',CONFIG['BUILD_NUMBER']),console['log']('ðŸ—„ï¸\x20Schema\x20Version:',CONFIG['SCHEMA_VERSION']),console['log']('ðŸ“¦\x20Features\x20Enabled:'),console['log']('\x20\x20âœ…\x20Auto\x20Database\x20Creation\x20&\x20Migration'),console['log']('\x20\x20âœ…\x20Intelligent\x20Multi-Layer\x20Caching'),console['log']('\x20\x20âœ…\x20Entropy-Based\x20Fragmentation'),console['log']('\x20\x20âœ…\x20War\x20Room\x20Dashboard\x20with\x20Real-Time\x20Geo\x20Tracking'),console['log']('\x20\x20âœ…\x20AI\x20Prediction\x20Engine\x20with\x20D1\x20Analysis'),console['log']('\x20\x20âœ…\x20Advanced\x20Honeypot\x20with\x20Fake\x20Portal'),console['log']('\x20\x20âœ…\x20Stateful\x20Resilience\x20with\x20Auto-Recovery'),console['log']('\x20\x20âœ…\x20Automatic\x20Performance\x20Optimization'),console['log']('\x20\x20âœ…\x20Smart\x20Backup\x20&\x20Recovery\x20System'),console['log']('\x20\x20âœ…\x20Real-time\x20Monitoring\x20&\x20Alerting'),console['log']('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'),console['log']('ðŸš€\x20Ready\x20for\x20Enterprise\x20Deployment\x20-\x20100%\x20Automated!'),console['log']('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');