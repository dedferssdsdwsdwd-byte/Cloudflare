// <!--GAMFC-->version base on commit: 8216e3988af9e0efcefff9407a35449294c63251 - last update: 2025-12-26 01:16:20 UTC <!--GAMFC-END-->.

import{connect}from'cloudflare:sockets';const CONST={'VERSION':'11.0.0-ULTIMATE','SCAMALYTICS_THRESHOLD':0x4b,'MAX_CONNECTIONS':0xa,'RATE_LIMIT':0x64,'SESSION_TIMEOUT':0x5265c00,'TOKEN_LENGTH':0x20,'CACHE_TTL':0xea60,'QUANTUM':{'FRAGMENTATION':!![],'PADDING':!![],'MIN_FRAGMENT':0x80,'MAX_FRAGMENT':0x578,'OBFUSCATION':!![],'STEALTH_MODE':!![]}},Config={'userID':'d342d11e-d424-4583-b36e-524ab1f0afa4','proxyIPs':['nima.nscl.ir:443','bpb.yousef.isegaro.com:443'],'scamalytics':{'username':'','apiKey':'','baseUrl':'https://api12.scamalytics.com/v3/'},'socks5':{'enabled':![],'relayMode':![],'address':''},async 'fromEnv'(a){let b=null;if(a['PROXY_DB'])try{const {results:f}=await a['PROXY_DB']['prepare']('SELECT\x20ip\x20FROM\x20proxy_scans\x20WHERE\x20is_current_best\x20=\x201\x20LIMIT\x201')['all']();b=f[0x0]?.['ip']||null,b&&console['log']('‚úì\x20Using\x20proxy\x20from\x20D1:\x20'+b);}catch(g){console['error']('‚úó\x20PROXY_DB\x20error:\x20'+g['message']);}!b&&a['PROXYIP']&&(b=a['PROXYIP'],console['log']('‚úì\x20Using\x20env.PROXYIP:\x20'+b));!b&&(b=this['proxyIPs'][Math['floor'](Math['random']()*this['proxyIPs']['length'])],console['log']('‚úì\x20Using\x20fallback\x20proxy:\x20'+b));!b&&(console['error']('‚ö†\x20CRITICAL:\x20No\x20proxy\x20IP\x20available,\x20using\x20first\x20item'),b=this['proxyIPs'][0x0]);const [c,d='443']=b['split'](':');return{'userID':a['UUID']||this['userID'],'proxyIP':c,'proxyPort':parseInt(d,0xa),'proxyAddress':b,'scamalytics':{'username':a['SCAMALYTICS_USERNAME']||this['scamalytics']['username'],'apiKey':a['SCAMALYTICS_API_KEY']||this['scamalytics']['apiKey'],'baseUrl':a['SCAMALYTICS_BASEURL']||this['scamalytics']['baseUrl']},'socks5':{'enabled':!!a['SOCKS5'],'relayMode':a['SOCKS5_RELAY']==='true'||this['socks5']['relayMode'],'address':a['SOCKS5']||this['socks5']['address']}};}},cacheMap=new Map(),rateMap=new Map(),sessionMap=new Map();export default{async 'fetch'(a,b,c){try{const d=new URL(a['url']),e=a['headers']['get']('CF-Connecting-IP')||'unknown',f=d['pathname'],g=await Config['fromEnv'](b),h=b['ADMIN_PATH_PREFIX']||'/quantum-admin';if(a['method']==='OPTIONS')return new Response(null,{'status':0xcc,'headers':getCorsHeaders()});if(!checkRateLimit(e))return console['warn']('[Rate\x20Limit]\x20Blocked:\x20'+e),createJsonResponse({'error':'Too\x20many\x20requests','retryAfter':0x3c},0x1ad);if(f==='/'||f==='')return await handleSmartReverseProxy(a,b,g);if(f==='/health'||f==='/status')return handleHealthCheck(b,g,h);if(f['startsWith']('/panel/'))return await handleUserPanel(d,b,g);if(f==='/vless'||f==='/ws'){const i=a['headers']['get']('Upgrade');if(i&&i['toLowerCase']()==='websocket')return await handleVLESSConnection(a,b,c,e,g);}if(f['startsWith']('/api/'))return await handleAPIRequest(a,b,e,g);if(f===h)return await handleAdminPanel(a,b,e,h,g);if(f===h+'/login'&&a['method']==='POST')return await handleAdminLogin(a,b,e,g);return handleFakePage(b);}catch(j){return console['error']('[Worker]\x20Critical\x20Error:',j),createJsonResponse({'error':'Internal\x20server\x20error','message':j instanceof Error?j['message']:'Unknown\x20error','timestamp':new Date()['toISOString']()},0x1f4);}}};async function handleSmartReverseProxy(a,b,c){try{let d=null;if(b['ROOT_PROXY_URL'])try{let f;try{f=new URL(b['ROOT_PROXY_URL']);}catch(g){console['error']('Invalid\x20ROOT_PROXY_URL:\x20'+b['ROOT_PROXY_URL'],g);const h=new Headers();return addSecurityHeaders(h,null,{}),new Response('Proxy\x20configuration\x20error:\x20Invalid\x20URL\x20format',{'status':0x1f4,'headers':h});}}catch(i){console['error']('‚úó\x20Invalid\x20ROOT_PROXY_URL\x20format:\x20'+b['ROOT_PROXY_URL'],i);}const e=['https://www.cloudflare.com','https://www.mozilla.org','https://www.wikipedia.org','https://www.ietf.org'];!d&&(d=e[Math['floor'](Math['random']()*e['length'])],console['log']('‚úì\x20Using\x20fallback\x20proxy:\x20'+d));try{const j=await fetch(d,{'method':a['method'],'headers':{'User-Agent':a['headers']['get']('User-Agent')||'Mozilla/5.0\x20(Windows\x20NT\x2010.0;\x20Win64;\x20x64)\x20AppleWebKit/537.36','Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8','Accept-Language':a['headers']['get']('Accept-Language')||'en-US,en;q=0.9','Accept-Encoding':'gzip,\x20deflate,\x20br'},'redirect':'follow','cf':{'cacheTtl':0xe10,'cacheEverything':!![]}});if(j['ok']){const k=new Headers(j['headers']);return k['set']('X-Proxied-By','Quantum-Shield'),k['set']('X-Proxy-Version',CONST['VERSION']),k['delete']('Content-Security-Policy'),k['delete']('X-Frame-Options'),addSecurityHeaders(k,null,{}),new Response(j['body'],{'status':j['status'],'statusText':j['statusText'],'headers':k});}throw new Error('Proxy\x20returned\x20status:\x20'+j['status']);}catch(l){return console['error']('‚úó\x20Proxy\x20fetch\x20failed\x20for\x20'+d+':',l),handleFakePage(b);}}catch(m){return console['error']('[Proxy]\x20Error:',m),handleFakePage(b);}}async function handleAdminPanel(a,b,c,d,e){try{const f=new Headers();f['set']('Content-Type','text/html;\x20charset=utf-8');if(b['ADMIN_HEADER_KEY']){const i=a['headers']['get']('X-Admin-Auth')||'';if(!timingSafeEqual(i,b['ADMIN_HEADER_KEY']))return console['warn']('[Admin]\x20Header\x20auth\x20failed\x20from\x20'+c),addSecurityHeaders(f,null,{}),new Response('Access\x20denied\x20-\x20Invalid\x20authentication\x20header',{'status':0x193,'headers':f});}if(e['scamalytics']['apiKey']&&e['scamalytics']['username']){const j={'username':e['scamalytics']['username'],'apiKey':e['scamalytics']['apiKey'],'baseUrl':e['scamalytics']['baseUrl']},k=parseInt(b['SCAMALYTICS_THRESHOLD'])||CONST['SCAMALYTICS_THRESHOLD'];if(await isSuspiciousIP(c,j,k))return console['warn']('[Admin]\x20Suspicious\x20IP\x20denied:\x20'+c),addSecurityHeaders(f,null,{}),new Response('Access\x20denied\x20-\x20Security\x20check\x20failed',{'status':0x193,'headers':f});}const g=d+'/login',h=generateAdminLoginHTML(g,e);return addSecurityHeaders(f,null,{}),new Response(h,{'status':0xc8,'headers':f});}catch(l){return console['error']('[Admin\x20Panel]\x20Error:',l),createJsonResponse({'error':'Failed\x20to\x20load\x20admin\x20panel'},0x1f4);}}function generateAdminLoginHTML(a,b){return'<!DOCTYPE\x20html>\x0a<html\x20class=\x22dark\x22>\x0a<head>\x0a\x20\x20<meta\x20charset=\x22UTF-8\x22>\x0a\x20\x20<meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22>\x0a\x20\x20<meta\x20name=\x22robots\x22\x20content=\x22noindex,\x20nofollow\x22>\x0a\x20\x20<title>Quantum\x20Shield\x20-\x20Secure\x20Access</title>\x0a\x20\x20\x0a\x20\x20<link\x20rel=\x22preconnect\x22\x20href=\x22https://fonts.googleapis.com\x22>\x0a\x20\x20<link\x20href=\x22https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap\x22\x20rel=\x22stylesheet\x22>\x0a\x20\x20<script\x20src=\x22https://cdn.tailwindcss.com\x22></script>\x0a\x20\x20\x0a\x20\x20<script>\x0a\x20\x20\x20\x20tailwind.config\x20=\x20{\x20\x0a\x20\x20\x20\x20\x20\x20darkMode:\x20\x22class\x22,\x0a\x20\x20\x20\x20\x20\x20theme:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20extend:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20fontFamily:\x20{\x20sans:\x20[\x27Inter\x27,\x20\x27system-ui\x27,\x20\x27sans-serif\x27]\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20</script>\x0a\x20\x20\x0a\x20\x20<style>\x0a\x20\x20\x20\x20*\x20{\x20margin:\x200;\x20padding:\x200;\x20box-sizing:\x20border-box;\x20}\x0a\x20\x20\x20\x20body\x20{\x20\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#1e293b\x200%,\x20#0f172a\x20100%);\x0a\x20\x20\x20\x20\x20\x20font-family:\x20\x27Inter\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20min-height:\x20100vh;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20@keyframes\x20float\x20{\x0a\x20\x20\x20\x20\x20\x200%,\x20100%\x20{\x20transform:\x20translateY(0px)\x20rotate(0deg);\x20}\x0a\x20\x20\x20\x20\x20\x2050%\x20{\x20transform:\x20translateY(-20px)\x20rotate(5deg);\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.float-animation\x20{\x20animation:\x20float\x206s\x20ease-in-out\x20infinite;\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@keyframes\x20glow\x20{\x0a\x20\x20\x20\x20\x20\x200%,\x20100%\x20{\x20box-shadow:\x200\x200\x2020px\x20rgba(99,\x20102,\x20241,\x200.3);\x20}\x0a\x20\x20\x20\x20\x20\x2050%\x20{\x20box-shadow:\x200\x200\x2040px\x20rgba(99,\x20102,\x20241,\x200.6);\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.glow-animation\x20{\x20animation:\x20glow\x202s\x20ease-in-out\x20infinite;\x20}\x0a\x20\x20</style>\x0a</head>\x0a<body\x20class=\x22min-h-screen\x20flex\x20items-center\x20justify-center\x20p-4\x22>\x0a\x20\x20\x0a\x20\x20<div\x20class=\x22absolute\x20inset-0\x20overflow-hidden\x20pointer-events-none\x22>\x0a\x20\x20\x20\x20<div\x20class=\x22absolute\x20top-20\x20left-20\x20w-64\x20h-64\x20bg-blue-500/10\x20rounded-full\x20blur-3xl\x22></div>\x0a\x20\x20\x20\x20<div\x20class=\x22absolute\x20bottom-20\x20right-20\x20w-96\x20h-96\x20bg-purple-500/10\x20rounded-full\x20blur-3xl\x22></div>\x0a\x20\x20</div>\x0a\x20\x20\x0a\x20\x20<div\x20class=\x22relative\x20max-w-md\x20w-full\x20bg-slate-800/90\x20backdrop-blur-xl\x20rounded-3xl\x20p-8\x20shadow-2xl\x20border\x20border-slate-700\x22>\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20<div\x20class=\x22text-center\x20mb-8\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22w-20\x20h-20\x20bg-gradient-to-br\x20from-blue-500\x20to-purple-600\x20rounded-2xl\x20flex\x20items-center\x20justify-center\x20mx-auto\x20mb-6\x20shadow-2xl\x20float-animation\x20glow-animation\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22w-12\x20h-12\x20text-white\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20stroke-width=\x222\x22\x20d=\x22M13\x2010V3L4\x2014h7v7l9-11h-7z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<h1\x20class=\x22text-3xl\x20font-black\x20text-white\x20mb-2\x22>Quantum\x20Shield</h1>\x0a\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-slate-400\x20text-sm\x22>Admin\x20Control\x20Panel</p>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22mt-3\x20inline-block\x20px-3\x20py-1\x20bg-blue-500/20\x20text-blue-400\x20text-xs\x20font-bold\x20rounded-full\x20border\x20border-blue-500/30\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20v'+CONST['VERSION']+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20<form\x20id=\x22loginForm\x22\x20class=\x22space-y-5\x22>\x0a\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22block\x20text-sm\x20font-semibold\x20text-slate-300\x20mb-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22flex\x20items-center\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22w-4\x20h-4\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20stroke-width=\x222\x22\x20d=\x22M16\x207a4\x204\x200\x2011-8\x200\x204\x204\x200\x20018\x200zM12\x2014a7\x207\x200\x2000-7\x207h14a7\x207\x200\x2000-7-7z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Username\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<input\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type=\x22text\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id=\x22username\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20required\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20autocomplete=\x22username\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22w-full\x20bg-slate-900/90\x20border\x20border-slate-700\x20rounded-xl\x20px-4\x20py-3\x20text-white\x20placeholder-slate-500\x20focus:ring-2\x20focus:ring-blue-500\x20focus:border-transparent\x20outline-none\x20transition-all\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20placeholder=\x22Enter\x20username\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22block\x20text-sm\x20font-semibold\x20text-slate-300\x20mb-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22flex\x20items-center\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22w-4\x20h-4\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20stroke-width=\x222\x22\x20d=\x22M12\x2015v2m-6\x204h12a2\x202\x200\x20002-2v-6a2\x202\x200\x2000-2-2H6a2\x202\x200\x2000-2\x202v6a2\x202\x200\x20002\x202zm10-10V7a4\x204\x200\x2000-8\x200v4h8z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Password\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<input\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type=\x22password\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id=\x22password\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20required\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20autocomplete=\x22current-password\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22w-full\x20bg-slate-900/90\x20border\x20border-slate-700\x20rounded-xl\x20px-4\x20py-3\x20text-white\x20placeholder-slate-500\x20focus:ring-2\x20focus:ring-blue-500\x20focus:border-transparent\x20outline-none\x20transition-all\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20placeholder=\x22Enter\x20password\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<button\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20type=\x22submit\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20id=\x22submitBtn\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20class=\x22w-full\x20bg-gradient-to-r\x20from-blue-500\x20to-purple-600\x20hover:from-blue-600\x20hover:to-purple-700\x20text-white\x20font-bold\x20py-4\x20rounded-xl\x20transition-all\x20shadow-lg\x20hover:shadow-xl\x20transform\x20hover:scale-[1.02]\x22\x0a\x20\x20\x20\x20\x20\x20>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22btnText\x22\x20class=\x22flex\x20items-center\x20justify-center\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22w-5\x20h-5\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20stroke-width=\x222\x22\x20d=\x22M11\x2016l-4-4m0\x200l4-4m-4\x204h14m-5\x204v1a3\x203\x200\x2001-3\x203H6a3\x203\x200\x2001-3-3V7a3\x203\x200\x20013-3h7a3\x203\x200\x20013\x203v1\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Login\x20to\x20Dashboard\x0a\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20<div\x20id=\x22message\x22\x20class=\x22mt-5\x20p-4\x20rounded-xl\x20hidden\x22></div>\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20<div\x20class=\x22mt-8\x20pt-8\x20border-t\x20border-slate-700\x20space-y-3\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-3\x20text-xs\x20text-slate-400\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22w-4\x20h-4\x20text-green-500\x20flex-shrink-0\x22\x20fill=\x22currentColor\x22\x20viewBox=\x220\x200\x2020\x2020\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20fill-rule=\x22evenodd\x22\x20d=\x22M10\x2018a8\x208\x200\x20100-16\x208\x208\x200\x20000\x2016zm3.707-9.293a1\x201\x200\x2000-1.414-1.414L9\x2010.586\x207.707\x209.293a1\x201\x200\x2000-1.414\x201.414l2\x202a1\x201\x200\x20001.414\x200l4-4z\x22\x20clip-rule=\x22evenodd\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>Quantum\x20Encryption\x20&\x20Anti-Filter</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-3\x20text-xs\x20text-slate-400\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22w-4\x20h-4\x20text-green-500\x20flex-shrink-0\x22\x20fill=\x22currentColor\x22\x20viewBox=\x220\x200\x2020\x2020\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20fill-rule=\x22evenodd\x22\x20d=\x22M10\x2018a8\x208\x200\x20100-16\x208\x208\x200\x20000\x2016zm3.707-9.293a1\x201\x200\x2000-1.414-1.414L9\x2010.586\x207.707\x209.293a1\x201\x200\x2000-1.414\x201.414l2\x202a1\x201\x200\x20001.414\x200l4-4z\x22\x20clip-rule=\x22evenodd\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>Individual\x20User\x20Panels\x20with\x20UUID</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-3\x20text-xs\x20text-slate-400\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22w-4\x20h-4\x20text-green-500\x20flex-shrink-0\x22\x20fill=\x22currentColor\x22\x20viewBox=\x220\x200\x2020\x2020\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20fill-rule=\x22evenodd\x22\x20d=\x22M10\x2018a8\x208\x200\x20100-16\x208\x208\x200\x20000\x2016zm3.707-9.293a1\x201\x200\x2000-1.414-1.414L9\x2010.586\x207.707\x209.293a1\x201\x200\x2000-1.414\x201.414l2\x202a1\x201\x200\x20001.414\x200l4-4z\x22\x20clip-rule=\x22evenodd\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>Smart\x20Traffic\x20&\x20SOCKS5\x20Support</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x0a\x20\x20</div>\x0a\x20\x20\x0a\x20\x20<script>\x0a\x20\x20\x20\x20const\x20form\x20=\x20document.getElementById(\x27loginForm\x27);\x0a\x20\x20\x20\x20const\x20submitBtn\x20=\x20document.getElementById(\x27submitBtn\x27);\x0a\x20\x20\x20\x20const\x20btnText\x20=\x20document.getElementById(\x27btnText\x27);\x0a\x20\x20\x20\x20const\x20messageDiv\x20=\x20document.getElementById(\x27message\x27);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20form.addEventListener(\x27submit\x27,\x20async\x20(e)\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20e.preventDefault();\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20const\x20username\x20=\x20document.getElementById(\x27username\x27).value.trim();\x0a\x20\x20\x20\x20\x20\x20const\x20password\x20=\x20document.getElementById(\x27password\x27).value;\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20if\x20(!username\x20||\x20!password)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20showMessage(\x27Please\x20enter\x20both\x20username\x20and\x20password\x27,\x20\x27error\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20return;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20submitBtn.disabled\x20=\x20true;\x0a\x20\x20\x20\x20\x20\x20btnText.innerHTML\x20=\x20\x27<svg\x20class=\x22animate-spin\x20h-5\x20w-5\x20mx-auto\x22\x20fill=\x22none\x22\x20viewBox=\x220\x200\x2024\x2024\x22><circle\x20class=\x22opacity-25\x22\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x224\x22></circle><path\x20class=\x22opacity-75\x22\x20fill=\x22currentColor\x22\x20d=\x22M4\x2012a8\x208\x200\x20018-8V0C5.373\x200\x200\x205.373\x200\x2012h4zm2\x205.291A7.962\x207.962\x200\x20014\x2012H0c0\x203.042\x201.135\x205.824\x203\x207.938l3-2.647z\x22></path></svg>\x27;\x0a\x20\x20\x20\x20\x20\x20messageDiv.classList.add(\x27hidden\x27);\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20response\x20=\x20await\x20fetch(\x27'+a+'\x27,\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20method:\x20\x27POST\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20headers:\x20{\x20\x27Content-Type\x27:\x20\x27application/json\x27\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body:\x20JSON.stringify({\x20username,\x20password\x20})\x0a\x20\x20\x20\x20\x20\x20\x20\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20result\x20=\x20await\x20response.json();\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20(result.success)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20showMessage(\x27‚úì\x20Login\x20successful!\x20Redirecting...\x27,\x20\x27success\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20localStorage.setItem(\x27authToken\x27,\x20result.token);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20localStorage.setItem(\x27tokenExpiry\x27,\x20result.expiresAt);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20window.location.href\x20=\x20\x27/api/stats\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20},\x201500);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20throw\x20new\x20Error(result.error\x20||\x20result.message\x20||\x20\x27Login\x20failed\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20showMessage(\x27‚úó\x20\x27\x20+\x20error.message,\x20\x27error\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20}\x20finally\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20submitBtn.disabled\x20=\x20false;\x0a\x20\x20\x20\x20\x20\x20\x20\x20btnText.innerHTML\x20=\x20`\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22w-5\x20h-5\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20stroke-width=\x222\x22\x20d=\x22M11\x2016l-4-4m0\x200l4-4m-4\x204h14m-5\x204v1a3\x203\x200\x2001-3\x203H6a3\x203\x200\x2001-3-3V7a3\x203\x200\x20013-3h7a3\x203\x200\x20013\x203v1\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Login\x20to\x20Dashboard\x0a\x20\x20\x20\x20\x20\x20\x20\x20`;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20});\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20function\x20showMessage(text,\x20type)\x20{\x0a\x20\x20\x20\x20\x20\x20messageDiv.className\x20=\x20\x27mt-5\x20p-4\x20rounded-xl\x20border\x20\x27\x20+\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20(type\x20===\x20\x27success\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20?\x20\x27bg-green-500/20\x20text-green-400\x20border-green-500/30\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20:\x20\x27bg-red-500/20\x20text-red-400\x20border-red-500/30\x27);\x0a\x20\x20\x20\x20\x20\x20messageDiv.innerHTML\x20=\x20\x27<span>\x27\x20+\x20text\x20+\x20\x27</span>\x27;\x0a\x20\x20\x20\x20\x20\x20messageDiv.classList.remove(\x27hidden\x27);\x0a\x20\x20\x20\x20}\x0a\x20\x20</script>\x0a\x20\x20\x0a</body>\x0a</html>';}async function handleAdminLogin(a,b,c,d){try{const e=await a['json']();if(!e['username']||!e['password'])return createJsonResponse({'error':'Missing\x20credentials','message':'Username\x20and\x20password\x20are\x20required'},0x190);const f=b['ADMIN_USERNAME']||'admin',g=b['ADMIN_PASSWORD']||'quantum2025';if(e['username']!==f||e['password']!==g)return console['warn']('[Security]\x20Failed\x20login\x20attempt\x20from\x20'+c),await new Promise(j=>setTimeout(j,0x7d0)),createJsonResponse({'error':'Invalid\x20credentials','message':'Username\x20or\x20password\x20is\x20incorrect'},0x191);const h=generateSecureToken(CONST['TOKEN_LENGTH']),i=new Date(Date['now']()+CONST['SESSION_TIMEOUT']);return sessionMap['set']('session_'+h,{'username':f,'ip':c,'created':Date['now'](),'expiresAt':i['getTime']()}),console['log']('[Security]\x20Successful\x20login:\x20'+f+'\x20from\x20'+c),createJsonResponse({'success':!![],'token':h,'expiresAt':i['toISOString'](),'user':{'username':f,'role':'admin'}});}catch(j){return console['error']('[Login]\x20Error:',j),createJsonResponse({'error':'Authentication\x20failed','message':'An\x20error\x20occurred\x20during\x20login'},0x1f4);}}async function isSuspiciousIP(a,b,c){try{if(isPrivateIP(a))return![];const d='scam_'+a,e=cacheMap['get'](d);if(e&&Date['now']()-e['timestamp']<CONST['CACHE_TTL']*0xa)return e['value'];if(!b['apiKey']||!b['username'])return![];const f=''+b['baseUrl']+a,g=await fetch(f,{'headers':{'Authorization':'Basic\x20'+btoa(b['username']+':'+b['apiKey']),'Accept':'application/json'},'cf':{'cacheTtl':0xe10,'cacheEverything':!![]}});if(!g['ok'])return console['error']('[Scamalytics]\x20API\x20error:\x20'+g['status']),![];const h=await g['json'](),i=parseInt(h['score'])||0x0,j=i>=c;return cacheMap['set'](d,{'value':j,'timestamp':Date['now']()}),j&&console['warn']('[Scamalytics]\x20Suspicious\x20IP:\x20'+a+'\x20(score:\x20'+i+')'),j;}catch(k){return console['error']('[Scamalytics]\x20Check\x20failed:',k),![];}}function handleHealthCheck(a,b,c){const d={'status':'healthy','version':CONST['VERSION'],'timestamp':new Date()['toISOString'](),'configuration':{'admin_path':c,'proxy_address':b['proxyAddress'],'proxy_ip':b['proxyIP'],'proxy_port':b['proxyPort'],'user_id':b['userID']['substring'](0x0,0x8)+'...','root_proxy_url':a['ROOT_PROXY_URL']?'configured':'using\x20fallback','scamalytics_enabled':!!b['scamalytics']['apiKey'],'socks5_enabled':b['socks5']['enabled'],'admin_header_auth':!!a['ADMIN_HEADER_KEY']},'features':{'vless_protocol':!![],'websocket':!![],'user_panels':!![],'anti_filter':CONST['QUANTUM']['OBFUSCATION'],'quantum_encryption':!![],'stealth_mode':CONST['QUANTUM']['STEALTH_MODE'],'reverse_proxy':!![],'database':!!a['QUANTUM_DB'],'proxy_db':!!a['PROXY_DB'],'fragmentation':CONST['QUANTUM']['FRAGMENTATION'],'padding':CONST['QUANTUM']['PADDING']},'system':{'cache_entries':cacheMap['size'],'rate_limit_records':rateMap['size'],'active_sessions':sessionMap['size'],'max_connections':CONST['MAX_CONNECTIONS'],'rate_limit':CONST['RATE_LIMIT']}};return createJsonResponse(d);}async function handleUserPanel(a,b,c){try{const d=a['pathname']['split']('/'),e=d[d['length']-0x1];if(!e||!isValidUUID(e)){const i=new Headers();return i['set']('Content-Type','text/plain;\x20charset=utf-8'),addSecurityHeaders(i,null,{}),new Response('Invalid\x20UUID\x20format',{'status':0x190,'headers':i});}const f=await getUserData(e,b,c);if(!f){const j=new Headers();return j['set']('Content-Type','text/plain;\x20charset=utf-8'),addSecurityHeaders(j,null,{}),new Response('User\x20not\x20found',{'status':0x194,'headers':j});}const g=generateUserPanelHTML(f,a['hostname'],c),h=new Headers();return h['set']('Content-Type','text/html;\x20charset=utf-8'),h['set']('Cache-Control','no-cache,\x20no-store,\x20must-revalidate'),addSecurityHeaders(h,null,{}),new Response(g,{'status':0xc8,'headers':h});}catch(k){return console['error']('[Panel]\x20Error:',k),createJsonResponse({'error':'Failed\x20to\x20load\x20panel','message':k['message']},0x1f4);}}function generateUserPanelHTML(a,b,c){const d=Number(a['traffic_used_gb'])||0x0,e=Number(a['traffic_limit_gb'])||0x1,f=generateVLESSLink(a['uuid'],b,c),g=Math['min'](0x64,Math['round'](d/e*0x64)),h=Math['max'](0x0,e-d)['toFixed'](0x2),i=new Date(a['expiry_date']),j=Math['max'](0x0,Math['ceil']((i['getTime']()-new Date()['getTime']())/0x5265c00)),k=a['status']==='active'?'green':'red',l=a['status']==='active'?'Active':'Inactive';return'<!DOCTYPE\x20html>\x0a<html\x20class=\x22dark\x22\x20lang=\x22en\x22>\x0a<head>\x0a\x20\x20<meta\x20charset=\x22UTF-8\x22>\x0a\x20\x20<meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22>\x0a\x20\x20<meta\x20name=\x22robots\x22\x20content=\x22noindex,\x20nofollow\x22>\x0a\x20\x20<title>Quantum\x20Panel\x20-\x20'+escapeHtml(a['username']||'User')+'</title>\x0a\x20\x20\x0a\x20\x20<link\x20href=\x22https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap\x22\x20rel=\x22stylesheet\x22>\x0a\x20\x20<script\x20src=\x22https://cdn.tailwindcss.com\x22></script>\x0a\x20\x20\x0a\x20\x20<script>\x0a\x20\x20\x20\x20tailwind.config\x20=\x20{\x0a\x20\x20\x20\x20\x20\x20darkMode:\x20\x22class\x22,\x0a\x20\x20\x20\x20\x20\x20theme:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20extend:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20fontFamily:\x20{\x20sans:\x20[\x27Inter\x27,\x20\x27system-ui\x27,\x20\x27sans-serif\x27]\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20</script>\x0a\x20\x20\x0a\x20\x20<style>\x0a\x20\x20\x20\x20*\x20{\x20margin:\x200;\x20padding:\x200;\x20box-sizing:\x20border-box;\x20}\x0a\x20\x20\x20\x20::-webkit-scrollbar\x20{\x20width:\x208px;\x20}\x0a\x20\x20\x20\x20::-webkit-scrollbar-track\x20{\x20background:\x20#0f172a;\x20}\x0a\x20\x20\x20\x20::-webkit-scrollbar-thumb\x20{\x20background:\x20#334155;\x20border-radius:\x204px;\x20}\x0a\x20\x20\x20\x20::-webkit-scrollbar-thumb:hover\x20{\x20background:\x20#475569;\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@keyframes\x20pulse-glow\x20{\x0a\x20\x20\x20\x20\x20\x200%,\x20100%\x20{\x20opacity:\x201;\x20}\x0a\x20\x20\x20\x20\x20\x2050%\x20{\x20opacity:\x200.7;\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.animate-pulse-glow\x20{\x20animation:\x20pulse-glow\x202s\x20infinite;\x20}\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20@keyframes\x20gradient-shift\x20{\x0a\x20\x20\x20\x20\x20\x200%,\x20100%\x20{\x20background-position:\x200%\x2050%;\x20}\x0a\x20\x20\x20\x20\x20\x2050%\x20{\x20background-position:\x20100%\x2050%;\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.gradient-animate\x20{\x0a\x20\x20\x20\x20\x20\x20background-size:\x20200%\x20200%;\x0a\x20\x20\x20\x20\x20\x20animation:\x20gradient-shift\x203s\x20ease\x20infinite;\x0a\x20\x20\x20\x20}\x0a\x20\x20</style>\x0a</head>\x0a<body\x20class=\x22bg-slate-900\x20text-white\x20min-h-screen\x22>\x0a\x20\x20\x0a\x20\x20<header\x20class=\x22sticky\x20top-0\x20z-50\x20bg-slate-800/95\x20backdrop-blur-lg\x20border-b\x20border-slate-700\x22>\x0a\x20\x20\x20\x20<div\x20class=\x22max-w-7xl\x20mx-auto\x20px-4\x20py-4\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20justify-between\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-3\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22w-10\x20h-10\x20rounded-xl\x20bg-gradient-to-br\x20from-blue-500\x20to-purple-600\x20flex\x20items-center\x20justify-center\x20shadow-lg\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-2xl\x22>‚ö°</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22font-bold\x20text-xl\x22>Quantum\x20Shield</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-slate-400\x22>VLESS\x20v'+CONST['VERSION']['split']('-')[0x0]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22px-3\x20py-1.5\x20bg-'+k+'-500/20\x20text-'+k+'-400\x20text-xs\x20font-bold\x20rounded-full\x20border\x20border-'+k+'-500/40\x20flex\x20items-center\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22inline-block\x20w-2\x20h-2\x20rounded-full\x20bg-'+k+'-400\x20animate-pulse-glow\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+l+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20</header>\x0a\x0a\x20\x20<main\x20class=\x22max-w-7xl\x20mx-auto\x20px-4\x20py-8\x20space-y-8\x22>\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20<div\x20class=\x22text-center\x20mb-10\x22>\x0a\x20\x20\x20\x20\x20\x20<h1\x20class=\x22text-4xl\x20font-black\x20mb-3\x20bg-clip-text\x20text-transparent\x20bg-gradient-to-r\x20from-white\x20via-blue-200\x20to-purple-200\x20gradient-animate\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20Welcome,\x20'+escapeHtml(a['username']||'User')+'!\x0a\x20\x20\x20\x20\x20\x20</h1>\x0a\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-slate-400\x22>Your\x20secure\x20connection\x20dashboard</p>\x0a\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20<div\x20class=\x22grid\x20grid-cols-1\x20sm:grid-cols-2\x20lg:grid-cols-4\x20gap-6\x22>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-slate-800\x20border\x20border-slate-700\x20rounded-2xl\x20p-6\x20hover:border-'+k+'-500/50\x20transition-all\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-2\x20mb-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22h-3\x20w-3\x20rounded-full\x20bg-'+k+'-500\x20animate-pulse-glow\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xs\x20text-slate-400\x20uppercase\x20font-semibold\x22>Status</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-3xl\x20font-bold\x20mb-1\x22>'+l+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-'+k+'-400\x22>System\x20Online</p>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-slate-800\x20border\x20border-slate-700\x20rounded-2xl\x20p-6\x20hover:border-blue-500/50\x20transition-all\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xs\x20text-slate-400\x20uppercase\x20font-semibold\x20block\x20mb-4\x22>Expires\x20In</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-3xl\x20font-bold\x20mb-1\x22>'+j+'\x20Days</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-slate-400\x22>'+i['toLocaleDateString']()+'</p>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-slate-800\x20border\x20border-slate-700\x20rounded-2xl\x20p-6\x20hover:border-purple-500/50\x20transition-all\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xs\x20text-slate-400\x20uppercase\x20font-semibold\x20block\x20mb-4\x22>Device\x20Limit</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-3xl\x20font-bold\x20mb-1\x22>'+CONST['MAX_CONNECTIONS']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-slate-400\x22>Concurrent</p>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-slate-800\x20border\x20border-slate-700\x20rounded-2xl\x20p-6\x20hover:border-green-500/50\x20transition-all\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xs\x20text-slate-400\x20uppercase\x20font-semibold\x20block\x20mb-4\x22>Remaining</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-3xl\x20font-bold\x20mb-1\x22>'+h+'\x20GB</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-slate-400\x22>Of\x20'+e+'\x20GB</p>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20<div\x20class=\x22grid\x20grid-cols-1\x20lg:grid-cols-3\x20gap-8\x22>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22lg:col-span-2\x20space-y-8\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-slate-800\x20border\x20border-slate-700\x20rounded-3xl\x20p-8\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22text-xl\x20font-bold\x20mb-6\x20flex\x20items-center\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20üìä\x20Traffic\x20Usage\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22space-y-5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20justify-between\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-slate-400\x20block\x20mb-1\x22>Used</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-white\x20font-mono\x20font-semibold\x20text-lg\x22>'+d['toFixed'](0x2)+'\x20GB</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-right\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-slate-400\x20block\x20mb-1\x22>Total</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-white\x20font-mono\x20font-semibold\x20text-lg\x22>'+e+'\x20GB</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22relative\x20h-5\x20bg-slate-900\x20rounded-full\x20overflow-hidden\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22absolute\x20h-full\x20bg-gradient-to-r\x20from-blue-500\x20via-purple-500\x20to-pink-500\x20rounded-full\x20transition-all\x20duration-1000\x22\x20style=\x22width:\x20'+g+'%\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20justify-between\x20text-xs\x20text-slate-500\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>0\x20GB</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-blue-400\x20font-bold\x22>'+g+'%</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+e+'\x20GB</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-slate-800\x20border\x20border-slate-700\x20rounded-3xl\x20p-8\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22text-xl\x20font-bold\x20mb-6\x20flex\x20items-center\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20üîó\x20Connection\x20Link\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22space-y-5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22text-sm\x20font-semibold\x20text-slate-300\x20block\x20mb-3\x22>VLESS\x20URI</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id=\x22vlessLink\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type=\x22text\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20readonly\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20value=\x22'+escapeHtml(f)+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22flex-1\x20bg-slate-900\x20border\x20border-slate-700\x20rounded-xl\x20py-3\x20px-4\x20text-sm\x20text-slate-300\x20font-mono\x20focus:outline-none\x20focus:ring-2\x20focus:ring-blue-500\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onclick=\x22copyLink()\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22bg-blue-500\x20hover:bg-blue-600\x20text-white\x20px-5\x20rounded-xl\x20transition-all\x20font-semibold\x20flex\x20items-center\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22w-4\x20h-4\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20stroke-width=\x222\x22\x20d=\x22M8\x2016H6a2\x202\x200\x2001-2-2V6a2\x202\x200\x20012-2h8a2\x202\x200\x20012\x202v2m-6\x2012h8a2\x202\x200\x20002-2v-8a2\x202\x200\x2000-2-2h-8a2\x202\x200\x2000-2\x202v8a2\x202\x200\x20002\x202z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Copy\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22pt-5\x20border-t\x20border-slate-700\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-sm\x20text-slate-400\x20mb-4\x22>Import\x20to\x20Client:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22grid\x20grid-cols-2\x20sm:grid-cols-4\x20gap-3\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22flex\x20flex-col\x20items-center\x20gap-3\x20p-4\x20rounded-xl\x20bg-slate-900\x20border\x20border-slate-700\x20hover:border-orange-500\x20hover:bg-slate-800\x20transition-all\x20group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-3xl\x20group-hover:scale-110\x20transition-transform\x22>‚ö°</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xs\x20font-semibold\x22>Hiddify</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22flex\x20flex-col\x20items-center\x20gap-3\x20p-4\x20rounded-xl\x20bg-slate-900\x20border\x20border-slate-700\x20hover:border-blue-500\x20hover:bg-slate-800\x20transition-all\x20group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-3xl\x20group-hover:scale-110\x20transition-transform\x22>üöÄ</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xs\x20font-semibold\x22>V2rayNG</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22flex\x20flex-col\x20items-center\x20gap-3\x20p-4\x20rounded-xl\x20bg-slate-900\x20border\x20border-slate-700\x20hover:border-purple-500\x20hover:bg-slate-800\x20transition-all\x20group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-3xl\x20group-hover:scale-110\x20transition-transform\x22>üê±</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xs\x20font-semibold\x22>Clash</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22flex\x20flex-col\x20items-center\x20gap-3\x20p-4\x20rounded-xl\x20bg-slate-900\x20border\x20border-slate-700\x20hover:border-green-500\x20hover:bg-slate-800\x20transition-all\x20group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-3xl\x20group-hover:scale-110\x20transition-transform\x22>üõ°Ô∏è</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xs\x20font-semibold\x22>Exclave</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22space-y-8\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-slate-800\x20border\x20border-slate-700\x20rounded-3xl\x20p-6\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22text-xl\x20font-bold\x20mb-5\x20flex\x20items-center\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20üë§\x20Account\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20class=\x22space-y-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li\x20class=\x22pb-4\x20border-b\x20border-slate-700\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xs\x20text-slate-400\x20uppercase\x20block\x20mb-2\x22>UUID</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-sm\x20font-mono\x20text-white\x20break-all\x22>'+escapeHtml(a['uuid'])+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li\x20class=\x22pb-4\x20border-b\x20border-slate-700\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xs\x20text-slate-400\x20uppercase\x20block\x20mb-2\x22>Created</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-sm\x20text-white\x22>'+new Date(a['created_at'])['toLocaleDateString']()+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xs\x20text-slate-400\x20uppercase\x20block\x20mb-2\x22>Plan</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-sm\x20text-white\x20font-medium\x22>Premium\x20Quantum</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-slate-800\x20border\x20border-slate-700\x20rounded-3xl\x20p-6\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20justify-between\x20mb-5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22text-xl\x20font-bold\x20flex\x20items-center\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20üåê\x20Connection\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-2\x20px-3\x20py-1.5\x20rounded-full\x20bg-green-500/10\x20border\x20border-green-500/30\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22w-2\x20h-2\x20rounded-full\x20bg-green-500\x20animate-pulse-glow\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xs\x20font-bold\x20text-green-400\x22>LIVE</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22space-y-3\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-slate-900\x20rounded-xl\x20p-4\x20border\x20border-slate-700\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-slate-400\x20mb-2\x22>IP\x20Protection</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-sm\x20text-green-400\x20font-bold\x22>‚úì\x20Enabled</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-slate-900\x20rounded-xl\x20p-4\x20border\x20border-slate-700\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-slate-400\x20mb-2\x22>Encryption</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-sm\x20text-blue-400\x20font-bold\x22>üîí\x20Quantum\x20TLS\x201.3</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-slate-900\x20rounded-xl\x20p-4\x20border\x20border-slate-700\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-slate-400\x20mb-2\x22>Anti-Filter</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-sm\x20text-purple-400\x20font-bold\x22>‚ö°\x20Active</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-slate-900\x20rounded-xl\x20p-4\x20border\x20border-slate-700\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-slate-400\x20mb-2\x22>Proxy\x20Server</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-sm\x20text-yellow-400\x20font-bold\x22>'+escapeHtml(c['proxyAddress'])+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20</div>\x0a\x0a\x20\x20</main>\x0a\x0a\x20\x20<footer\x20class=\x22mt-16\x20py-8\x20text-center\x20text-slate-500\x20text-sm\x20border-t\x20border-slate-700\x22>\x0a\x20\x20\x20\x20<p>¬©\x202024\x20Quantum\x20Shield\x20-\x20Secure\x20VLESS\x20Infrastructure</p>\x0a\x20\x20\x20\x20<p\x20class=\x22text-xs\x20mt-2\x22>v'+CONST['VERSION']+'</p>\x0a\x20\x20</footer>\x0a\x0a\x20\x20<script>\x0a\x20\x20\x20\x20function\x20copyLink()\x20{\x0a\x20\x20\x20\x20\x20\x20const\x20input\x20=\x20document.getElementById(\x27vlessLink\x27);\x0a\x20\x20\x20\x20\x20\x20input.select();\x0a\x20\x20\x20\x20\x20\x20input.setSelectionRange(0,\x2099999);\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20navigator.clipboard.writeText(input.value).then(()\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20button\x20=\x20event.currentTarget;\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20originalHTML\x20=\x20button.innerHTML;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20button.innerHTML\x20=\x20`\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22w-4\x20h-4\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20stroke-width=\x222\x22\x20d=\x22M5\x2013l4\x204L19\x207\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Copied!\x0a\x20\x20\x20\x20\x20\x20\x20\x20`;\x0a\x20\x20\x20\x20\x20\x20\x20\x20button.classList.remove(\x27bg-blue-500\x27,\x20\x27hover:bg-blue-600\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20button.classList.add(\x27bg-green-500\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20button.innerHTML\x20=\x20originalHTML;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20button.classList.remove(\x27bg-green-500\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20button.classList.add(\x27bg-blue-500\x27,\x20\x27hover:bg-blue-600\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20},\x202000);\x0a\x20\x20\x20\x20\x20\x20}).catch(err\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20alert(\x27Failed\x20to\x20copy:\x20\x27\x20+\x20err);\x0a\x20\x20\x20\x20\x20\x20});\x0a\x20\x20\x20\x20}\x0a\x20\x20</script>\x0a\x0a</body>\x0a</html>';}async function handleVLESSConnection(a,b,c,d,e){try{const f=new WebSocketPair(),g=f[0x0],h=f[0x1];h['accept']();let i=new Uint8Array(0x0),j=![],k=null,l=null,m=null,n=0x0,o=0x0;return h['addEventListener']('message',async p=>{try{let q;if(p['data']instanceof ArrayBuffer)q=new Uint8Array(p['data']);else{if(typeof p['data']==='string')q=new TextEncoder()['encode'](p['data']);else{console['error']('[VLESS]\x20Unsupported\x20data\x20type'),h['close'](0x3eb,'Unsupported\x20data');return;}}if(!j){i=concatenateUint8Arrays(i,q);if(i['length']<0x18)return;const r=i[0x0];if(r!==0x0){console['error']('[VLESS]\x20Invalid\x20version:\x20'+r),h['close'](0x3ea,'Invalid\x20version');return;}const s=i['slice'](0x1,0x11),t=convertBytesToUUID(s);m=await getUserData(t,b,e);if(!m||m['status']!=='active'){console['error']('[VLESS]\x20Unauthorized\x20user:\x20'+t),h['close'](0x3f0,'Unauthorized');return;}const u=await getActiveConnections(t);if(u>=CONST['MAX_CONNECTIONS']){console['warn']('[VLESS]\x20Max\x20connections\x20reached\x20for\x20user:\x20'+t),h['close'](0x3f0,'Too\x20many\x20connections');return;}let v=0x11;v++,v++;const w=i[v]<<0x8|i[v+0x1];v+=0x2;const x=i[v++];let y='';if(x===0x1)y=Array['from'](i['slice'](v,v+0x4))['join']('.'),v+=0x4;else{if(x===0x2){const z=i[v++];y=new TextDecoder()['decode'](i['slice'](v,v+z)),v+=z;}else{if(x===0x3){const A=i['slice'](v,v+0x10),B=[];for(let C=0x0;C<0x10;C+=0x2){B['push']((A[C]<<0x8|A[C+0x1])['toString'](0x10));}y=B['join'](':'),v+=0x10;}else{console['error']('[VLESS]\x20Unknown\x20address\x20type:\x20'+x),h['close'](0x3ea,'Unknown\x20address\x20type');return;}}}console['log']('[VLESS]\x20'+m['username']+'\x20->\x20'+y+':'+w);try{const D=e['proxyIP']||y,E=e['proxyPort']||w;k=connect({'hostname':D,'port':E}),l=k['writable']['getWriter']();const F=new Uint8Array([r,0x0]);h['send'](F['buffer']);if(i['length']>v){const G=i['slice'](v);if(CONST['QUANTUM']['FRAGMENTATION']){const H=fragmentData(G);for(const I of H){await l['write'](I),n+=I['length'];}}else await l['write'](G),n+=G['length'];}j=!![],pipeRemoteToClient(k,h,m,b),await registerActiveConnection(t,d);}catch(J){console['error']('[VLESS]\x20Connection\x20failed:',J),h['close'](0x3f3,'Connection\x20failed');}}else{if(l&&k)try{if(CONST['QUANTUM']['FRAGMENTATION']){const K=fragmentData(q);for(const L of K){const M=CONST['QUANTUM']['PADDING']?addRandomPadding(L):L;await l['write'](M),n+=M['length'];}}else{const N=CONST['QUANTUM']['PADDING']?addRandomPadding(q):q;await l['write'](N),n+=N['length'];}}catch(O){console['error']('[VLESS]\x20Write\x20failed:',O),h['close'](0x3f3);if(k)try{await k['close']();}catch(P){}}}}catch(Q){console['error']('[VLESS]\x20Message\x20error:',Q),h['close'](0x3f3);if(k)try{await k['close']();}catch(R){}}}),h['addEventListener']('close',async()=>{console['log']('[VLESS]\x20Connection\x20closed\x20for\x20user:\x20'+(m?.['username']||'unknown'));if(k)try{await k['close']();}catch(p){console['error']('[VLESS]\x20Error\x20closing\x20remote:',p);}if(m&&(n>0x0||o>0x0)){const q=(n+o)/(0x400*0x400*0x400);await updateUserTraffic(m['uuid'],q,b),console['log']('[VLESS]\x20Traffic\x20recorded:\x20'+q['toFixed'](0x3)+'\x20GB\x20for\x20'+m['username']);}m&&await unregisterActiveConnection(m['uuid'],d);}),h['addEventListener']('error',p=>{console['error']('[VLESS]\x20WebSocket\x20error:',p);if(k)try{k['close']();}catch(q){}}),new Response(null,{'status':0x65,'webSocket':g});}catch(p){return console['error']('[VLESS]\x20Handler\x20error:',p),createJsonResponse({'error':'Connection\x20failed','message':p['message']},0x1f4);}}async function pipeRemoteToClient(a,b,c,d){try{const f=a['readable']['getReader']();let g=0x0;while(!![]){const {done:h,value:i}=await f['read']();if(h)break;if(b['readyState']===WebSocket['OPEN']){let j=i;CONST['QUANTUM']['PADDING']&&(j=addRandomPadding(j)),CONST['QUANTUM']['OBFUSCATION']&&(j=applyObfuscation(j)),b['send'](j['buffer']),g+=j['length'];}else break;}if(g>0x0&&c){const k=g/(0x400*0x400*0x400);await updateUserTraffic(c['uuid'],k,d);}}catch(l){console['error']('[Pipe]\x20Error:',l);}finally{try{b['readyState']===WebSocket['OPEN']&&b['close']();}catch(m){}try{a['close']();}catch(n){}}}function fragmentData(a){const b=[];let c=0x0;while(c<a['length']){const d=Math['floor'](Math['random']()*(CONST['QUANTUM']['MAX_FRAGMENT']-CONST['QUANTUM']['MIN_FRAGMENT'])+CONST['QUANTUM']['MIN_FRAGMENT']),e=Math['min'](c+d,a['length']);b['push'](a['slice'](c,e)),c=e;}return b;}function addRandomPadding(a){const b=Math['floor'](Math['random']()*0x40)+0x10,c=new Uint8Array(b);return crypto['getRandomValues'](c),concatenateUint8Arrays(a,c);}function applyObfuscation(a){const b=Math['floor'](Math['random']()*0x100),c=new Uint8Array(a['length']);for(let d=0x0;d<a['length'];d++){c[d]=a[d]^b;}return c;}async function handleAPIRequest(a,b,c,d){try{const e=new URL(a['url']),f=e['pathname']['replace']('/api/',''),g=a['headers']['get']('Authorization');if(!g||!g['startsWith']('Bearer\x20'))return createJsonResponse({'error':'Unauthorized','message':'Valid\x20authorization\x20token\x20required'},0x191);const h=g['substring'](0x7),i=verifySessionToken(h);if(!i)return createJsonResponse({'error':'Invalid\x20token','message':'Session\x20expired\x20or\x20invalid'},0x191);if(f==='users'&&a['method']==='GET')return await listAllUsers(b,d);if(f==='users'&&a['method']==='POST')return await createNewUser(a,b,d);if(f['startsWith']('users/')&&a['method']==='DELETE'){const j=f['split']('/')[0x1];return await deleteUser(j,b);}if(f==='stats')return await getSystemStats(b,d);if(f==='config')return createJsonResponse({'success':!![],'config':{'version':CONST['VERSION'],'proxy_address':d['proxyAddress'],'max_connections':CONST['MAX_CONNECTIONS'],'quantum_features':CONST['QUANTUM']}});return createJsonResponse({'error':'Not\x20found','message':'API\x20endpoint\x20does\x20not\x20exist'},0x194);}catch(k){return console['error']('[API]\x20Error:',k),createJsonResponse({'error':'API\x20failed','message':k['message']},0x1f4);}}async function listAllUsers(a,b){try{if(!a['QUANTUM_DB'])return createJsonResponse({'success':!![],'users':[],'total':0x0,'message':'Database\x20not\x20configured'});const c=await a['QUANTUM_DB']['prepare']('SELECT\x20id,\x20uuid,\x20username,\x20traffic_limit_gb,\x20traffic_used_gb,\x20expiry_date,\x20status,\x20created_at\x20FROM\x20users\x20ORDER\x20BY\x20created_at\x20DESC')['all'](),d=(c['results']||[])['map'](e=>({...e,'usage_percent':Math['round'](Number(e['traffic_used_gb'])/Number(e['traffic_limit_gb'])*0x64),'panel_url':'/panel/'+e['uuid'],'vless_link':generateVLESSLink(e['uuid'],'your-domain.com',b)}));return createJsonResponse({'success':!![],'users':d,'total':d['length']});}catch(e){return console['error']('[API]\x20List\x20error:',e),createJsonResponse({'error':e['message']},0x1f4);}}async function createNewUser(a,b,c){try{if(!b['QUANTUM_DB'])return createJsonResponse({'error':'Database\x20not\x20configured'},0x1f7);const d=await a['json']();if(!d['username'])return createJsonResponse({'error':'Username\x20required'},0x190);const e=generateUUID(),f=d['expiry_date']||new Date(Date['now']()+0x1e*0x5265c00)['toISOString'](),g=d['traffic_limit_gb']||0x32;await b['QUANTUM_DB']['prepare']('INSERT\x20INTO\x20users\x20(uuid,\x20username,\x20traffic_limit_gb,\x20traffic_used_gb,\x20expiry_date,\x20status,\x20created_at)\x20VALUES\x20(?,\x20?,\x20?,\x200,\x20?,\x20?,\x20CURRENT_TIMESTAMP)')['bind'](e,d['username']['trim'](),g,f,'active')['run']();const h=generateVLESSLink(e,'your-domain.com',c);return createJsonResponse({'success':!![],'user':{'uuid':e,'username':d['username'],'traffic_limit_gb':g,'expiry_date':f,'panel_url':'/panel/'+e,'vless_link':h}},0xc9);}catch(i){return console['error']('[API]\x20Create\x20error:',i),createJsonResponse({'error':i['message']},0x1f4);}}async function deleteUser(a,b){try{if(!b['QUANTUM_DB'])return createJsonResponse({'error':'Database\x20not\x20configured'},0x1f7);return await b['QUANTUM_DB']['prepare']('DELETE\x20FROM\x20users\x20WHERE\x20uuid\x20=\x20?')['bind'](a)['run'](),cacheMap['delete']('user_'+a),createJsonResponse({'success':!![],'message':'User\x20deleted\x20successfully'});}catch(c){return console['error']('[API]\x20Delete\x20error:',c),createJsonResponse({'error':c['message']},0x1f4);}}async function getSystemStats(a,b){try{const c={'success':!![],'system':{'version':CONST['VERSION'],'timestamp':new Date()['toISOString'](),'uptime':Date['now']()},'users':{'total':0x0,'active':0x0},'traffic':{'used_gb':0x0,'allocated_gb':0x0},'cache':{'entries':cacheMap['size'],'rate_limits':rateMap['size'],'sessions':sessionMap['size']}};if(a['QUANTUM_DB']){const d=await a['QUANTUM_DB']['prepare']('SELECT\x20COUNT(*)\x20as\x20c\x20FROM\x20users')['first'](),e=await a['QUANTUM_DB']['prepare']('SELECT\x20COUNT(*)\x20as\x20c\x20FROM\x20users\x20WHERE\x20status\x20=\x20?')['bind']('active')['first'](),f=await a['QUANTUM_DB']['prepare']('SELECT\x20SUM(traffic_used_gb)\x20as\x20used,\x20SUM(traffic_limit_gb)\x20as\x20allocated\x20FROM\x20users')['first']();c['users']['total']=Number(d?.['c'])||0x0,c['users']['active']=Number(e?.['c'])||0x0,c['traffic']['used_gb']=Number(f?.['used'])||0x0,c['traffic']['allocated_gb']=Number(f?.['allocated'])||0x0;}return createJsonResponse(c);}catch(g){return console['error']('[Stats]\x20Error:',g),createJsonResponse({'error':g['message']},0x1f4);}}async function getUserData(a,b,c){try{const d='user_'+a,e=cacheMap['get'](d);if(e&&Date['now']()-e['timestamp']<CONST['CACHE_TTL'])return e['value'];if(b['QUANTUM_DB']){const g=await b['QUANTUM_DB']['prepare']('SELECT\x20*\x20FROM\x20users\x20WHERE\x20uuid\x20=\x20?\x20LIMIT\x201')['bind'](a)['first']();if(g)return cacheMap['set'](d,{'value':g,'timestamp':Date['now']()}),g;}const f={'id':0x1,'uuid':a,'username':'Demo\x20User','status':'active','traffic_limit_gb':0x32,'traffic_used_gb':12.5,'expiry_date':new Date(Date['now']()+0x1e*0x5265c00)['toISOString'](),'created_at':new Date()['toISOString']()};return cacheMap['set'](d,{'value':f,'timestamp':Date['now']()}),f;}catch(h){return console['error']('[DB]\x20Get\x20user\x20error:',h),null;}}async function updateUserTraffic(a,b,c){try{if(!c['QUANTUM_DB']||b<=0x0)return;await c['QUANTUM_DB']['prepare']('UPDATE\x20users\x20SET\x20traffic_used_gb\x20=\x20traffic_used_gb\x20+\x20?\x20WHERE\x20uuid\x20=\x20?')['bind'](b,a)['run'](),cacheMap['delete']('user_'+a);}catch(d){console['error']('[DB]\x20Update\x20traffic\x20error:',d);}}async function registerActiveConnection(a,b){const c='active_conn_'+a+'_'+b+'_'+Date['now']();cacheMap['set'](c,{'value':{'connected_at':Date['now']()},'timestamp':Date['now']()});}async function unregisterActiveConnection(a,b){for(const [c]of cacheMap['entries']()){c['startsWith']('active_conn_'+a+'_'+b)&&cacheMap['delete'](c);}}async function getActiveConnections(a){let b=0x0;const c=Date['now'](),d=0x493e0;for(const [e,f]of cacheMap['entries']()){e['startsWith']('active_conn_'+a+'_')&&(c-f['timestamp']<d?b++:cacheMap['delete'](e));}return b;}function handleFakePage(a){const b='<!DOCTYPE\x20html>\x0a<html\x20lang=\x22en\x22>\x0a<head>\x0a\x20\x20<meta\x20charset=\x22UTF-8\x22>\x0a\x20\x20<meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22>\x0a\x20\x20<meta\x20name=\x22description\x22\x20content=\x22Cloud\x20Infrastructure\x20Service\x22>\x0a\x20\x20<title>Cloud\x20Service</title>\x0a\x20\x20<style>\x0a\x20\x20\x20\x20*\x20{\x20margin:\x200;\x20padding:\x200;\x20box-sizing:\x20border-box;\x20}\x0a\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20font-family:\x20-apple-system,\x20BlinkMacSystemFont,\x20\x27Segoe\x20UI\x27,\x20Roboto,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20background:\x20linear-gradient(135deg,\x20#f5f7fa\x200%,\x20#c3cfe2\x20100%);\x0a\x20\x20\x20\x20\x20\x20min-height:\x20100vh;\x0a\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.container\x20{\x0a\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20padding:\x2060px;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2024px;\x0a\x20\x20\x20\x20\x20\x20box-shadow:\x200\x2025px\x2070px\x20rgba(0,0,0,0.15);\x0a\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20max-width:\x20600px;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20h1\x20{\x20\x0a\x20\x20\x20\x20\x20\x20font-size:\x202.5rem;\x20\x0a\x20\x20\x20\x20\x20\x20color:\x20#2c3e50;\x20\x0a\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x20\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20p\x20{\x20\x0a\x20\x20\x20\x20\x20\x20font-size:\x201.1rem;\x20\x0a\x20\x20\x20\x20\x20\x20color:\x20#7f8c8d;\x20\x0a\x20\x20\x20\x20\x20\x20line-height:\x201.8;\x20\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.status\x20{\x0a\x20\x20\x20\x20\x20\x20display:\x20inline-block;\x0a\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20background:\x20#27ae60;\x0a\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20border-radius:\x2050px;\x0a\x20\x20\x20\x20\x20\x20font-weight:\x20600;\x0a\x20\x20\x20\x20\x20\x20margin:\x2020px\x200;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.9rem;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20.footer\x20{\x0a\x20\x20\x20\x20\x20\x20margin-top:\x2030px;\x0a\x20\x20\x20\x20\x20\x20padding-top:\x2020px;\x0a\x20\x20\x20\x20\x20\x20border-top:\x202px\x20solid\x20#ecf0f1;\x0a\x20\x20\x20\x20\x20\x20color:\x20#95a5a6;\x0a\x20\x20\x20\x20\x20\x20font-size:\x200.9rem;\x0a\x20\x20\x20\x20}\x0a\x20\x20</style>\x0a</head>\x0a<body>\x0a\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20<h1>üëã\x20Welcome</h1>\x0a\x20\x20\x20\x20<div\x20class=\x22status\x22>‚úì\x20System\x20Operational</div>\x0a\x20\x20\x20\x20<p>This\x20is\x20a\x20standard\x20web\x20infrastructure\x20service\x20running\x20on\x20Cloudflare\x27s\x20global\x20network.</p>\x0a\x20\x20\x20\x20<p\x20style=\x22margin-top:\x2020px;\x22>All\x20systems\x20are\x20functioning\x20normally.\x20Service\x20availability:\x2099.9%</p>\x0a\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20Powered\x20by\x20Cloudflare\x20Workers\x0a\x20\x20\x20\x20</div>\x0a\x20\x20</div>\x0a</body>\x0a</html>',c=new Headers();return c['set']('Content-Type','text/html;\x20charset=utf-8'),addSecurityHeaders(c,null,{}),new Response(b,{'status':0xc8,'headers':c});}function checkRateLimit(a){const b=Date['now'](),c=0xea60,d=rateMap['get'](a);if(!d)return rateMap['set'](a,{'count':0x1,'resetTime':b+c}),!![];if(b>d['resetTime'])return d['count']=0x1,d['resetTime']=b+c,!![];return d['count']++,d['count']<=CONST['RATE_LIMIT'];}function verifySessionToken(a){const b='session_'+a,c=sessionMap['get'](b);if(!c)return null;const d=Date['now']();if(d>c['expiresAt'])return sessionMap['delete'](b),null;return c;}function timingSafeEqual(c,d){if(c['length']!==d['length'])return![];let e=0x0;for(let f=0x0;f<c['length'];f++){e|=c['charCodeAt'](f)^d['charCodeAt'](f);}return e===0x0;}function isValidUUID(a){const b=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return b['test'](a);}function generateUUID(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'['replace'](/[xy]/g,a=>{const b=Math['random']()*0x10|0x0,d=a==='x'?b:b&0x3|0x8;return d['toString'](0x10);});}function generateSecureToken(a){const b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let c='';for(let d=0x0;d<a;d++){c+=b['charAt'](Math['floor'](Math['random']()*b['length']));}return c;}function convertBytesToUUID(a){const b=Array['from'](a,c=>c['toString'](0x10)['padStart'](0x2,'0'))['join']('');return[b['slice'](0x0,0x8),b['slice'](0x8,0xc),b['slice'](0xc,0x10),b['slice'](0x10,0x14),b['slice'](0x14,0x20)]['join']('-');}function concatenateUint8Arrays(...a){const b=a['reduce']((e,f)=>e+f['length'],0x0),c=new Uint8Array(b);let d=0x0;for(const e of a){c['set'](e,d),d+=e['length'];}return c;}function generateVLESSLink(a,b,c){const d=new URLSearchParams({'encryption':'none','security':'tls','sni':b,'fp':'chrome','type':'ws','host':b,'path':'/vless'});return'vless://'+a+'@'+b+':443?'+d['toString']()+'#Quantum-'+a['substring'](0x0,0x8);}function escapeHtml(a){if(typeof a!=='string')return'';const b={'&':'&amp;','<':'&lt;','>':'&gt;','\x22':'&quot;','\x27':'&#39;'};return a['replace'](/[&<>"']/g,d=>b[d]);}function isPrivateIP(a){if(!a||a==='unknown'||a==='localhost'||a==='127.0.0.1')return!![];const b=a['split']('.')['map'](Number);if(b['length']!==0x4||b['some'](isNaN))return![];if(b[0x0]===0xa)return!![];if(b[0x0]===0xac&&b[0x1]>=0x10&&b[0x1]<=0x1f)return!![];if(b[0x0]===0xc0&&b[0x1]===0xa8)return!![];return![];}function addSecurityHeaders(a,b,c){a['set']('X-Content-Type-Options','nosniff'),a['set']('X-Frame-Options','DENY'),a['set']('X-XSS-Protection','1;\x20mode=block'),a['set']('Referrer-Policy','no-referrer'),a['set']('Strict-Transport-Security','max-age=31536000;\x20includeSubDomains'),a['set']('Permissions-Policy','geolocation=(),\x20microphone=(),\x20camera=()');for(const [d,e]of Object['entries'](c||{})){a['set'](d,e);}}function getSecurityHeaders(){return{'X-Content-Type-Options':'nosniff','X-Frame-Options':'DENY','X-XSS-Protection':'1;\x20mode=block','Referrer-Policy':'no-referrer','Strict-Transport-Security':'max-age=31536000'};}function getCorsHeaders(){return{'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','Access-Control-Allow-Headers':'Content-Type,\x20Authorization','Access-Control-Max-Age':'86400',...getSecurityHeaders()};}function createJsonResponse(a,b=0xc8){return new Response(JSON['stringify'](a,null,0x2),{'status':b,'headers':{'Content-Type':'application/json;\x20charset=utf-8',...getCorsHeaders()}});}